2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:11648
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:11648
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 1
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:11648
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 3
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:11648
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 2
2024-07-11 01:40:17 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 0
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.05}", 'results_path': None, 'is_moe': True}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:11648', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | model	None
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-11 01:40:18 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-11 01:40:18 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-11 01:40:18 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-11 01:40:18 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-11 01:40:20 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-11 01:40:23 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:40:26 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:40:28 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:40:31 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:40:34 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:40:37 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:40:39 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-11 01:40:48 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-11 01:40:57 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-11 01:41:17 | INFO | fairseq_cli.eval_lm | load time: 58.83 seconds
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
New cuda time: 2.1628899574279785
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8198490142822266
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.913330078125, gpu time: 3.982738971710205
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 80.46875
Expert2 overflow: 81.201171875
Expert1 unused count: 406
Expert2 unused count: 418
Expert1 balance top: 99.853515625
Expert2 balance top: 100.0

New cuda time: 1.9564889669418335
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848080396652222
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.47998046875, gpu time: 3.7412970066070557
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 75.634765625
Expert2 overflow: 76.416015625
Expert1 unused count: 410
Expert2 unused count: 404
Expert1 balance top: 100.0
Expert2 balance top: 99.755859375

New cuda time: 1.8137680292129517
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7784090042114258
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.829833984375, gpu time: 3.5921770334243774
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 80.46875
Expert2 overflow: 76.220703125
Expert1 unused count: 400
Expert2 unused count: 400
Expert1 balance top: 99.560546875
Expert2 balance top: 99.560546875

New cuda time: 1.803048014640808
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920080423355103
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.56494140625, gpu time: 3.5950560569763184
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 70.458984375
Expert2 overflow: 81.640625
Expert1 unused count: 405
Expert2 unused count: 400
Expert1 balance top: 99.8046875
Expert2 balance top: 99.560546875

New cuda time: 1.8092880249023438
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960079908370972
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.63525390625, gpu time: 3.605296015739441
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 65.576171875
Expert2 overflow: 80.76171875
Expert1 unused count: 402
Expert2 unused count: 380
Expert1 balance top: 99.658203125
Expert2 balance top: 98.583984375

New cuda time: 1.8054490089416504
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7667280435562134
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.55126953125, gpu time: 3.5721760988235474
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 70.263671875
Expert2 overflow: 77.05078125
Expert1 unused count: 407
Expert2 unused count: 388
Expert1 balance top: 99.90234375
Expert2 balance top: 98.974609375

New cuda time: 1.7916879653930664
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7665679454803467
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.70263671875, gpu time: 7.540994882583618
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.08203125
Expert1 unused count: 161
Expert2 unused count: 285
Expert1 balance top: 73.4375
Expert2 balance top: 91.748046875

New cuda time: 1.814568042755127
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783687949180603
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.52587890625, gpu time: 7.339552998542786
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 3.02734375
Expert1 unused count: 178
Expert2 unused count: 303
Expert1 balance top: 77.34375
Expert2 balance top: 92.96875

New cuda time: 1.8198490142822266
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7761679887771606
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.625244140625, gpu time: 7.188194036483765
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.5390625
Expert1 unused count: 173
Expert2 unused count: 299
Expert1 balance top: 76.123046875
Expert2 balance top: 91.943359375

New cuda time: 1.8121689558029175
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777448058128357
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.39892578125, gpu time: 7.184673070907593
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.759765625
Expert2 overflow: 1.611328125
Expert1 unused count: 199
Expert2 unused count: 263
Expert1 balance top: 78.564453125
Expert2 balance top: 88.232421875

New cuda time: 1.814087986946106
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894480228424072
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.601318359375, gpu time: 7.2088329792022705
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.48828125
Expert1 unused count: 221
Expert2 unused count: 258
Expert1 balance top: 80.810546875
Expert2 balance top: 87.79296875

New cuda time: 1.8006490468978882
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779047966003418
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.607421875, gpu time: 7.1518731117248535
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.734375
Expert2 overflow: 2.24609375
Expert1 unused count: 209
Expert2 unused count: 243
Expert1 balance top: 80.078125
Expert2 balance top: 81.982421875

New cuda time: 1.809607982635498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7800079584121704
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.982177734375, gpu time: 11.130610823631287
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.224609375
Expert1 unused count: 152
Expert2 unused count: 272
Expert1 balance top: 73.92578125
Expert2 balance top: 89.599609375

New cuda time: 1.8057689666748047
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7844879627227783
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 66.7158203125, gpu time: 10.929809927940369
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.3671875
Expert1 unused count: 171
Expert2 unused count: 294
Expert1 balance top: 76.07421875
Expert2 balance top: 92.87109375

New cuda time: 1.7707279920578003
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779528021812439
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.573974609375, gpu time: 10.738450050354004
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.9765625
Expert1 unused count: 182
Expert2 unused count: 273
Expert1 balance top: 76.171875
Expert2 balance top: 90.72265625

New cuda time: 1.8177679777145386
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7596889734268188
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.4130859375, gpu time: 10.76213002204895
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 192
Expert2 unused count: 258
Expert1 balance top: 78.7109375
Expert2 balance top: 88.57421875

New cuda time: 1.7854479551315308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7830480337142944
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.1767578125, gpu time: 10.777328968048096
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 0.732421875
Expert1 unused count: 202
Expert2 unused count: 257
Expert1 balance top: 77.099609375
Expert2 balance top: 87.20703125

New cuda time: 1.8017679452896118
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902480363845825
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.17041015625, gpu time: 10.743889093399048
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.099609375
Expert1 unused count: 236
Expert2 unused count: 263
Expert1 balance top: 80.419921875
Expert2 balance top: 82.568359375

New cuda time: 1.8048080205917358
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777680158615112
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.561279296875, gpu time: 14.71318781375885
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.298828125
Expert1 unused count: 157
Expert2 unused count: 303
Expert1 balance top: 71.728515625
Expert2 balance top: 92.822265625

New cuda time: 1.8228880167007446
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7809679508209229
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 77.303466796875, gpu time: 14.533665895462036
2024-07-11 01:41:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.85546875
Expert1 unused count: 173
Expert2 unused count: 304
Expert1 balance top: 73.974609375
Expert2 balance top: 91.89453125

New cuda time: 1.8083280324935913
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951369047164917
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.009765625, gpu time: 14.498147130012512
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.955078125
Expert1 unused count: 178
Expert2 unused count: 302
Expert1 balance top: 74.560546875
Expert2 balance top: 92.041015625

New cuda time: 1.8027280569076538
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.946408987045288
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.087890625, gpu time: 14.511267066001892
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.587890625
Expert2 overflow: 2.490234375
Expert1 unused count: 187
Expert2 unused count: 282
Expert1 balance top: 77.63671875
Expert2 balance top: 89.111328125

New cuda time: 1.8027280569076538
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9448089599609375
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.709228515625, gpu time: 14.524866938591003
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.830078125
Expert1 unused count: 206
Expert2 unused count: 257
Expert1 balance top: 79.296875
Expert2 balance top: 87.59765625

New cuda time: 1.8017679452896118
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9470490217208862
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.37109375, gpu time: 14.492706060409546
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.759765625
Expert2 overflow: 3.173828125
Expert1 unused count: 234
Expert2 unused count: 236
Expert1 balance top: 81.54296875
Expert2 balance top: 81.005859375

New cuda time: 1.7832070589065552
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782088041305542
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.359130859375, gpu time: 18.278482913970947
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 7.958984375
Expert1 unused count: 258
Expert2 unused count: 310
Expert1 balance top: 85.400390625
Expert2 balance top: 93.310546875

New cuda time: 1.814247965812683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78928804397583
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 89.250244140625, gpu time: 18.137202978134155
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.25390625
Expert1 unused count: 294
Expert2 unused count: 345
Expert1 balance top: 89.84375
Expert2 balance top: 96.337890625

New cuda time: 1.8108880519866943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848080396652222
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.790771484375, gpu time: 18.09384322166443
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 1.5625
Expert1 unused count: 296
Expert2 unused count: 327
Expert1 balance top: 88.330078125
Expert2 balance top: 94.43359375

New cuda time: 1.8014479875564575
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7851279973983765
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.04296875, gpu time: 18.097844004631042
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.07421875
Expert1 unused count: 291
Expert2 unused count: 313
Expert1 balance top: 87.451171875
Expert2 balance top: 91.40625

New cuda time: 1.8144090175628662
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777608036994934
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.546875, gpu time: 18.116883993148804
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.806640625
Expert1 unused count: 301
Expert2 unused count: 319
Expert1 balance top: 85.009765625
Expert2 balance top: 91.015625

New cuda time: 1.8123279809951782
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786247968673706
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.3046875, gpu time: 18.09128201007843
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 1.66015625
Expert1 unused count: 309
Expert2 unused count: 308
Expert1 balance top: 88.037109375
Expert2 balance top: 86.962890625

New cuda time: 1.812648057937622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7825679779052734
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.06591796875, gpu time: 21.873698949813843
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 10.44921875
Expert1 unused count: 154
Expert2 unused count: 281
Expert1 balance top: 73.779296875
Expert2 balance top: 91.552734375

New cuda time: 1.8060879707336426
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7700879573822021
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 99.587158203125, gpu time: 21.71337890625
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 4.541015625
Expert1 unused count: 171
Expert2 unused count: 303
Expert1 balance top: 77.83203125
Expert2 balance top: 93.359375

New cuda time: 1.7844879627227783
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779528021812439
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 70.4033203125, gpu time: 21.657859206199646
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.029296875
Expert1 unused count: 198
Expert2 unused count: 317
Expert1 balance top: 77.63671875
Expert2 balance top: 94.23828125

New cuda time: 1.811527967453003
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779047966003418
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 66.638916015625, gpu time: 21.688419938087463
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 194
Expert2 unused count: 274
Expert1 balance top: 78.955078125
Expert2 balance top: 89.599609375

New cuda time: 1.812648057937622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824079990386963
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.787353515625, gpu time: 21.711940050125122
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 208
Expert2 unused count: 256
Expert1 balance top: 78.955078125
Expert2 balance top: 87.158203125

New cuda time: 1.8129680156707764
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7702480554580688
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 66.57763671875, gpu time: 21.674498081207275
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 2.880859375
Expert1 unused count: 204
Expert2 unused count: 242
Expert1 balance top: 79.6875
Expert2 balance top: 80.56640625

New cuda time: 1.8016079664230347
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7934479713439941
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 70.199951171875, gpu time: 25.46875488758087
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 5.712890625
Expert1 unused count: 269
Expert2 unused count: 339
Expert1 balance top: 88.28125
Expert2 balance top: 96.240234375

New cuda time: 1.7992080450057983
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785680294036865
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 110.269287109375, gpu time: 25.291154980659485
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.005859375
Expert2 overflow: 8.056640625
Expert1 unused count: 300
Expert2 unused count: 353
Expert1 balance top: 92.48046875
Expert2 balance top: 96.630859375

New cuda time: 1.8118489980697632
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7788879871368408
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 81.108642578125, gpu time: 25.24859619140625
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.224609375
Expert2 overflow: 2.5390625
Expert1 unused count: 309
Expert2 unused count: 340
Expert1 balance top: 92.3828125
Expert2 balance top: 95.361328125

New cuda time: 1.8113679885864258
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788167953491211
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 77.114013671875, gpu time: 25.2879558801651
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 1.5625
Expert1 unused count: 338
Expert2 unused count: 333
Expert1 balance top: 94.43359375
Expert2 balance top: 91.943359375

New cuda time: 1.8073689937591553
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788648009300232
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 74.496826171875, gpu time: 25.30795705318451
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.7109375
Expert1 unused count: 350
Expert2 unused count: 371
Expert1 balance top: 95.8984375
Expert2 balance top: 97.265625

New cuda time: 1.8160079717636108
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779528021812439
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 75.600830078125, gpu time: 25.27003514766693
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.3671875
Expert2 overflow: 2.734375
Expert1 unused count: 352
Expert2 unused count: 356
Expert1 balance top: 96.6796875
Expert2 balance top: 95.166015625

New cuda time: 1.8036880493164062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788167953491211
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 79.05078125, gpu time: 29.06061089038849
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.904296875
Expert2 overflow: 28.564453125
Expert1 unused count: 194
Expert2 unused count: 299
Expert1 balance top: 79.541015625
Expert2 balance top: 93.115234375

New cuda time: 1.8006479740142822
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889679670333862
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 120.00634765625, gpu time: 28.880770921707153
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 15.087890625
Expert1 unused count: 213
Expert2 unused count: 321
Expert1 balance top: 81.982421875
Expert2 balance top: 94.04296875

New cuda time: 1.8036880493164062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7694480419158936
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 90.458740234375, gpu time: 28.82173228263855
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 7.03125
Expert1 unused count: 205
Expert2 unused count: 316
Expert1 balance top: 79.638671875
Expert2 balance top: 93.9453125

New cuda time: 1.9360090494155884
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.948809027671814
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 125.3037109375, gpu time: 29.172773957252502
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 3.90625
Expert1 unused count: 218
Expert2 unused count: 290
Expert1 balance top: 80.17578125
Expert2 balance top: 91.455078125

New cuda time: 1.812168002128601
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783687949180603
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 85.264404296875, gpu time: 28.903813004493713
2024-07-11 01:41:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.955078125
Expert1 unused count: 230
Expert2 unused count: 272
Expert1 balance top: 82.177734375
Expert2 balance top: 89.306640625

New cuda time: 1.9267289638519287
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9590489864349365
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 113.540771484375, gpu time: 29.155813097953796
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 1.220703125
Expert1 unused count: 238
Expert2 unused count: 272
Expert1 balance top: 83.837890625
Expert2 balance top: 88.134765625

New cuda time: 1.8012880086898804
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7840080261230469
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 89.945556640625, gpu time: 32.645906925201416
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.763671875
Expert2 overflow: 15.869140625
Expert1 unused count: 385
Expert2 unused count: 374
Expert1 balance top: 98.291015625
Expert2 balance top: 98.291015625

New cuda time: 1.7968080043792725
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7928080558776855
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 131.537353515625, gpu time: 32.47038698196411
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.24609375
Expert2 overflow: 17.67578125
Expert1 unused count: 384
Expert2 unused count: 396
Expert1 balance top: 98.095703125
Expert2 balance top: 99.365234375

New cuda time: 1.804967999458313
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7758480310440063
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 101.364501953125, gpu time: 32.40254831314087
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.375
Expert2 overflow: 5.712890625
Expert1 unused count: 381
Expert2 unused count: 362
Expert1 balance top: 97.94921875
Expert2 balance top: 97.021484375

New cuda time: 1.8056080341339111
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.464834213256836
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 141.630859375, gpu time: 38.44321620464325
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.396484375
Expert1 unused count: 361
Expert2 unused count: 356
Expert1 balance top: 96.09375
Expert2 balance top: 96.58203125

New cuda time: 1.8080079555511475
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9440089464187622
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 105.59619140625, gpu time: 32.65582990646362
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.080078125
Expert1 unused count: 378
Expert2 unused count: 377
Expert1 balance top: 97.998046875
Expert2 balance top: 98.4375

New cuda time: 1.8107279539108276
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859280109405518
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 123.112548828125, gpu time: 32.752469062805176
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 7.03125
Expert1 unused count: 371
Expert2 unused count: 367
Expert1 balance top: 97.412109375
Expert2 balance top: 97.021484375

New cuda time: 1.8099290132522583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7739280462265015
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 100.140625, gpu time: 36.229763984680176
2024-07-11 01:41:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 5.95703125
Expert1 unused count: 156
Expert2 unused count: 274
Expert1 balance top: 73.876953125
Expert2 balance top: 90.91796875

New cuda time: 10.330927848815918
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9547289609909058
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 894.859619140625, gpu time: 44.75604283809662
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.587890625
Expert1 unused count: 167
Expert2 unused count: 308
Expert1 balance top: 75.537109375
Expert2 balance top: 92.87109375

New cuda time: 1.7968080043792725
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782088041305542
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 110.563232421875, gpu time: 35.981444358825684
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.341796875
Expert1 unused count: 167
Expert2 unused count: 294
Expert1 balance top: 74.951171875
Expert2 balance top: 90.91796875

New cuda time: 1.8092880249023438
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7756880521774292
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 152.322021484375, gpu time: 42.02819228172302
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 1.5625
Expert1 unused count: 183
Expert2 unused count: 261
Expert1 balance top: 75.9765625
Expert2 balance top: 87.98828125

New cuda time: 1.8148880004882812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897679805755615
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 115.356201171875, gpu time: 36.260485887527466
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 186
Expert2 unused count: 244
Expert1 balance top: 77.294921875
Expert2 balance top: 86.474609375

New cuda time: 1.8150490522384644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902480363845825
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 133.460693359375, gpu time: 36.35776507854462
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 2.734375
Expert1 unused count: 194
Expert2 unused count: 241
Expert1 balance top: 77.099609375
Expert2 balance top: 83.0078125

New cuda time: 1.8139280080795288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859280109405518
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 110.8271484375, gpu time: 39.829620003700256
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.15234375
Expert2 overflow: 6.640625
Expert1 unused count: 274
Expert2 unused count: 334
Expert1 balance top: 85.9375
Expert2 balance top: 95.3125

New cuda time: 1.799847960472107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792968988418579
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 905.150146484375, gpu time: 48.348859786987305
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.95703125
Expert2 overflow: 5.126953125
Expert1 unused count: 279
Expert2 unused count: 329
Expert1 balance top: 87.98828125
Expert2 balance top: 94.62890625

New cuda time: 1.7958489656448364
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780168056488037
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 120.6455078125, gpu time: 39.55746138095856
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 2.1484375
Expert1 unused count: 285
Expert2 unused count: 337
Expert1 balance top: 85.595703125
Expert2 balance top: 94.775390625

New cuda time: 1.7976080179214478
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7692879438400269
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 162.540771484375, gpu time: 45.5950882434845
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.712890625
Expert2 overflow: 5.2734375
Expert1 unused count: 290
Expert2 unused count: 327
Expert1 balance top: 87.59765625
Expert2 balance top: 93.45703125

New cuda time: 1.8176079988479614
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7756880521774292
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 125.284423828125, gpu time: 39.853781938552856
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 1.85546875
Expert1 unused count: 307
Expert2 unused count: 326
Expert1 balance top: 89.501953125
Expert2 balance top: 92.96875

New cuda time: 1.8086479902267456
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7763290405273438
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 143.433349609375, gpu time: 39.94274306297302
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 3.759765625
Expert1 unused count: 311
Expert2 unused count: 325
Expert1 balance top: 88.671875
Expert2 balance top: 90.625

New cuda time: 1.8052879571914673
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953449010848999
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 177.89453125, gpu time: 43.58835697174072
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 6.884765625
Expert1 unused count: 140
Expert2 unused count: 253
Expert1 balance top: 70.849609375
Expert2 balance top: 88.57421875

New cuda time: 1.7908879518508911
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777680158615112
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 914.1806640625, gpu time: 51.91751575469971
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.857421875
Expert1 unused count: 134
Expert2 unused count: 291
Expert1 balance top: 71.337890625
Expert2 balance top: 91.357421875

New cuda time: 1.9550490379333496
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783687949180603
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 207.65625, gpu time: 43.29619836807251
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 2.685546875
Expert1 unused count: 145
Expert2 unused count: 279
Expert1 balance top: 71.533203125
Expert2 balance top: 90.33203125

New cuda time: 1.9504090547561646
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868880033493042
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 243.415771484375, gpu time: 49.332385301589966
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 2.1484375
Expert1 unused count: 154
Expert2 unused count: 245
Expert1 balance top: 74.12109375
Expert2 balance top: 87.01171875

New cuda time: 1.7812880277633667
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.941769003868103
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 206.240478515625, gpu time: 43.576838970184326
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.29296875
Expert1 unused count: 156
Expert2 unused count: 230
Expert1 balance top: 73.33984375
Expert2 balance top: 83.544921875

New cuda time: 1.799847960472107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969288945198059
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 223.472900390625, gpu time: 43.71187996864319
2024-07-11 01:41:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.052734375
Expert2 overflow: 2.099609375
Expert1 unused count: 150
Expert2 unused count: 199
Expert1 balance top: 74.51171875
Expert2 balance top: 79.00390625

New cuda time: 2.030087947845459
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9448070526123047
New cuda time: 1.9664080142974854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990460395812988
New cuda time: 1.7712069749832153
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789607048034668
New cuda time: 1.78512704372406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801766037940979
New cuda time: 1.7817670106887817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7787270545959473
New cuda time: 1.7715270519256592
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8075259923934937
New cuda time: 1.7966469526290894
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8009669780731201
New cuda time: 1.7768069505691528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817649841308594
New cuda time: 1.7705670595169067
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7977670431137085
New cuda time: 1.774886965751648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.803367018699646
New cuda time: 1.7827270030975342
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7758469581604004
New cuda time: 1.7832070589065552
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931269407272339
New cuda time: 1.7931269407272339
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888059616088867
New cuda time: 1.789126992225647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780007004737854
New cuda time: 1.7785669565200806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875269651412964
New cuda time: 1.780007004737854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8108869791030884
New cuda time: 1.7945669889450073
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787047028541565
New cuda time: 1.7817670106887817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786726951599121
New cuda time: 1.7798470258712769
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8091269731521606
New cuda time: 1.7766469717025757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7907270193099976
New cuda time: 1.7806470394134521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9704070091247559
New cuda time: 1.777446985244751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9529680013656616
New cuda time: 1.7716859579086304
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.93744695186615
New cuda time: 1.7835270166397095
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.942726969718933
New cuda time: 1.7635270357131958
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780007004737854
New cuda time: 1.780326008796692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939269542694092
New cuda time: 1.795686960220337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940870523452759
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7860859632492065
New cuda time: 1.7720060348510742
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955260276794434
New cuda time: 1.7824070453643799
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931269407272339
New cuda time: 1.7843270301818848
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876869440078735
New cuda time: 1.7696069478988647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8000069856643677
New cuda time: 1.7696069478988647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7926470041275024
New cuda time: 1.7670470476150513
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7838469743728638
New cuda time: 1.7852870225906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785669565200806
New cuda time: 1.7832070589065552
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889659404754639
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827270030975342
New cuda time: 1.785125970840454
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868870496749878
New cuda time: 1.7803269624710083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894469499588013
New cuda time: 1.8006470203399658
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832059860229492
New cuda time: 1.7852870225906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801766037940979
New cuda time: 1.7771259546279907
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960059642791748
New cuda time: 1.7907270193099976
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964869737625122
New cuda time: 1.7790460586547852
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7881669998168945
New cuda time: 1.7712069749832153
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976069450378418
New cuda time: 1.963366985321045
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953768014907837
New cuda time: 1.7672070264816284
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902469635009766
New cuda time: 1.9169670343399048
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9526480436325073
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7864069938659668
New cuda time: 1.7873669862747192
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7993669509887695
New cuda time: 1.771846055984497
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7886470556259155
New cuda time: 1.7654470205307007
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.535708904266357
New cuda time: 1.7614469528198242
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.95488703250885
New cuda time: 1.770725965499878
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7985659837722778
New cuda time: 1.7849669456481934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7921669483184814
New cuda time: 10.302438735961914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.961927056312561
New cuda time: 1.7832059860229492
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780326008796692
New cuda time: 1.7728060483932495
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7977670431137085
New cuda time: 1.778406023979187
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.793766975402832
New cuda time: 1.7750459909439087
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894459962844849
New cuda time: 1.7860870361328125
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7977670431137085
New cuda time: 1.772807002067566
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7900869846343994
New cuda time: 1.7846460342407227
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798406958580017
New cuda time: 1.7756860256195068
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7881660461425781
New cuda time: 1.780007004737854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875269651412964
New cuda time: 1.7763259410858154
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7822459936141968
New cuda time: 1.7745670080184937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969607949256897
New cuda time: 1.7843270301818848
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964860200881958
New cuda time: 1.9569660425186157
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7852870225906372
New cuda time: 1.9508880376815796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7958470582962036
New cuda time: 1.8856070041656494
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9592080116271973
New cuda time: 1.7894469499588013
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9582459926605225
New cuda time: 1.8147269487380981
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832000255584717
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9476799964904785
New cuda time: 1.9646400213241577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7979199886322021
New cuda time: 1.788159966468811
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859200239181519
New cuda time: 1.7660800218582153
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964799404144287
New cuda time: 1.7711999416351318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8033599853515625
New cuda time: 1.7822400331497192
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7942399978637695
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8112000226974487
New cuda time: 1.7854399681091309
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7958400249481201
New cuda time: 1.7801599502563477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940800189971924
New cuda time: 1.7992010116577148
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7995200157165527
New cuda time: 1.7776000499725342
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862399816513062
New cuda time: 1.78256094455719
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857600450515747
New cuda time: 1.7846410274505615
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7799999713897705
New cuda time: 1.7595200538635254
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876800298690796
New cuda time: 1.7902400493621826
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894400358200073
New cuda time: 1.7833600044250488
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8108799457550049
New cuda time: 1.7779200077056885
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8078399896621704
New cuda time: 1.7723209857940674
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7846399545669556
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7879999876022339
New cuda time: 1.776479959487915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918399572372437
New cuda time: 1.7713600397109985
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9734400510787964
New cuda time: 1.7851200103759766
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9494400024414062
New cuda time: 1.7915199995040894
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9536010026931763
New cuda time: 1.7774399518966675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9385600090026855
New cuda time: 1.7875200510025024
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894400358200073
New cuda time: 1.7705600261688232
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7731200456619263
New cuda time: 1.7700799703598022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7995200157165527
New cuda time: 1.7745599746704102
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8009599447250366
New cuda time: 1.7859200239181519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8041599988937378
New cuda time: 1.7755199670791626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804960012435913
New cuda time: 1.7732800245285034
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7988799810409546
New cuda time: 1.7870399951934814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78656005859375
New cuda time: 1.779520034790039
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7969599962234497
New cuda time: 1.7803200483322144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918399572372437
New cuda time: 1.7888000011444092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892800569534302
New cuda time: 1.790560007095337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.813439965248108
New cuda time: 1.781599998474121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7968000173568726
New cuda time: 1.7819199562072754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806400060653687
New cuda time: 1.781599998474121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777600288391113
New cuda time: 1.7595210075378418
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859200239181519
New cuda time: 1.779520034790039
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891199588775635
New cuda time: 1.7761600017547607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792639970779419
New cuda time: 1.7715200185775757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7966400384902954
New cuda time: 1.7675199508666992
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918399572372437
New cuda time: 1.776479959487915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790079951286316
New cuda time: 1.9428809881210327
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9580800533294678
New cuda time: 1.7723209857940674
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8051199913024902
New cuda time: 1.9672000408172607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9664009809494019
New cuda time: 1.7766400575637817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8040000200271606
New cuda time: 1.758241057395935
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790560007095337
New cuda time: 1.7836799621582031
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.77839994430542
New cuda time: 1.7841600179672241
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.482880115509033
New cuda time: 1.7984000444412231
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9718400239944458
New cuda time: 1.7915199995040894
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7729599475860596
New cuda time: 1.7774399518966675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899199724197388
New cuda time: 747.0983276367188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9656000137329102
New cuda time: 1.7799999713897705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.793280005455017
New cuda time: 1.779039978981018
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795199990272522
New cuda time: 1.7867200374603271
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8081599473953247
New cuda time: 1.7694400548934937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 1.7791999578475952
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8012800216674805
New cuda time: 1.779360055923462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8035199642181396
New cuda time: 1.764639973640442
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7675199508666992
New cuda time: 1.7804800271987915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899199724197388
New cuda time: 1.7724809646606445
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990399599075317
New cuda time: 1.7819199562072754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788159966468811
New cuda time: 1.7806400060653687
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.979200005531311
New cuda time: 1.7892800569534302
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950400114059448
New cuda time: 1.96943998336792
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843199968338013
New cuda time: 1.953760027885437
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8009599447250366
New cuda time: 1.8891199827194214
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9592000246047974
New cuda time: 1.780959963798523
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.95632004737854
New cuda time: 1.8172800540924072
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time:New cuda time: 1.7865530252456665
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9443119764328003
New cuda time: 1.9539129734039307
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.81967294216156
New cuda time: 1.7719930410385132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822232961654663
New cuda time: 1.7723129987716675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785112977027893
New cuda time: 1.7811130285263062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819512963294983
New cuda time: 1.7611130475997925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.82511305809021
New cuda time: 1.7751929759979248
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8159929513931274
New cuda time: 1.7766330242156982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8217530250549316
New cuda time: 1.762233018875122
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8263930082321167
New cuda time: 1.759032964706421
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8099130392074585
New cuda time: 1.7644729614257812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8023929595947266
New cuda time: 1.7588729858398438
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8227119445800781
New cuda time: 1.776473045349121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8244730234146118
New cuda time: 1.7812730073928833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.815513014793396
New cuda time: 1.8062330484390259
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8238329887390137
New cuda time: 1.7771129608154297
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8223929405212402
New cuda time: 1.76671302318573
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822072982788086
New cuda time: 1.7902339696884155
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8147130012512207
New cuda time: 1.769273042678833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8236730098724365
New cuda time: 1.766232967376709
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.7710330486297607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9673529863357544
New cuda time: 1.7686330080032349
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9655920267105103
New cuda time: 1.769273042678833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9471930265426636
New cuda time: 1.7686339616775513
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9585520029067993
New cuda time: 1.7924729585647583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8260730504989624
New cuda time: 1.7673530578613281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8263930082321167
New cuda time: 1.7742340564727783
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8299130201339722
New cuda time: 1.782073974609375
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8171130418777466
New cuda time: 1.7759929895401
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8348729610443115
New cuda time: 1.776473045349121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7903929948806763
New cuda time: 1.7678329944610596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.813433051109314
New cuda time: 1.7742329835891724
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8307119607925415
New cuda time: 1.7705529928207397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.7718340158462524
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8329529762268066
New cuda time: 1.7651129961013794
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8214329481124878
New cuda time: 1.752634048461914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8100719451904297
New cuda time: 1.7678329944610596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8182330131530762
New cuda time: 1.7548730373382568
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8135919570922852
New cuda time: 1.7627129554748535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8142329454421997
New cuda time: 1.7819130420684814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8147130012512207
New cuda time: 1.7852729558944702
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8289530277252197
New cuda time: 1.7801530361175537
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931129932403564
New cuda time: 1.7635129690170288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7831929922103882
New cuda time: 1.7846330404281616
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8171119689941406
New cuda time: 1.7731130123138428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8211129903793335
New cuda time: 1.9603129625320435
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9513520002365112
New cuda time: 1.7756730318069458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8177529573440552
New cuda time: 28.357009887695312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9791920185089111
New cuda time: 1.7743940353393555
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8116730451583862
New cuda time: 1.7852740287780762
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8121529817581177
New cuda time: 1.7716740369796753
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8212720155715942
New cuda time: 1.7681529521942139
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.483490943908691
New cuda time: 1.7806329727172852
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9646320343017578
New cuda time: 1.771193027496338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8299130201339722
New cuda time: 1.7718329429626465
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8236720561981201
New cuda time: 755.671142578125
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9819120168685913
New cuda time: 1.7631930112838745
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8233519792556763
New cuda time: 1.7766330242156982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8270330429077148
New cuda time: 1.771193027496338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824152946472168
New cuda time: 1.7700730562210083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.7867130041122437
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8287930488586426
New cuda time: 1.7651129961013794
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822072982788086
New cuda time: 1.7790329456329346
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8132729530334473
New cuda time: 1.7655930519104004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8163130283355713
New cuda time: 1.7686330080032349
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.82511305809021
New cuda time: 1.7700730562210083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.833752989768982
New cuda time: 1.7763129472732544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9945520162582397
New cuda time: 1.7676730155944824
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873530387878418
New cuda time: 1.9751919507980347
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8228729963302612
New cuda time: 1.9750330448150635
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8148729801177979
New cuda time: 1.7715129852294922
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.966552972793579
New cuda time: 1.7745529413223267
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9935929775238037
New cuda time: 1.7742329835891724
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time:New cuda time: 1.7718479633331299
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9542490243911743
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 261.402587890625, gpu time: 47.31445395946503
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 10.498046875
Expert1 unused count: 110
Expert2 unused count: 244
Expert1 balance top: 68.45703125
Expert2 balance top: 87.40234375

New cuda time: 1.821287989616394
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9504090547561646
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 995.424560546875, gpu time: 55.68921375274658
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 15.13671875
Expert1 unused count: 101
Expert2 unused count: 294
Expert1 balance top: 68.359375
Expert2 balance top: 92.626953125

New cuda time: 1.8136080503463745
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9545689821243286
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 311.941162109375, gpu time: 47.06437635421753
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 1.708984375
Expert1 unused count: 115
Expert2 unused count: 270
Expert1 balance top: 67.48046875
Expert2 balance top: 90.380859375

New cuda time: 1.8062479496002197
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9595290422439575
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 326.352294921875, gpu time: 53.09816336631775
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 105
Expert2 unused count: 235
Expert1 balance top: 66.015625
Expert2 balance top: 87.158203125

New cuda time: 1.7598479986190796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9595290422439575
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 281.531982421875, gpu time: 47.29621601104736
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.3671875
Expert1 unused count: 96
Expert2 unused count: 197
Expert1 balance top: 65.673828125
Expert2 balance top: 83.740234375

New cuda time: 1.8219289779663086
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9144090414047241
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 232.628173828125, gpu time: 47.44821798801422
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.3671875
Expert2 overflow: 1.513671875
Expert1 unused count: 119
Expert2 unused count: 159
Expert1 balance top: 68.1640625
Expert2 balance top: 74.755859375

New cuda time: 1.9539289474487305
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7809679508209229
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 336.215087890625, gpu time: 51.04935085773468
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.9296875
Expert2 overflow: 10.44921875
Expert1 unused count: 188
Expert2 unused count: 292
Expert1 balance top: 78.955078125
Expert2 balance top: 92.724609375

New cuda time: 82.2733383178711
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7726479768753052
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1086.32568359375, gpu time: 139.73520004749298
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.685546875
Expert2 overflow: 2.63671875
Expert1 unused count: 197
Expert2 unused count: 297
Expert1 balance top: 80.37109375
Expert2 balance top: 91.69921875

New cuda time: 1.8232090473175049
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.960649013519287
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 394.081787109375, gpu time: 50.848233342170715
2024-07-11 01:41:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.26953125
Expert1 unused count: 180
Expert2 unused count: 280
Expert1 balance top: 76.66015625
Expert2 balance top: 89.94140625

New cuda time: 1.8057689666748047
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9449690580368042
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 407.913330078125, gpu time: 56.84890043735504
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.61328125
Expert2 overflow: 1.953125
Expert1 unused count: 172
Expert2 unused count: 251
Expert1 balance top: 77.392578125
Expert2 balance top: 87.98828125

New cuda time: 1.774407982826233
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.957929015159607
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 358.55224609375, gpu time: 51.0285530090332
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.927734375
Expert1 unused count: 184
Expert2 unused count: 256
Expert1 balance top: 79.296875
Expert2 balance top: 88.818359375

New cuda time: 1.7756880521774292
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9121689796447754
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 241.59814453125, gpu time: 51.136075019836426
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.5859375
Expert1 unused count: 206
Expert2 unused count: 253
Expert1 balance top: 81.15234375
Expert2 balance top: 84.521484375

New cuda time: 1.94576895236969
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.15140533447266
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 497.461669921875, gpu time: 134.14652514457703
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.783203125
Expert1 unused count: 114
Expert2 unused count: 258
Expert1 balance top: 66.552734375
Expert2 balance top: 87.939453125

New cuda time: 6.8160319328308105
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9622490406036377
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1181.066650390625, gpu time: 148.5134800672531
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 2.099609375
Expert1 unused count: 149
Expert2 unused count: 288
Expert1 balance top: 68.5546875
Expert2 balance top: 92.724609375

New cuda time: 1.8155289888381958
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9526489973068237
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 479.931884765625, gpu time: 54.61641037464142
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.953125
Expert1 unused count: 149
Expert2 unused count: 272
Expert1 balance top: 69.7265625
Expert2 balance top: 89.404296875

New cuda time: 1.8064080476760864
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9643290042877197
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 487.6298828125, gpu time: 60.61963748931885
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.443359375
Expert1 unused count: 165
Expert2 unused count: 256
Expert1 balance top: 71.58203125
Expert2 balance top: 86.181640625

New cuda time: 1.8017679452896118
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.928009033203125
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 431.580322265625, gpu time: 54.758331060409546
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.634765625
Expert1 unused count: 173
Expert2 unused count: 199
Expert1 balance top: 72.4609375
Expert2 balance top: 78.125

New cuda time: 1.7609679698944092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8208080530166626
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 251.060546875, gpu time: 54.7178510427475
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.24609375
Expert1 unused count: 193
Expert2 unused count: 224
Expert1 balance top: 74.951171875
Expert2 balance top: 75.5859375

New cuda time: 1.9398490190505981
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7825690507888794
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 584.6572265625, gpu time: 137.8689432144165
2024-07-11 01:41:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 20.01953125
Expert2 overflow: 6.787109375
Expert1 unused count: 282
Expert2 unused count: 352
Expert1 balance top: 90.72265625
Expert2 balance top: 96.826171875

New cuda time: 1.950888991355896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780168056488037
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1265.084716796875, gpu time: 152.24453711509705
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.98046875
Expert2 overflow: 11.376953125
Expert1 unused count: 311
Expert2 unused count: 369
Expert1 balance top: 92.431640625
Expert2 balance top: 97.75390625

New cuda time: 2.0169689655303955
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9460890293121338
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 653.42919921875, gpu time: 58.579469323158264
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 20.947265625
Expert1 unused count: 333
Expert2 unused count: 349
Expert1 balance top: 95.1171875
Expert2 balance top: 95.99609375

New cuda time: 1.7686480283737183
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788329005241394
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 499.143310546875, gpu time: 64.17661452293396
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.765625
Expert2 overflow: 3.466796875
Expert1 unused count: 349
Expert2 unused count: 337
Expert1 balance top: 95.703125
Expert2 balance top: 95.21484375

New cuda time: 1.9499289989471436
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.94576895236969
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 592.6533203125, gpu time: 58.65402901172638
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 12.20703125
Expert1 unused count: 376
Expert2 unused count: 373
Expert1 balance top: 98.291015625
Expert2 balance top: 97.705078125

New cuda time: 1.7980890274047852
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.778568983078003
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 260.200439453125, gpu time: 58.294509053230286
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.740234375
Expert2 overflow: 5.810546875
Expert1 unused count: 372
Expert2 unused count: 357
Expert1 balance top: 97.75390625
Expert2 balance top: 95.60546875

New cuda time: 2.2400100231170654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939280271530151
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 671.39501953125, gpu time: 141.90288126468658
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 8.7890625
Expert1 unused count: 171
Expert2 unused count: 281
Expert1 balance top: 74.4140625
Expert2 balance top: 92.041015625

New cuda time: 1.9524890184402466
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894480228424072
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1348.454345703125, gpu time: 155.9864741563797
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 2.05078125
Expert1 unused count: 196
Expert2 unused count: 302
Expert1 balance top: 78.076171875
Expert2 balance top: 92.529296875

New cuda time: 1.9403289556503296
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78656804561615
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 734.0888671875, gpu time: 62.306366324424744
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.7578125
Expert1 unused count: 183
Expert2 unused count: 303
Expert1 balance top: 74.31640625
Expert2 balance top: 91.69921875

New cuda time: 1.8152079582214355
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.958088994026184
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 568.945068359375, gpu time: 67.94991147518158
2024-07-11 01:41:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.345703125
Expert2 overflow: 2.34375
Expert1 unused count: 208
Expert2 unused count: 278
Expert1 balance top: 78.61328125
Expert2 balance top: 88.96484375

New cuda time: 1.814247965812683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 80.36612701416016
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 679.955322265625, gpu time: 140.83440506458282
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 231
Expert2 unused count: 278
Expert1 balance top: 80.46875
Expert2 balance top: 88.76953125

New cuda time: 1.8188879489898682
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7864079475402832
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 269.679443359375, gpu time: 61.89980494976044
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.953125
Expert2 overflow: 3.7109375
Expert1 unused count: 226
Expert2 unused count: 268
Expert1 balance top: 80.517578125
Expert2 balance top: 83.59375

New cuda time: 1.9440089464187622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7856080532073975
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 758.7568359375, gpu time: 145.63249826431274
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.95703125
Expert1 unused count: 147
Expert2 unused count: 260
Expert1 balance top: 70.947265625
Expert2 balance top: 89.16015625

New cuda time: 1.9387290477752686
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910480499267578
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1426.85546875, gpu time: 159.71625125408173
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 2.685546875
Expert1 unused count: 167
Expert2 unused count: 292
Expert1 balance top: 75.29296875
Expert2 balance top: 91.30859375

New cuda time: 75.1491470336914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.904968023300171
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 823.84423828125, gpu time: 139.36048138141632
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 3.955078125
Expert1 unused count: 172
Expert2 unused count: 288
Expert1 balance top: 73.73046875
Expert2 balance top: 91.064453125

New cuda time: 2.067368984222412
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777127981185913
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 651.74755859375, gpu time: 71.7944084405899
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.5390625
Expert2 overflow: 0.87890625
Expert1 unused count: 174
Expert2 unused count: 266
Expert1 balance top: 74.658203125
Expert2 balance top: 88.134765625

New cuda time: 1.8038480281829834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9561690092086792
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 751.982177734375, gpu time: 144.5944230556488
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 195
Expert2 unused count: 226
Expert1 balance top: 75.5859375
Expert2 balance top: 84.765625

New cuda time: 1.8081690073013306
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775048017501831
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 278.669677734375, gpu time: 65.4830219745636
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 3.22265625
Expert1 unused count: 206
Expert2 unused count: 231
Expert1 balance top: 79.00390625
Expert2 balance top: 77.63671875

New cuda time: 1.9428889751434326
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9609689712524414
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 933.397216796875, gpu time: 149.53635621070862
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 6.8359375
Expert1 unused count: 169
Expert2 unused count: 278
Expert1 balance top: 71.826171875
Expert2 balance top: 90.33203125

New cuda time: 1.8057689666748047
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9484889507293701
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1509.042236328125, gpu time: 163.47050821781158
2024-07-11 01:41:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 4.150390625
Expert1 unused count: 181
Expert2 unused count: 302
Expert1 balance top: 76.318359375
Expert2 balance top: 92.28515625

New cuda time: 1.8172880411148071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9496090412139893
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 901.738525390625, gpu time: 143.12737941741943
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.146484375
Expert1 unused count: 179
Expert2 unused count: 295
Expert1 balance top: 74.658203125
Expert2 balance top: 90.72265625

New cuda time: 1.802569031715393
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7896080017089844
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 660.56884765625, gpu time: 75.38658547401428
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.44140625
Expert2 overflow: 2.880859375
Expert1 unused count: 200
Expert2 unused count: 266
Expert1 balance top: 76.806640625
Expert2 balance top: 88.0859375

New cuda time: 1.9494489431381226
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7761679887771606
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 834.329833984375, gpu time: 148.3200399875641
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 205
Expert2 unused count: 257
Expert1 balance top: 77.734375
Expert2 balance top: 86.5234375

New cuda time: 1.946408987045288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7723280191421509
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 361.26904296875, gpu time: 69.20175898075104
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 2.294921875
Expert1 unused count: 204
Expert2 unused count: 234
Expert1 balance top: 77.734375
Expert2 balance top: 80.46875

New cuda time: 1.9307279586791992
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7766480445861816
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1009.5166015625, gpu time: 153.243732213974
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.9765625
Expert2 overflow: 7.470703125
Expert1 unused count: 160
Expert2 unused count: 282
Expert1 balance top: 71.484375
Expert2 balance top: 90.91796875

New cuda time: 1.8040080070495605
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880079746246338
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1521.369384765625, gpu time: 167.06252419948578
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 0.927734375
Expert1 unused count: 150
Expert2 unused count: 287
Expert1 balance top: 72.607421875
Expert2 balance top: 90.478515625

New cuda time: 1.8169679641723633
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7844879627227783
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 911.3056640625, gpu time: 146.72883534431458
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 1.07421875
Expert1 unused count: 156
Expert2 unused count: 289
Expert1 balance top: 71.38671875
Expert2 balance top: 90.625

New cuda time: 1.8035290241241455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7708879709243774
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 669.8720703125, gpu time: 78.9610024690628
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 1.07421875
Expert1 unused count: 163
Expert2 unused count: 253
Expert1 balance top: 71.435546875
Expert2 balance top: 86.71875

New cuda time: 1.805448055267334
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7782490253448486
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 843.498291015625, gpu time: 151.90373706817627
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.68359375
Expert1 unused count: 196
Expert2 unused count: 245
Expert1 balance top: 75.048828125
Expert2 balance top: 86.376953125

New cuda time: 1.804967999458313
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777127981185913
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 370.06494140625, gpu time: 72.78385496139526
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 0.830078125
Expert1 unused count: 197
Expert2 unused count: 217
Expert1 balance top: 74.853515625
Expert2 balance top: 78.955078125

New cuda time: 1.810088038444519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7864079475402832
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1020.3115234375, gpu time: 156.8402281999588
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.275390625
Expert2 overflow: 9.86328125
Expert1 unused count: 226
Expert2 unused count: 331
Expert1 balance top: 87.060546875
Expert2 balance top: 95.751953125

New cuda time: 1.8006479740142822
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915290594100952
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1530.140869140625, gpu time: 170.65470123291016
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 13.28125
Expert2 overflow: 4.39453125
Expert1 unused count: 234
Expert2 unused count: 323
Expert1 balance top: 88.427734375
Expert2 balance top: 95.01953125

New cuda time: 1.7993680238723755
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7956880331039429
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 920.169189453125, gpu time: 150.3238914012909
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.326171875
Expert2 overflow: 3.125
Expert1 unused count: 225
Expert2 unused count: 307
Expert1 balance top: 86.962890625
Expert2 balance top: 92.626953125

New cuda time: 1.8129680156707764
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857680320739746
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 678.69970703125, gpu time: 82.55973851680756
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 1.513671875
Expert1 unused count: 221
Expert2 unused count: 298
Expert1 balance top: 85.05859375
Expert2 balance top: 91.89453125

New cuda time: 1.804967999458313
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.772009015083313
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 854.652587890625, gpu time: 155.4807140827179
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.90625
Expert1 unused count: 241
Expert2 unused count: 284
Expert1 balance top: 86.328125
Expert2 balance top: 90.966796875

New cuda time: 1.8089679479599
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889690399169922
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 380.1220703125, gpu time: 76.38179194927216
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 1.26953125
Expert1 unused count: 258
Expert2 unused count: 260
Expert1 balance top: 86.328125
Expert2 balance top: 86.1328125

New cuda time: 1.8184080123901367
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7779279947280884
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1030.806640625, gpu time: 160.43656420707703
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.66015625
Expert1 unused count: 140
Expert2 unused count: 252
Expert1 balance top: 71.97265625
Expert2 balance top: 88.671875

New cuda time: 1.793287992477417
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7780879735946655
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1539.302978515625, gpu time: 174.22607719898224
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.953125
Expert1 unused count: 145
Expert2 unused count: 307
Expert1 balance top: 73.388671875
Expert2 balance top: 92.96875

New cuda time: 1.8035279512405396
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796880006790161
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 929.761962890625, gpu time: 153.90710735321045
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.68359375
Expert1 unused count: 148
Expert2 unused count: 274
Expert1 balance top: 72.802734375
Expert2 balance top: 90.4296875

New cuda time: 1.772487998008728
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9480079412460327
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 694.33251953125, gpu time: 86.28023445606232
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 0.78125
Expert1 unused count: 163
Expert2 unused count: 275
Expert1 balance top: 73.193359375
Expert2 balance top: 88.916015625

New cuda time: 1.8195279836654663
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.774407982826233
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 866.298828125, gpu time: 159.0746500492096
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 178
Expert2 unused count: 244
Expert1 balance top: 74.8046875
Expert2 balance top: 85.83984375

New cuda time: 1.8144079446792603
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8219280242919922
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 392.632080078125, gpu time: 80.01812791824341
2024-07-11 01:41:46 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 2.001953125
Expert1 unused count: 184
Expert2 unused count: 221
Expert1 balance top: 75.732421875
Expert2 balance top: 78.369140625

New cuda time: 1.776968002319336
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9409689903259277
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1044.875244140625, gpu time: 164.1545011997223
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.95703125
Expert2 overflow: 4.6875
Expert1 unused count: 275
Expert2 unused count: 332
Expert1 balance top: 84.66796875
Expert2 balance top: 94.677734375

New cuda time: 1.7731280326843262
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.941288948059082
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1555.82470703125, gpu time: 177.94049417972565
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.98046875
Expert2 overflow: 5.2734375
Expert1 unused count: 276
Expert2 unused count: 339
Expert1 balance top: 84.619140625
Expert2 balance top: 94.873046875

New cuda time: 1.8054490089416504
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9486490488052368
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 943.312744140625, gpu time: 157.66120541095734
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.537109375
Expert2 overflow: 1.5625
Expert1 unused count: 279
Expert2 unused count: 327
Expert1 balance top: 84.375
Expert2 balance top: 92.724609375

New cuda time: 1.9390490055084229
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.816167950630188
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 709.8369140625, gpu time: 90.03545141220093
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.857421875
Expert2 overflow: 3.22265625
Expert1 unused count: 289
Expert2 unused count: 322
Expert1 balance top: 85.64453125
Expert2 balance top: 92.333984375

New cuda time: 1.8118489980697632
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7603280544281006
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 876.427734375, gpu time: 162.64682710170746
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 3.7109375
Expert1 unused count: 299
Expert2 unused count: 326
Expert1 balance top: 87.841796875
Expert2 balance top: 93.408203125

New cuda time: 1.7832080125808716
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7865689992904663
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 402.015869140625, gpu time: 83.58790493011475
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 2.197265625
Expert1 unused count: 294
Expert2 unused count: 307
Expert1 balance top: 86.474609375
Expert2 balance top: 89.794921875

New cuda time: 1.812648057937622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7667280435562134
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1055.817626953125, gpu time: 167.73387825489044
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 10.3515625
Expert2 overflow: 10.546875
Expert1 unused count: 320
Expert2 unused count: 341
Expert1 balance top: 94.580078125
Expert2 balance top: 96.435546875

New cuda time: 1.9667290449142456
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910490036010742
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1572.45947265625, gpu time: 181.69827222824097
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 14.111328125
Expert2 overflow: 3.564453125
Expert1 unused count: 324
Expert2 unused count: 354
Expert1 balance top: 94.3359375
Expert2 balance top: 96.97265625

New cuda time: 1.8028889894485474
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8201680183410645
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 951.858154296875, gpu time: 161.28426146507263
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 12.59765625
Expert2 overflow: 4.00390625
Expert1 unused count: 327
Expert2 unused count: 351
Expert1 balance top: 93.1640625
Expert2 balance top: 96.58203125

New cuda time: 1.8073680400848389
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7956880331039429
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 718.640869140625, gpu time: 93.63850748538971
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 2.5390625
Expert1 unused count: 317
Expert2 unused count: 339
Expert1 balance top: 91.50390625
Expert2 balance top: 95.1171875

New cuda time: 1.809607982635498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804008960723877
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 885.188232421875, gpu time: 166.26044404506683
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.955078125
Expert1 unused count: 325
Expert2 unused count: 346
Expert1 balance top: 91.50390625
Expert2 balance top: 95.751953125

New cuda time: 9.331722259521484
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8273680210113525
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 418.324462890625, gpu time: 94.74699521064758
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.78125
Expert1 unused count: 342
Expert2 unused count: 350
Expert1 balance top: 94.287109375
Expert2 balance top: 95.60546875

New cuda time: 1.8104079961776733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950489521026611
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1064.70654296875, gpu time: 171.3393361568451
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.421875
Expert1 unused count: 236
Expert2 unused count: 319
Expert1 balance top: 83.7890625
Expert2 balance top: 94.580078125

New cuda time: 1.9580860137939453
New cuda time: 1.7832070589065552
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9694470167160034
New cuda time: 1.784646987915039
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9569669961929321
New cuda time: 1.7766469717025757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9670460224151611
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9668879508972168
New cuda time: 1.7862470149993896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.891206979751587
New cuda time: 1.9464069604873657
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931269407272339
New cuda time: 82.259033203125
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924870252609253
New cuda time: 1.7836869955062866
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9566459655761719
New cuda time: 1.7793660163879395
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9689669609069824
New cuda time: 1.8075259923934937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.964967966079712
New cuda time: 1.7756860256195068
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9520070552825928
New cuda time: 1.9520070552825928
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.15198516845703
New cuda time: 6.812026023864746
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9617669582366943
New cuda time: 1.7792060375213623
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9683270454406738
New cuda time: 1.7894469499588013
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9592070579528809
New cuda time: 1.78512704372406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9617669582366943
New cuda time: 1.7940870523452759
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7803269624710083
New cuda time: 1.9624069929122925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7881669998168945
New cuda time: 1.9534469842910767
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8009660243988037
New cuda time: 2.1300880908966064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9678469896316528
New cuda time: 1.7788870334625244
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8006470203399658
New cuda time: 1.9422470331192017
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9536069631576538
New cuda time: 1.7809669971466064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789607048034668
New cuda time: 2.271368980407715
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.802886962890625
New cuda time: 1.9377670288085938
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876859903335571
New cuda time: 1.9475270509719849
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964860200881958
New cuda time: 1.7793660163879395
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9428869485855103
New cuda time: 1.7736059427261353
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 80.3964614868164
New cuda time: 1.7764860391616821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832070589065552
New cuda time: 1.9312069416046143
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7800060510635376
New cuda time: 1.96144700050354
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990469932556152
New cuda time: 78.43709564208984
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9195270538330078
New cuda time: 74.4634780883789
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.791206955909729
New cuda time: 1.7884869575500488
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9590469598770142
New cuda time: 1.7689670324325562
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7772860527038574
New cuda time: 1.9670469760894775
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9713670015335083
New cuda time: 1.7864069938659668
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9571269750595093
New cuda time: 1.7790470123291016
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9587270021438599
New cuda time: 1.7876869440078735
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777927041053772
New cuda time: 1.9440070390701294
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796167016029358
New cuda time: 1.9396870136260986
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960070371627808
New cuda time: 67.06632995605469
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936069965362549
New cuda time: 1.7817670106887817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784487009048462
New cuda time: 1.779845952987671
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779526948928833
New cuda time: 1.7723259925842285
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884869575500488
New cuda time: 1.7752070426940918
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7724859714508057
New cuda time: 1.7630460262298584
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.847206950187683
New cuda time: 1.794566035270691
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832070589065552
New cuda time: 1.7801669836044312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7982460260391235
New cuda time: 1.7916860580444336
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7814470529556274
New cuda time: 1.7945669889450073
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924870252609253
New cuda time: 1.7833670377731323
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7883269786834717
New cuda time: 1.7740869522094727
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7835270166397095
New cuda time: 1.775527000427246
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7886470556259155
New cuda time: 1.7691270112991333
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8019269704818726
New cuda time: 1.777446985244751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7908869981765747
New cuda time: 1.8036869764328003
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9529680013656616
New cuda time: 1.7876869440078735
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7809669971466064
New cuda time: 1.7934459447860718
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.949766993522644
New cuda time: 1.868327021598816
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9531270265579224
New cuda time: 1.8020869493484497
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9651269912719727
New cuda time: 1.7710469961166382
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953287959098816
New cuda time: 1.9481680393218994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7819260358810425
New cuda time: 1.7801669836044312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7958470582962036
New cuda time: 1.787047028541565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7808070182800293
New cuda time: 1.7752070426940918
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7969670295715332
New cuda time: 1.940487027168274
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7771270275115967
New cuda time: 1.784006953239441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892869710922241
New cuda time: 1.7742470502853394
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794247031211853
New cuda time: 1.7819269895553589
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936069965362549
New cuda time: 9.335394859313965
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976059913635254
New cuda time: 1.768326997756958
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8046469688415527
New cuda time: 1.7784069776535034
 1.9841519594192505
New cuda time: 1.7620739936828613
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9700720310211182
New cuda time: 1.7467130422592163
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9652719497680664
New cuda time: 1.7806340456008911
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9905519485473633
New cuda time: 1.8004729747772217
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9742319583892822
New cuda time: 1.773432970046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 65.22615051269531
New cuda time: 1.9673529863357544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8169529438018799
New cuda time: 82.32879638671875
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8207930326461792
New cuda time: 1.7705529928207397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9827120304107666
New cuda time: 1.7675139904022217
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9838329553604126
New cuda time: 1.7780729532241821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9929510354995728
New cuda time: 1.7788729667663574
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7865530252456665
New cuda time: 1.964473009109497
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.922711968421936
New cuda time: 6.804452896118164
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9835129976272583
New cuda time: 1.7718329429626465
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.979511022567749
New cuda time: 1.771193027496338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9779130220413208
New cuda time: 1.7681529521942139
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9583920240402222
New cuda time: 1.8190330266952515
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7775930166244507
New cuda time: 1.9571130275726318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8179130554199219
New cuda time: 1.974552035331726
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8116730451583862
New cuda time: 1.740952968597412
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9700720310211182
New cuda time: 1.8161530494689941
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8235130310058594
New cuda time: 1.9731119871139526
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9675120115280151
New cuda time: 1.7817529439926147
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8262330293655396
New cuda time: 1.9012720584869385
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787034034729004
New cuda time: 1.9833530187606812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8268729448318481
New cuda time: 1.9684720039367676
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8238329887390137
New cuda time: 1.7609529495239258
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.973912000656128
New cuda time: 1.7609529495239258
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 80.46192932128906
New cuda time: 1.7751929759979248
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8167929649353027
New cuda time: 1.9580719470977783
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8198330402374268
New cuda time: 1.9716720581054688
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8156729936599731
New cuda time: 78.1873779296875
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9444719552993774
New cuda time: 1.8814330101013184
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8167929649353027
New cuda time: 1.7607929706573486
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9691120386123657
New cuda time: 1.7791930437088013
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7995129823684692
New cuda time: 1.9795130491256714
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9748719930648804
New cuda time: 1.7508729696273804
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9767919778823853
New cuda time: 1.7654329538345337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9830329418182373
New cuda time: 1.7852729558944702
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798712968826294
New cuda time: 1.959833025932312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824633002281189
New cuda time: 1.9723119735717773
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.843032956123352
New cuda time: 1.7879929542541504
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8204729557037354
New cuda time: 1.76015305519104
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8249529600143433
New cuda time: 1.7535929679870605
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8260730504989624
New cuda time: 1.7678329944610596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.7700730562210083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8158329725265503
New cuda time: 1.7831929922103882
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787192940711975
New cuda time: 1.785593032836914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8265529870986938
New cuda time: 1.7663929462432861
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.791672945022583
New cuda time: 1.7494330406188965
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7844740152359009
New cuda time: 1.7683130502700806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7937530279159546
New cuda time: 1.7801530361175537
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8057529926300049
New cuda time: 1.7607929706573486
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8233530521392822
New cuda time: 1.7675130367279053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8275129795074463
New cuda time: 1.773432970046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.829591989517212
New cuda time: 1.7619140148162842
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8171130418777466
New cuda time: 1.8351930379867554
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9851130247116089
New cuda time: 1.7655930519104004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8217530250549316
New cuda time: 1.7657530307769775
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7678329944610596
New cuda time: 1.7735929489135742
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9583929777145386
New cuda time: 1.7863930463790894
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9663920402526855
New cuda time: 1.778393030166626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9841530323028564
New cuda time: 1.917593002319336
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775514006614685
New cuda time: 1.7627129554748535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8148729801177979
New cuda time: 1.7788729667663574
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913529872894287
New cuda time: 1.7691129446029663
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8230329751968384
New cuda time: 1.9380719661712646
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.812952995300293
New cuda time: 1.7627129554748535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913529872894287
New cuda time: 1.7678329944610596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782392978668213
New cuda time: 1.7651129961013794
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7735940217971802
New cuda time: 9.330683708190918
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7937530279159546
New cuda time: 1.7750329971313477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79727303981781
New cuda time: 1.7686339616775513
torch.Size([4, 128, 103, 768])  1.9691200256347656
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9638400077819824
New cuda time: 1.7894400358200073
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9516799449920654
New cuda time: 1.7686400413513184
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9676799774169922
New cuda time: 1.7779200077056885
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.968000054359436
New cuda time: 1.795680046081543
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9294400215148926
New cuda time: 1.9494400024414062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780959963798523
New cuda time: 82.23873138427734
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899199724197388
New cuda time: 1.7980799674987793
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9672000408172607
New cuda time: 1.764639973640442
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9692800045013428
New cuda time: 1.80239999294281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9588799476623535
New cuda time: 1.769279956817627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9430400133132935
New cuda time: 1.9665600061416626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.156005859375
New cuda time: 6.817601203918457
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9686399698257446
New cuda time: 1.7891199588775635
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9651199579238892
New cuda time: 1.7771199941635132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.955839991569519
New cuda time: 1.7729599475860596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9648000001907349
New cuda time: 1.7830400466918945
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960000038146973
New cuda time: 1.967360019683838
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.9481600522994995
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785600423812866
New cuda time: 2.1468799114227295
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9684799909591675
New cuda time: 1.774880051612854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.778880000114441
New cuda time: 1.9529600143432617
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969599962234497
New cuda time: 1.7585599422454834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8054399490356445
New cuda time: 76.07984924316406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876800298690796
New cuda time: 1.9510400295257568
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894400358200073
New cuda time: 1.944000005722046
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7948800325393677
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9615999460220337
New cuda time: 1.7768000364303589
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 80.37760925292969
New cuda time: 1.7761600017547607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902400493621826
New cuda time: 1.9292800426483154
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7934399843215942
New cuda time: 1.9520000219345093
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7772799730300903
New cuda time: 75.10160827636719
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9464000463485718
New cuda time: 74.46112823486328
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7971199750900269
New cuda time: 1.7756799459457397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9580800533294678
New cuda time: 1.7777600288391113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.797279953956604
New cuda time: 1.9502400159835815
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9606399536132812
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9559999704360962
New cuda time: 1.7716799974441528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9636800289154053
New cuda time: 1.7638399600982666
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899199724197388
New cuda time: 1.9409600496292114
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7883199453353882
New cuda time: 1.9475200176239014
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7961599826812744
New cuda time: 1.9246400594711304
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862399816513062
New cuda time: 1.7796800136566162
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939200401306152
New cuda time: 1.7777600288391113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955199480056763
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950400114059448
New cuda time: 1.7836799621582031
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7968000173568726
New cuda time: 1.7873599529266357
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.835360050201416
New cuda time: 1.7715200185775757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857609987258911
New cuda time: 1.7691199779510498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828799486160278
New cuda time: 1.7948800325393677
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924799919128418
New cuda time: 1.776319980621338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876800298690796
New cuda time: 1.77839994430542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843209505081177
New cuda time: 1.7740800380706787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7953599691390991
New cuda time: 1.785599946975708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8123199939727783
New cuda time: 1.7711999416351318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8076800107955933
New cuda time: 1.7827199697494507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913600206375122
New cuda time: 1.8086400032043457
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9553600549697876
New cuda time: 1.7791999578475952
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7908810377120972
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.946560025215149
New cuda time: 1.8809599876403809
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9433599710464478
New cuda time: 1.8052799701690674
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9755200147628784
New cuda time: 1.7766400575637817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9545600414276123
New cuda time: 1.9572800397872925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924799919128418
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910399436950684
New cuda time: 1.7760000228881836
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8155200481414795
New cuda time: 1.7796800136566162
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7948800325393677
New cuda time: 1.943519949913025
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8137609958648682
New cuda time: 1.7684799432754517
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940800189971924
New cuda time: 1.77839994430542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7812800407409668
New cuda time: 1.7867200374603271
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7851200103759766
New cuda time: 9.327521324157715
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920010089874268
New cuda time: 1.7774399518966675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8035199642181396
New cuda time: 1.7852799892425537
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8107290267944336
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7905679941177368
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1581.445068359375, gpu time: 185.29956924915314
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.033203125
Expert1 unused count: 243
Expert2 unused count: 348
Expert1 balance top: 84.130859375
Expert2 balance top: 96.875

New cuda time: 1.7651280164718628
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9505690336227417
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 968.594970703125, gpu time: 164.99995851516724
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 9.033203125
Expert1 unused count: 254
Expert2 unused count: 340
Expert1 balance top: 86.328125
Expert2 balance top: 95.99609375

New cuda time: 1.9774490594863892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894489765167236
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 733.55517578125, gpu time: 97.40540552139282
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 6.34765625
Expert1 unused count: 258
Expert2 unused count: 320
Expert1 balance top: 85.15625
Expert2 balance top: 94.384765625

New cuda time: 1.802888035774231
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8030489683151245
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 894.340087890625, gpu time: 169.8663810491562
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.392578125
Expert1 unused count: 284
Expert2 unused count: 305
Expert1 balance top: 86.767578125
Expert2 balance top: 92.578125

New cuda time: 1.8006479740142822
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828880548477173
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 427.2607421875, gpu time: 98.33053123950958
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 14.306640625
Expert2 overflow: 6.0546875
Expert1 unused count: 276
Expert2 unused count: 294
Expert1 balance top: 88.037109375
Expert2 balance top: 89.208984375

New cuda time: 1.960649013519287
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7968080043792725
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1079.58935546875, gpu time: 175.09679317474365
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 5.859375
Expert1 unused count: 124
Expert2 unused count: 260
Expert1 balance top: 68.994140625
Expert2 balance top: 89.208984375

New cuda time: 1.969288945198059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8088090419769287
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1595.04736328125, gpu time: 189.07766723632812
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.685546875
Expert1 unused count: 141
Expert2 unused count: 286
Expert1 balance top: 71.240234375
Expert2 balance top: 90.8203125

New cuda time: 1.8060879707336426
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8105690479278564
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 977.159912109375, gpu time: 168.61661660671234
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.9765625
Expert1 unused count: 128
Expert2 unused count: 262
Expert1 balance top: 68.1640625
Expert2 balance top: 89.306640625

New cuda time: 1.8057680130004883
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8235290050506592
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 742.30859375, gpu time: 101.03470253944397
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 1.953125
Expert1 unused count: 162
Expert2 unused count: 245
Expert1 balance top: 73.33984375
Expert2 balance top: 86.1328125

New cuda time: 1.7996879816055298
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8158479928970337
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 903.063232421875, gpu time: 173.48191702365875
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.29296875
Expert1 unused count: 185
Expert2 unused count: 221
Expert1 balance top: 73.828125
Expert2 balance top: 82.12890625

New cuda time: 8.867240905761719
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.823207974433899
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 443.0166015625, gpu time: 109.0209801197052
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.953125
Expert2 overflow: 1.123046875
Expert1 unused count: 191
Expert2 unused count: 237
Expert1 balance top: 75.927734375
Expert2 balance top: 79.1015625

New cuda time: 1.8041679859161377
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8272089958190918
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1088.2109375, gpu time: 178.7281712293625
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.279296875
Expert1 unused count: 199
Expert2 unused count: 276
Expert1 balance top: 77.44140625
Expert2 balance top: 90.478515625

New cuda time: 1.786087989807129
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7947280406951904
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1606.43994140625, gpu time: 192.65848326683044
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 2.83203125
Expert1 unused count: 205
Expert2 unused count: 315
Expert1 balance top: 80.078125
Expert2 balance top: 93.603515625

New cuda time: 1.809448003768921
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8072090148925781
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 986.078125, gpu time: 172.23327457904816
2024-07-11 01:41:47 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.78125
Expert2 overflow: 2.880859375
Expert1 unused count: 213
Expert2 unused count: 311
Expert1 balance top: 77.001953125
Expert2 balance top: 92.48046875

New cuda time: 1.8129689693450928
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8281689882278442
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 753.977294921875, gpu time: 104.6758404970169
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.123046875
Expert1 unused count: 241
Expert2 unused count: 291
Expert1 balance top: 81.689453125
Expert2 balance top: 90.576171875

New cuda time: 1.802088975906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 11.45317268371582
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 921.358154296875, gpu time: 186.73717772960663
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 0.537109375
Expert1 unused count: 251
Expert2 unused count: 281
Expert1 balance top: 83.056640625
Expert2 balance top: 89.453125

New cuda time: 1.8060890436172485
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819208025932312
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 451.839599609375, gpu time: 112.64627718925476
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.341796875
Expert1 unused count: 246
Expert2 unused count: 256
Expert1 balance top: 82.861328125
Expert2 balance top: 82.2265625

New cuda time: 1.8169690370559692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929680347442627
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1099.11376953125, gpu time: 182.33810830116272
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 7.2265625
Expert1 unused count: 127
Expert2 unused count: 266
Expert1 balance top: 67.96875
Expert2 balance top: 90.33203125

New cuda time: 9.1072416305542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7801690101623535
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1623.920654296875, gpu time: 203.545893907547
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.3671875
Expert1 unused count: 131
Expert2 unused count: 286
Expert1 balance top: 71.435546875
Expert2 balance top: 90.869140625

New cuda time: 1.9460879564285278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7814480066299438
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1007.3076171875, gpu time: 175.96081054210663
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.146484375
Expert1 unused count: 146
Expert2 unused count: 271
Expert1 balance top: 70.1171875
Expert2 balance top: 89.697265625

New cuda time: 1.7980879545211792
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7686480283737183
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 763.91943359375, gpu time: 108.2425764799118
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.3203125
Expert2 overflow: 1.513671875
Expert1 unused count: 155
Expert2 unused count: 228
Expert1 balance top: 72.705078125
Expert2 balance top: 84.47265625

New cuda time: 1.8134479522705078
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848089933395386
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 931.071044921875, gpu time: 190.33543467521667
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 173
Expert2 unused count: 214
Expert1 balance top: 73.33984375
Expert2 balance top: 82.8125

New cuda time: 1.9848090410232544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9433690309524536
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 476.127685546875, gpu time: 116.57445526123047
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 5.46875
Expert1 unused count: 189
Expert2 unused count: 212
Expert1 balance top: 77.1484375
Expert2 balance top: 80.712890625

New cuda time: 1.8120089769363403
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924879789352417
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1108.046875, gpu time: 185.9426052570343
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 10.107421875
Expert1 unused count: 151
Expert2 unused count: 275
Expert1 balance top: 71.728515625
Expert2 balance top: 90.283203125

New cuda time: 1.8020880222320557
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7740880250930786
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1633.648193359375, gpu time: 207.12207090854645
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.369140625
Expert1 unused count: 157
Expert2 unused count: 297
Expert1 balance top: 75.048828125
Expert2 balance top: 91.50390625

New cuda time: 1.7995280027389526
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7865689992904663
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1016.825439453125, gpu time: 179.54690754413605
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.708984375
Expert1 unused count: 180
Expert2 unused count: 295
Expert1 balance top: 73.974609375
Expert2 balance top: 90.869140625

New cuda time: 1.9641690254211426
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782088041305542
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 782.798095703125, gpu time: 111.98883354663849
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.490234375
Expert2 overflow: 2.5390625
Expert1 unused count: 177
Expert2 unused count: 255
Expert1 balance top: 74.31640625
Expert2 balance top: 87.548828125

New cuda time: 1.8188879489898682
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7896080017089844
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 940.044921875, gpu time: 193.94393062591553
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.5859375
Expert1 unused count: 199
Expert2 unused count: 244
Expert1 balance top: 75.9765625
Expert2 balance top: 85.7421875

New cuda time: 1.8139280080795288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786728024482727
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 485.0791015625, gpu time: 120.17511224746704
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 0.9765625
Expert1 unused count: 209
Expert2 unused count: 237
Expert1 balance top: 78.90625
Expert2 balance top: 79.98046875

New cuda time: 1.8150490522384644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7377680540084839
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1126.449951171875, gpu time: 189.49542236328125
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.58984375
Expert1 unused count: 214
Expert2 unused count: 325
Expert1 balance top: 79.98046875
Expert2 balance top: 94.43359375

New cuda time: 1.7971279621124268
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7744090557098389
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1643.251953125, gpu time: 210.6936079263687
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 5.76171875
Expert1 unused count: 246
Expert2 unused count: 307
Expert1 balance top: 85.400390625
Expert2 balance top: 92.7734375

New cuda time: 1.8088090419769287
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9764889478683472
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1034.74609375, gpu time: 183.33220553398132
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 2.05078125
Expert1 unused count: 247
Expert2 unused count: 306
Expert1 balance top: 83.251953125
Expert2 balance top: 91.064453125

New cuda time: 1.8000080585479736
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9520089626312256
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 798.171630859375, gpu time: 115.74085056781769
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.296875
Expert2 overflow: 2.197265625
Expert1 unused count: 271
Expert2 unused count: 307
Expert1 balance top: 86.03515625
Expert2 balance top: 91.11328125

New cuda time: 1.8035279512405396
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9780900478363037
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 953.396728515625, gpu time: 197.72554862499237
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 286
Expert2 unused count: 315
Expert1 balance top: 86.181640625
Expert2 balance top: 91.69921875

New cuda time: 1.8102480173110962
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868880033493042
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 494.851806640625, gpu time: 123.77224826812744
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.61328125
Expert2 overflow: 3.076171875
Expert1 unused count: 298
Expert2 unused count: 293
Expert1 balance top: 88.818359375
Expert2 balance top: 86.767578125

New cuda time: 1.7723289728164673
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.781288981437683
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1135.685791015625, gpu time: 193.0490403175354
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.11328125
Expert1 unused count: 195
Expert2 unused count: 290
Expert1 balance top: 77.685546875
Expert2 balance top: 91.69921875

New cuda time: 1.946889042854309
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.144037246704102
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1687.4609375, gpu time: 220.78453421592712
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.5625
Expert2 overflow: 8.935546875
Expert1 unused count: 223
Expert2 unused count: 311
Expert1 balance top: 80.859375
Expert2 balance top: 93.310546875

New cuda time: 1.828328013420105
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7851279973983765
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1044.500732421875, gpu time: 186.9456615447998
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.8828125
Expert1 unused count: 230
Expert2 unused count: 299
Expert1 balance top: 82.470703125
Expert2 balance top: 92.626953125

New cuda time: 1.8089690208435059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788648009300232
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 807.178466796875, gpu time: 119.33846759796143
2024-07-11 01:41:48 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.5625
Expert1 unused count: 251
Expert2 unused count: 294
Expert1 balance top: 82.32421875
Expert2 balance top: 91.30859375

New cuda time: 1.81312894821167
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9510489702224731
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 979.672607421875, gpu time: 201.4897255897522
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 1.953125
Expert1 unused count: 242
Expert2 unused count: 276
Expert1 balance top: 83.69140625
Expert2 balance top: 86.865234375

New cuda time: 1.814247965812683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9744089841842651
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 508.67578125, gpu time: 127.56090521812439
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.78125
Expert2 overflow: 2.34375
Expert1 unused count: 269
Expert2 unused count: 277
Expert1 balance top: 85.498046875
Expert2 balance top: 83.49609375

New cuda time: 1.7995280027389526
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7916879653930664
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1144.67919921875, gpu time: 196.64025628566742
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.62109375
Expert1 unused count: 107
Expert2 unused count: 244
Expert1 balance top: 67.529296875
Expert2 balance top: 87.98828125

New cuda time: 1.7947289943695068
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9622490406036377
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1704.975341796875, gpu time: 224.54151225090027
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.2265625
Expert1 unused count: 137
Expert2 unused count: 268
Expert1 balance top: 68.9453125
Expert2 balance top: 90.380859375

New cuda time: 1.8028889894485474
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8222479820251465
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1053.284423828125, gpu time: 190.5707985162735
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.029296875
Expert1 unused count: 128
Expert2 unused count: 284
Expert1 balance top: 69.04296875
Expert2 balance top: 90.576171875

New cuda time: 1.807049036026001
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9571290016174316
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 894.9755859375, gpu time: 123.10264456272125
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.1484375
Expert2 overflow: 1.46484375
Expert1 unused count: 145
Expert2 unused count: 254
Expert1 balance top: 70.5078125
Expert2 balance top: 88.76953125

New cuda time: 1.8035279512405396
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828890085220337
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 988.52587890625, gpu time: 205.07614254951477
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 147
Expert2 unused count: 228
Expert1 balance top: 71.728515625
Expert2 balance top: 83.69140625

New cuda time: 1.7995280027389526
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9588890075683594
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 520.522705078125, gpu time: 131.31932318210602
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 2.978515625
Expert1 unused count: 165
Expert2 unused count: 202
Expert1 balance top: 73.681640625
Expert2 balance top: 76.123046875

New cuda time: 1.814728021621704
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9566489458084106
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1165.319580078125, gpu time: 200.41163325309753
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 6.73828125
Expert1 unused count: 157
Expert2 unused count: 274
Expert1 balance top: 72.998046875
Expert2 balance top: 90.8203125

New cuda time: 1.8056080341339111
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7664079666137695
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1716.149169921875, gpu time: 228.11352825164795
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 2.63671875
Expert1 unused count: 172
Expert2 unused count: 300
Expert1 balance top: 75.9765625
Expert2 balance top: 92.431640625

New cuda time: 1.8108880519866943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7803280353546143
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1063.837158203125, gpu time: 194.1620146036148
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.048828125
Expert1 unused count: 149
Expert2 unused count: 280
Expert1 balance top: 72.998046875
Expert2 balance top: 90.283203125

New cuda time: 8.803561210632324
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0593700408935547
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 925.605712890625, gpu time: 133.96557581424713
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 1.220703125
Expert1 unused count: 171
Expert2 unused count: 258
Expert1 balance top: 73.779296875
Expert2 balance top: 87.890625

New cuda time: 1.8105690479278564
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7739280462265015
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 998.684814453125, gpu time: 208.66063857078552
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 196
Expert2 unused count: 236
Expert1 balance top: 75.634765625
Expert2 balance top: 84.08203125

New cuda time: 1.797287940979004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7646479606628418
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 530.471435546875, gpu time: 134.88125908374786
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.48828125
Expert1 unused count: 203
Expert2 unused count: 225
Expert1 balance top: 75.244140625
Expert2 balance top: 78.61328125

New cuda time: 1.7996879816055298
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.012677192687988
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1181.3291015625, gpu time: 210.22399842739105
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.515625
Expert1 unused count: 125
Expert2 unused count: 286
Expert1 balance top: 71.09375
Expert2 balance top: 92.1875

New cuda time: 1.9395289421081543
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9644889831542969
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1860.3076171875, gpu time: 232.0175461769104
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 3.271484375
Expert1 unused count: 141
Expert2 unused count: 306
Expert1 balance top: 74.462890625
Expert2 balance top: 93.65234375

New cuda time: 1.8051279783248901
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920089960098267
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1072.93359375, gpu time: 197.75915157794952
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.953125
Expert1 unused count: 139
Expert2 unused count: 305
Expert1 balance top: 73.046875
Expert2 balance top: 93.115234375

New cuda time: 1.7952079772949219
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786728024482727
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 935.01025390625, gpu time: 137.5475128889084
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 0.439453125
Expert1 unused count: 144
Expert2 unused count: 258
Expert1 balance top: 74.4140625
Expert2 balance top: 88.57421875

New cuda time: 1.816167950630188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.774407982826233
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1008.72216796875, gpu time: 212.25121450424194
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.390625
Expert1 unused count: 146
Expert2 unused count: 238
Expert1 balance top: 73.779296875
Expert2 balance top: 85.888671875

New cuda time: 1.734887957572937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788807988166809
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 555.3583984375, gpu time: 138.4049550294876
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 2.63671875
Expert1 unused count: 167
Expert2 unused count: 217
Expert1 balance top: 76.7578125
Expert2 balance top: 81.982421875

New cuda time: 1.8105690479278564
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832080125808716
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1190.45947265625, gpu time: 213.81777548789978
2024-07-11 01:41:49 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 9.423828125
Expert1 unused count: 179
Expert2 unused count: 299
Expert1 balance top: 78.662109375
Expert2 balance top: 93.26171875

New cuda time: 1.8104079961776733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796880006790161
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1870.03369140625, gpu time: 235.6076421737671
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 1.3671875
Expert1 unused count: 177
Expert2 unused count: 307
Expert1 balance top: 79.052734375
Expert2 balance top: 93.06640625

New cuda time: 1.7929680347442627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7278480529785156
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1099.53955078125, gpu time: 201.27996861934662
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.345703125
Expert2 overflow: 0.390625
Expert1 unused count: 179
Expert2 unused count: 303
Expert1 balance top: 79.19921875
Expert2 balance top: 93.45703125

New cuda time: 1.7966480255126953
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976080179214478
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 945.115234375, gpu time: 141.14176893234253
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 0.732421875
Expert1 unused count: 180
Expert2 unused count: 296
Expert1 balance top: 79.248046875
Expert2 balance top: 90.0390625

New cuda time: 1.8038480281829834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.776968002319336
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1018.43408203125, gpu time: 215.83203053474426
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 187
Expert2 unused count: 260
Expert1 balance top: 77.83203125
Expert2 balance top: 89.306640625

New cuda time: 1.8083280324935913
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.94576895236969
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 572.13330078125, gpu time: 142.1590520143509
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.416015625
Expert1 unused count: 210
Expert2 unused count: 252
Expert1 balance top: 80.322265625
Expert2 balance top: 85.9375

New cuda time: 1.80240797996521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9820890426635742
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1202.16796875, gpu time: 217.60227251052856
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.95703125
Expert1 unused count: 166
Expert2 unused count: 282
Expert1 balance top: 73.876953125
Expert2 balance top: 91.2109375

New cuda time: 1.8065680265426636
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9572889804840088
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1958.28173828125, gpu time: 239.37149918079376
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.66015625
Expert1 unused count: 174
Expert2 unused count: 296
Expert1 balance top: 76.416015625
Expert2 balance top: 91.69921875

New cuda time: 1.800487995147705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9505690336227417
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1109.11962890625, gpu time: 205.03102564811707
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.830078125
Expert1 unused count: 184
Expert2 unused count: 297
Expert1 balance top: 76.171875
Expert2 balance top: 91.748046875

New cuda time: 1.8078479766845703
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7854479551315308
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 954.048095703125, gpu time: 144.73506593704224
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 1.171875
Expert1 unused count: 190
Expert2 unused count: 256
Expert1 balance top: 76.806640625
Expert2 balance top: 86.71875

New cuda time: 1.8036890029907227
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9584089517593384
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1100.11083984375, gpu time: 219.59412848949432
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.26953125
Expert1 unused count: 196
Expert2 unused count: 238
Expert1 balance top: 78.369140625
Expert2 balance top: 83.740234375

New cuda time: 1.8088090419769287
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786247968673706
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 582.18798828125, gpu time: 145.75410902500153
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.076171875
Expert2 overflow: 2.685546875
Expert1 unused count: 220
Expert2 unused count: 244
Expert1 balance top: 81.201171875
Expert2 balance top: 83.7890625

New cuda time: 1.8089690208435059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9393689632415771
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1216.8291015625, gpu time: 221.35060942173004
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.466796875
Expert2 overflow: 8.59375
Expert1 unused count: 214
Expert2 unused count: 306
Expert1 balance top: 79.736328125
Expert2 balance top: 93.45703125

New cuda time: 1.8020880222320557
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950479984283447
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1967.67431640625, gpu time: 242.96863520145416
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 2.978515625
Expert1 unused count: 224
Expert2 unused count: 299
Expert1 balance top: 82.666015625
Expert2 balance top: 91.845703125

torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910460233688354
New cuda time: 1.7684860229492188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.966088056564331
New cuda time: 1.9392069578170776
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8107270002365112
New cuda time: 1.7843270301818848
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7675269842147827
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8484870195388794
New cuda time: 1.9476879835128784
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8096059560775757
New cuda time: 1.9692879915237427
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904069423675537
New cuda time: 1.7811269760131836
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7998470067977905
New cuda time: 1.7886459827423096
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913670539855957
New cuda time: 1.7948859930038452
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7766460180282593
New cuda time: 8.784833908081055
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7974469661712646
New cuda time: 1.784006953239441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7928069829940796
New cuda time: 1.7878470420837402
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880059480667114
New cuda time: 1.7905670404434204
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7969670295715332
New cuda time: 1.784487009048462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9803270101547241
New cuda time: 1.773287057876587
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 11.454763412475586
New cuda time: 1.7611260414123535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7793669700622559
New cuda time: 1.7912060022354126
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843270301818848
New cuda time: 9.03011417388916
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7852870225906372
New cuda time: 1.9387270212173462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876869440078735
New cuda time: 1.7958459854125977
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964869737625122
New cuda time: 1.7731269598007202
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7926470041275024
New cuda time: 1.964007019996643
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9662480354309082
New cuda time: 1.7899270057678223
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8280060291290283
New cuda time: 1.785606026649475
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7878459692001343
New cuda time: 1.7793660163879395
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782567024230957
New cuda time: 1.9475270509719849
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784487009048462
New cuda time: 1.782565951347351
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875269651412964
New cuda time: 1.7905670404434204
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.882086992263794
New cuda time: 1.7784069776535034
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 4.137455940246582
New cuda time: 1.7817660570144653
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787047028541565
New cuda time: 1.7737669944763184
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9627269506454468
New cuda time: 1.7644870281219482
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9696069955825806
New cuda time: 1.7798470258712769
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9691280126571655
New cuda time: 1.7777669429779053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786566972732544
New cuda time: 1.8225669860839844
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950459718704224
New cuda time: 1.9384069442749023
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.176989555358887
New cuda time: 1.8022470474243164
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8044869899749756
New cuda time: 1.772807002067566
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8048069477081299
New cuda time: 1.786726951599121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.952327013015747
New cuda time: 1.782405972480774
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.968487024307251
New cuda time: 1.7923259735107422
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880070209503174
New cuda time: 1.7801669836044312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951686978340149
New cuda time: 1.7811269760131836
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915270328521729
New cuda time: 1.7596869468688965
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9572869539260864
New cuda time: 1.796165943145752
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8040070533752441
New cuda time: 1.772807002067566
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.963528037071228
New cuda time: 1.7808059453964233
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9584070444107056
New cuda time: 1.763685941696167
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787207007408142
New cuda time: 1.7788870334625244
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891260385513306
New cuda time: 1.8838469982147217
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 16.44902229309082
New cuda time: 1.7760059833526611
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7908869981765747
New cuda time: 1.8027269840240479
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7908869981765747
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.008350372314453
New cuda time: 1.9657670259475708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9555269479751587
New cuda time: 1.7811260223388672
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924870252609253
New cuda time: 1.7816070318222046
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7804869413375854
New cuda time: 1.7713669538497925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920069694519043
New cuda time: 4.370415210723877
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897670269012451
New cuda time: 1.7686469554901123
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7723259925842285
New cuda time: 1.7772870063781738
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795686960220337
New cuda time: 1.789126992225647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.160827159881592
New cuda time: 1.7776069641113281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7792069911956787
New cuda time: 1.7756869792938232
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897670269012451
New cuda time: 1.7563259601593018
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.970566987991333
New cuda time: 1.7843270301818848
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9723269939422607
New cuda time: 1.772966980934143
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9584070444107056
New cuda time: 1.76112699508667
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9539270401000977
New cuda time: 1.7952059507369995
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8040070533752441
New cuda time: 1.7788859605789185
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.96144700050354
New cuda time: 1.779526948928833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918469905853271
New cuda time: 1.7824070453643799
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.958888053894043
New cuda time: 1.7907270193099976
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779845952987671
New cuda time: torch.float16
New cuda time: 1.8041529655456543
New cuda time: 1.7841529846191406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9964720010757446
New cuda time: 1.947991967201233
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7715129852294922
New cuda time: 1.7555129528045654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7985529899597168
New cuda time: 1.7644729614257812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868729829788208
New cuda time: 1.8217530250549316
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894330024719238
New cuda time: 1.9332720041275024
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857530117034912
New cuda time: 1.7729530334472656
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7723129987716675
New cuda time: 1.7593530416488647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884730100631714
New cuda time: 1.7467139959335327
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7814329862594604
New cuda time: 8.797725677490234
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7767930030822754
New cuda time: 1.7649530172348022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7743929624557495
New cuda time: 1.8065530061721802
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.7547130584716797
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7791930437088013
New cuda time: 1.7806340456008911
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859129905700684
New cuda time: 1.7705539464950562
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.917112946510315
New cuda time: 1.764633059501648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796729803085327
New cuda time: 1.769273042678833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7863930463790894
New cuda time: 9.01756477355957
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8177529573440552
New cuda time: 1.9609509706497192
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8159929513931274
New cuda time: 1.7865530252456665
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8166329860687256
New cuda time: 1.785433053970337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.815513014793396
New cuda time: 1.9588730335235596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.96287202835083
New cuda time: 1.7675130367279053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7860729694366455
New cuda time: 1.7702330350875854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822713017463684
New cuda time: 1.762073040008545
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8284729719161987
New cuda time: 1.8164730072021484
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.7750329971313477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8235119581222534
New cuda time: 1.7625529766082764
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833529710769653
New cuda time: 1.770712971687317
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.954712986946106
New cuda time: 1.7699129581451416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8247929811477661
New cuda time: 1.7676730155944824
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.96015202999115
New cuda time: 1.77327299118042
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9959919452667236
New cuda time: 1.7815929651260376
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9614330530166626
New cuda time: 1.7748730182647705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8326330184936523
New cuda time: 1.7836730480194092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939130067825317
New cuda time: 1.948632001876831
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.193087577819824
New cuda time: 1.7659130096435547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.829272985458374
New cuda time: 1.7654329538345337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8097529411315918
New cuda time: 1.7705529928207397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9844720363616943
New cuda time: 1.7649530172348022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.950073003768921
New cuda time: 1.7523130178451538
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8278330564498901
New cuda time: 1.7731130123138428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9908720254898071
New cuda time: 1.7718340158462524
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7886329889297485
New cuda time: 1.7756730318069458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969912052154541
New cuda time: 1.7839930057525635
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7971129417419434
New cuda time: 1.7654329538345337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9483120441436768
New cuda time: 1.750553011894226
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.978073000907898
New cuda time: 1.796152949333191
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8183929920196533
New cuda time: 1.7759929895401
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.8665529489517212
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9132720232009888
New cuda time: 1.7665519714355469
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8158329725265503
New cuda time: 1.787672996520996
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8223929405212402
New cuda time: 1.7681529521942139
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.06380844116211
New cuda time: 1.9535930156707764
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9707119464874268
New cuda time: 1.761592984199524
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868729829788208
New cuda time: 1.7719930410385132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8183929920196533
New cuda time: 1.7735929489135742
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8260730504989624
New cuda time: 1.9427130222320557
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8276729583740234
New cuda time: 1.7703930139541626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8075129985809326
New cuda time: 1.7655930519104004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8095929622650146
New cuda time: 1.7588740587234497
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.329891204833984
New cuda time: 1.7732720375061035
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8228729963302612
New cuda time: 1.780472993850708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8230329751968384
New cuda time: 1.7787129878997803
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9766329526901245
New cuda time: 1.7620739936828613
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.95231294631958
New cuda time: 1.7897529602050781
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9795130491256714
New cuda time: 1.7678329944610596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9446330070495605
New cuda time: 1.7699129581451416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939130067825317
New cuda time: 1.784952998161316
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9470319747924805
New cuda time: 1.7665539979934692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8158329725265503
New cuda time: 1.7593530416488647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9721519947052002
New cuda time: 1.7766330242156982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819991946220398
New cuda time: 1.7547130584716797
New cuda time: 1.7929600477218628
New cuda time: 1.774880051612854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.967519998550415
New cuda time: 1.9468810558319092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833600044250488
New cuda time: 1.7806400060653687
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8171199560165405
New cuda time: 1.7804800271987915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8321599960327148
New cuda time: 1.955680012702942
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7724800109863281
New cuda time: 1.9684799909591675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7812800407409668
New cuda time: 1.7736010551452637
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841600179672241
New cuda time: 1.7819210290908813
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8007999658584595
New cuda time: 1.790560007095337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8040000200271606
New cuda time: 8.803041458129883
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902400493621826
New cuda time: 1.7745599746704102
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7961599826812744
New cuda time: 1.7604800462722778
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7879999876022339
New cuda time: 1.7827199697494507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889599800109863
New cuda time: 1.7752000093460083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9788810014724731
New cuda time: 1.7916799783706665
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 11.442560195922852
New cuda time: 1.7798399925231934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.781440019607544
New cuda time: 1.7691199779510498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8270399570465088
New cuda time: 9.072800636291504
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862399816513062
New cuda time: 1.9520000219345093
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785599946975708
New cuda time: 1.7499200105667114
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7958400249481201
New cuda time: 1.7696000337600708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833609580993652
New cuda time: 1.9088000059127808
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953279972076416
New cuda time: 1.77839994430542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.816159963607788
New cuda time: 1.769279956817627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884800434112549
New cuda time: 1.7828810214996338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7871999740600586
New cuda time: 1.9361599683761597
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7971199750900269
New cuda time: 1.7812809944152832
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8015999794006348
New cuda time: 1.7961599826812744
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8867199420928955
New cuda time: 1.7884800434112549
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 4.150559902191162
New cuda time: 1.7680000066757202
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940800189971924
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9803199768066406
New cuda time: 1.778880000114441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.966879963874817
New cuda time: 1.7753599882125854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951200008392334
New cuda time: 1.7801599502563477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950400114059448
New cuda time: 1.825119972229004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7798409461975098
New cuda time: 1.9497599601745605
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.186720848083496
New cuda time: 1.7884800434112549
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796800136566162
New cuda time: 1.7740800380706787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8001600503921509
New cuda time: 1.7739200592041016
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9593600034713745
New cuda time: 1.7980799674987793
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9590400457382202
New cuda time: 1.786080002784729
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794880986213684
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9615999460220337
New cuda time: 1.776481032371521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9870400428771973
New cuda time: 1.7702410221099854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7791999578475952
New cuda time: 1.76528000831604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9600000381469727
New cuda time: 1.7971199750900269
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9622399806976318
New cuda time: 1.7828799486160278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.7691199779510498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848000526428223
New cuda time: 1.886080026626587
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 16.436641693115234
New cuda time: 1.7758400440216064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7836799621582031
New cuda time: 1.755679965019226
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8030400276184082
New cuda time: 1.7896000146865845
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.01968002319336
New cuda time: 1.9419200420379639
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9900799989700317
New cuda time: 1.7884809970855713
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8113600015640259
New cuda time: 1.7779200077056885
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902400493621826
New cuda time: 1.7849609851837158
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8035199642181396
New cuda time: 4.378400802612305
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.809440016746521
New cuda time: 1.7799999713897705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790560007095337
New cuda time: 1.7870399951934814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7854399681091309
New cuda time: 1.785120964050293
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 7.294240951538086
New cuda time: 1.7630399465560913
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931209802627563
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7963199615478516
New cuda time: 1.7817599773406982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9764800071716309
New cuda time: 1.7752009630203247
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9625600576400757
New cuda time: 1.7729599475860596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.983199954032898
New cuda time: 1.7873599529266357
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9646400213241577
New cuda time: 1.774399995803833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828799486160278
New cuda time: 1.792160987854004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9648000001907349
New cuda time: 1.7771209478378296
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7979209423065186
New cuda time: 1.7791999578475952
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9587199687957764
New cuda time: 1.7807999849319458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7947200536727905
New cuda time: 1.7867200374603271
New cuda time: 1.823369026184082
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8217689990997314
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1118.556884765625, gpu time: 208.67616260051727
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 3.3203125
Expert1 unused count: 234
Expert2 unused count: 312
Expert1 balance top: 82.177734375
Expert2 balance top: 92.87109375

New cuda time: 1.8177690505981445
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.791368007659912
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 963.58203125, gpu time: 148.3442029953003
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.736328125
Expert2 overflow: 2.783203125
Expert1 unused count: 248
Expert2 unused count: 301
Expert1 balance top: 82.12890625
Expert2 balance top: 91.455078125

New cuda time: 1.9704090356826782
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7689679861068726
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1115.5107421875, gpu time: 223.33350551128387
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.611328125
Expert1 unused count: 263
Expert2 unused count: 294
Expert1 balance top: 84.521484375
Expert2 balance top: 91.6015625

New cuda time: 1.8124890327453613
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7702480554580688
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 591.916748046875, gpu time: 149.33684611320496
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.3671875
Expert2 overflow: 2.05078125
Expert1 unused count: 267
Expert2 unused count: 280
Expert1 balance top: 84.423828125
Expert2 balance top: 85.3515625

New cuda time: 1.7660889625549316
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.962730050086975
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1230.54150390625, gpu time: 225.07942748069763
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 12.20703125
Expert2 overflow: 22.75390625
Expert1 unused count: 331
Expert2 unused count: 343
Expert1 balance top: 94.140625
Expert2 balance top: 95.99609375

New cuda time: 1.8016079664230347
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9320080280303955
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1983.544921875, gpu time: 246.7022511959076
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.638671875
Expert2 overflow: 3.41796875
Expert1 unused count: 337
Expert2 unused count: 352
Expert1 balance top: 93.75
Expert2 balance top: 96.435546875

New cuda time: 1.8139280080795288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940889596939087
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1129.115234375, gpu time: 212.2841795682907
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 2.099609375
Expert1 unused count: 335
Expert2 unused count: 351
Expert1 balance top: 92.822265625
Expert2 balance top: 95.41015625

New cuda time: 1.8097679615020752
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7692879438400269
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 973.636474609375, gpu time: 151.9232589006424
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 5.859375
Expert1 unused count: 336
Expert2 unused count: 344
Expert1 balance top: 93.9453125
Expert2 balance top: 95.60546875

New cuda time: 1.8012889623641968
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0739290714263916
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1128.17041015625, gpu time: 227.20872354507446
2024-07-11 01:41:50 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.759765625
Expert1 unused count: 340
Expert2 unused count: 342
Expert1 balance top: 94.140625
Expert2 balance top: 95.654296875

New cuda time: 1.77456796169281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7886489629745483
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 605.970458984375, gpu time: 152.90006303787231
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 2.978515625
Expert1 unused count: 328
Expert2 unused count: 333
Expert1 balance top: 91.2109375
Expert2 balance top: 92.67578125

New cuda time: 1.799847960472107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.776968002319336
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1239.75830078125, gpu time: 228.65624344348907
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.318359375
Expert2 overflow: 17.724609375
Expert1 unused count: 307
Expert2 unused count: 359
Expert1 balance top: 93.5546875
Expert2 balance top: 97.55859375

New cuda time: 1.7963279485702515
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806479930877686
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1993.2998046875, gpu time: 250.2792271375656
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.275390625
Expert2 overflow: 12.890625
Expert1 unused count: 329
Expert2 unused count: 371
Expert1 balance top: 95.068359375
Expert2 balance top: 98.14453125

New cuda time: 1.8041690587997437
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.983849048614502
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1143.224853515625, gpu time: 216.07219660282135
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 1.220703125
Expert1 unused count: 323
Expert2 unused count: 346
Expert1 balance top: 94.53125
Expert2 balance top: 96.533203125

New cuda time: 1.8136080503463745
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824079990386963
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 984.8505859375, gpu time: 155.51927495002747
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.640625
Expert2 overflow: 2.734375
Expert1 unused count: 330
Expert2 unused count: 345
Expert1 balance top: 94.82421875
Expert2 balance top: 95.947265625

New cuda time: 1.8089690208435059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790727972984314
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1138.123291015625, gpu time: 230.80841946601868
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.27734375
Expert2 overflow: 5.46875
Expert1 unused count: 347
Expert2 unused count: 346
Expert1 balance top: 96.19140625
Expert2 balance top: 96.09375

New cuda time: 1.8059279918670654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7934490442276
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 615.139404296875, gpu time: 156.49944007396698
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.564453125
Expert2 overflow: 13.330078125
Expert1 unused count: 350
Expert2 unused count: 341
Expert1 balance top: 95.849609375
Expert2 balance top: 94.482421875

New cuda time: 1.9198490381240845
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9512089490890503
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1252.372802734375, gpu time: 232.5273014307022
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.251953125
Expert1 unused count: 179
Expert2 unused count: 289
Expert1 balance top: 76.513671875
Expert2 balance top: 91.89453125

New cuda time: 1.8035290241241455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827279567718506
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2002.25634765625, gpu time: 253.8654841184616
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 5.76171875
Expert1 unused count: 195
Expert2 unused count: 296
Expert1 balance top: 79.931640625
Expert2 balance top: 93.115234375

New cuda time: 1.7958489656448364
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9515290260314941
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1158.470458984375, gpu time: 219.81957364082336
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 1.07421875
Expert1 unused count: 201
Expert2 unused count: 306
Expert1 balance top: 81.4453125
Expert2 balance top: 92.919921875

New cuda time: 1.7716879844665527
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951369047164917
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1002.001953125, gpu time: 159.24233198165894
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.927734375
Expert1 unused count: 230
Expert2 unused count: 285
Expert1 balance top: 82.2265625
Expert2 balance top: 91.015625

New cuda time: 1.7795289754867554
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8196890354156494
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1148.309326171875, gpu time: 234.40763652324677
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 224
Expert2 unused count: 265
Expert1 balance top: 81.591796875
Expert2 balance top: 86.9140625

New cuda time: 1.8012880086898804
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929680347442627
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 624.70849609375, gpu time: 160.09369611740112
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.66015625
Expert1 unused count: 238
Expert2 unused count: 253
Expert1 balance top: 81.73828125
Expert2 balance top: 80.810546875

New cuda time: 1.8099290132522583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897679805755615
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1261.542236328125, gpu time: 236.1269974708557
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.0546875
Expert1 unused count: 180
Expert2 unused count: 294
Expert1 balance top: 73.681640625
Expert2 balance top: 91.552734375

New cuda time: 1.8020880222320557
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857680320739746
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2013.7548828125, gpu time: 257.45334017276764
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.052734375
Expert1 unused count: 185
Expert2 unused count: 322
Expert1 balance top: 75.29296875
Expert2 balance top: 94.580078125

New cuda time: 1.7968080043792725
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.811689019203186
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1169.263671875, gpu time: 223.42807066440582
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 180
Expert2 unused count: 294
Expert1 balance top: 73.4375
Expert2 balance top: 91.943359375

New cuda time: 1.798248052597046
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955280542373657
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1011.13037109375, gpu time: 162.83610808849335
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 200
Expert2 unused count: 273
Expert1 balance top: 77.5390625
Expert2 balance top: 89.111328125

New cuda time: 1.8017679452896118
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775048017501831
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1157.507568359375, gpu time: 237.9844524860382
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 201
Expert2 unused count: 251
Expert1 balance top: 77.1484375
Expert2 balance top: 86.9140625

New cuda time: 1.9640090465545654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7696080207824707
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 640.238037109375, gpu time: 163.82731318473816
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 1.708984375
Expert1 unused count: 208
Expert2 unused count: 233
Expert1 balance top: 78.466796875
Expert2 balance top: 79.931640625

New cuda time: 1.802088975906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9617689847946167
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1270.337890625, gpu time: 239.89085447788239
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.83203125
Expert1 unused count: 142
Expert2 unused count: 257
Expert1 balance top: 74.90234375
Expert2 balance top: 88.96484375

New cuda time: 1.814087986946106
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.769927978515625
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2022.753173828125, gpu time: 261.03735613822937
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 3.41796875
Expert1 unused count: 158
Expert2 unused count: 296
Expert1 balance top: 74.169921875
Expert2 balance top: 93.359375

New cuda time: 1.8153690099716187
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9446489810943604
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1183.467041015625, gpu time: 227.1880886554718
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 161
Expert2 unused count: 302
Expert1 balance top: 74.90234375
Expert2 balance top: 93.65234375

New cuda time: 1.7710479497909546
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7900880575180054
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1021.2490234375, gpu time: 166.3972440958023
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.68359375
Expert1 unused count: 166
Expert2 unused count: 270
Expert1 balance top: 76.07421875
Expert2 balance top: 90.185546875

New cuda time: 1.80240797996521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.816809058189392
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1169.230224609375, gpu time: 241.60367059707642
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 177
Expert2 unused count: 246
Expert1 balance top: 74.853515625
Expert2 balance top: 85.64453125

New cuda time: 1.8056080341339111
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964880466461182
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 649.12646484375, gpu time: 167.4294092655182
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.24609375
Expert1 unused count: 191
Expert2 unused count: 218
Expert1 balance top: 75.732421875
Expert2 balance top: 81.4453125

New cuda time: 1.9820890426635742
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7945679426193237
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1284.500244140625, gpu time: 243.6675124168396
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 10.205078125
Expert1 unused count: 144
Expert2 unused count: 269
Expert1 balance top: 71.337890625
Expert2 balance top: 90.185546875

New cuda time: 1.809448003768921
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859280109405518
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2032.2880859375, gpu time: 264.63273215293884
2024-07-11 01:41:51 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 2.783203125
Expert1 unused count: 163
Expert2 unused count: 294
Expert1 balance top: 74.267578125
Expert2 balance top: 91.845703125

New cuda time: 1.8054490089416504
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.807047963142395
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1192.7294921875, gpu time: 230.80058467388153
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.7578125
Expert1 unused count: 158
Expert2 unused count: 274
Expert1 balance top: 72.0703125
Expert2 balance top: 90.771484375

New cuda time: 1.8032089471817017
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9617689847946167
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1035.18310546875, gpu time: 170.16222202777863
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 1.025390625
Expert1 unused count: 166
Expert2 unused count: 251
Expert1 balance top: 74.8046875
Expert2 balance top: 87.548828125

New cuda time: 1.810088038444519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889679670333862
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1178.758544921875, gpu time: 245.20272660255432
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 172
Expert2 unused count: 240
Expert1 balance top: 74.12109375
Expert2 balance top: 85.888671875

New cuda time: 1.7964880466461182
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7896080017089844
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 658.220703125, gpu time: 171.0155053138733
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 3.173828125
Expert1 unused count: 181
Expert2 unused count: 236
Expert1 balance top: 75.78125
Expert2 balance top: 80.6640625

New cuda time: 1.8062490224838257
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8139289617538452
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1294.3759765625, gpu time: 247.28768932819366
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 17.138671875
Expert1 unused count: 243
Expert2 unused count: 307
Expert1 balance top: 85.693359375
Expert2 balance top: 92.67578125

New cuda time: 1.9633690118789673
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880090475082397
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2051.743896484375, gpu time: 268.38411021232605
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.392578125
Expert2 overflow: 5.224609375
Expert1 unused count: 266
Expert2 unused count: 343
Expert1 balance top: 86.71875
Expert2 balance top: 96.142578125

New cuda time: 1.8104079961776733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780168056488037
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1202.109619140625, gpu time: 234.39116072654724
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 4.541015625
Expert1 unused count: 267
Expert2 unused count: 321
Expert1 balance top: 86.42578125
Expert2 balance top: 93.994140625

New cuda time: 1.8057680130004883
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913689613342285
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1044.52587890625, gpu time: 173.75935900211334
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 0.732421875
Expert1 unused count: 308
Expert2 unused count: 329
Expert1 balance top: 90.625
Expert2 balance top: 93.603515625

New cuda time: 1.795367956161499
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824079990386963
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1190.559814453125, gpu time: 248.78050255775452
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 5.37109375
Expert1 unused count: 328
Expert2 unused count: 331
Expert1 balance top: 90.771484375
Expert2 balance top: 93.505859375

New cuda time: 1.795367956161499
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7732889652252197
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 667.336669921875, gpu time: 174.58416223526
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 302
Expert2 unused count: 321
Expert1 balance top: 87.939453125
Expert2 balance top: 90.13671875

New cuda time: 1.8244880437850952
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7681679725646973
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1303.43408203125, gpu time: 250.88034534454346
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 15.576171875
Expert1 unused count: 276
Expert2 unused count: 312
Expert1 balance top: 87.841796875
Expert2 balance top: 93.84765625

New cuda time: 1.798408031463623
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936079502105713
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2061.01953125, gpu time: 271.97612619400024
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.419921875
Expert2 overflow: 2.783203125
Expert1 unused count: 293
Expert2 unused count: 330
Expert1 balance top: 89.453125
Expert2 balance top: 95.3125

New cuda time: 1.966568946838379
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8204890489578247
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1217.01220703125, gpu time: 238.17821872234344
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 2.734375
Expert1 unused count: 295
Expert2 unused count: 335
Expert1 balance top: 89.2578125
Expert2 balance top: 95.263671875

New cuda time: 1.8091280460357666
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7872090339660645
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1054.815673828125, gpu time: 177.35569608211517
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.931640625
Expert1 unused count: 302
Expert2 unused count: 318
Expert1 balance top: 89.74609375
Expert2 balance top: 92.7734375

New cuda time: 1.800968050956726
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950489521026611
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1200.9873046875, gpu time: 252.3765195608139
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 2.63671875
Expert1 unused count: 295
Expert2 unused count: 305
Expert1 balance top: 86.181640625
Expert2 balance top: 91.455078125

New cuda time: 1.8022480010986328
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9297690391540527
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 682.70654296875, gpu time: 178.3161792755127
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.05078125
Expert1 unused count: 305
Expert2 unused count: 322
Expert1 balance top: 87.744140625
Expert2 balance top: 88.96484375

New cuda time: 1.810088038444519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8195279836654663
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1312.166259765625, gpu time: 254.50996136665344
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.689453125
Expert2 overflow: 16.50390625
Expert1 unused count: 328
Expert2 unused count: 355
Expert1 balance top: 92.333984375
Expert2 balance top: 96.97265625

New cuda time: 1.809609055519104
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7968089580535889
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2070.86181640625, gpu time: 275.58254420757294
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 12.5
Expert1 unused count: 336
Expert2 unused count: 363
Expert1 balance top: 92.431640625
Expert2 balance top: 97.36328125

New cuda time: 1.80240797996521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875289916992188
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1226.960205078125, gpu time: 241.76815569400787
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.12890625
Expert2 overflow: 6.15234375
Expert1 unused count: 327
Expert2 unused count: 364
Expert1 balance top: 92.822265625
Expert2 balance top: 97.55859375

New cuda time: 1.9684890508651733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7596889734268188
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1070.3076171875, gpu time: 181.08387410640717
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.15625
Expert1 unused count: 321
Expert2 unused count: 349
Expert1 balance top: 92.87109375
Expert2 balance top: 96.484375

New cuda time: 1.8048089742660522
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8193680047988892
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1212.657958984375, gpu time: 256.00069558620453
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.1015625
Expert1 unused count: 332
Expert2 unused count: 355
Expert1 balance top: 93.5546875
Expert2 balance top: 97.16796875

New cuda time: 1.7931289672851562
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7793680429458618
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 692.191650390625, gpu time: 181.8886762857437
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 6.93359375
Expert1 unused count: 344
Expert2 unused count: 350
Expert1 balance top: 94.970703125
Expert2 balance top: 95.751953125

New cuda time: 1.8123279809951782
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9614490270614624
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1332.349609375, gpu time: 258.2837394475937
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.7890625
Expert1 unused count: 165
Expert2 unused count: 277
Expert1 balance top: 73.095703125
Expert2 balance top: 90.52734375

New cuda time: 1.8216079473495483
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7740880250930786
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2080.464111328125, gpu time: 279.17824018001556
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 1.85546875
Expert1 unused count: 157
Expert2 unused count: 307
Expert1 balance top: 75.146484375
Expert2 balance top: 93.212890625

New cuda time: 1.8060879707336426
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8224079608917236
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1236.664794921875, gpu time: 245.39665162563324
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.07421875
Expert1 unused count: 160
Expert2 unused count: 290
Expert1 balance top: 74.0234375
Expert2 balance top: 91.650390625

New cuda time: 1.797927975654602
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7942490577697754
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1079.38427734375, gpu time: 184.67605113983154
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.1953125
Expert1 unused count: 184
Expert2 unused count: 281
Expert1 balance top: 75.78125
Expert2 balance top: 89.794921875

New cuda time: 1.9683289527893066
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796880006790161
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1228.96630859375, gpu time: 259.74871253967285
2024-07-11 01:41:52 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.5859375
Expert1 unused count: 178
Expert2 unused count: 247
Expert1 balance top: 76.3671875
Expert2 balance top: 86.62109375

New cuda time: 1.798248052597046
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7792079448699951
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 701.400390625, gpu time: 185.46613228321075
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.85546875
Expert1 unused count: 196
Expert2 unused count: 223
Expert1 balance top: 78.61328125
Expert2 balance top: 81.54296875

New cuda time: 1.8052879571914673
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8192089796066284
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1341.906005859375, gpu time: 261.9082363843918
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 10.888671875
Expert1 unused count: 199
Expert2 unused count: 301
Expert1 balance top: 78.857421875
Expert2 balance top: 93.017578125

New cuda time: 1.8043279647827148
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9398490190505981
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2094.5791015625, gpu time: 282.9224171638489
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.001953125
Expert2 overflow: 7.470703125
Expert1 unused count: 227
Expert2 unused count: 300
Expert1 balance top: 82.373046875
Expert2 balance top: 92.333984375

New cuda time: 1.7988879680633545
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841689586639404
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1246.0615234375, gpu time: 248.97970855236053
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.587890625
Expert2 overflow: 8.056640625
Expert1 unused count: 240
Expert2 unused count: 299
Expert1 balance top: 83.349609375
Expert2 balance top: 92.3828125

New cuda time: 1.8179279565811157
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7928080558776855
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1088.885009765625, gpu time: 188.28678715229034
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 2.197265625
Expert1 unused count: 244
Expert2 unused count: 276
Expert1 balance top: 84.033203125
Expert2 balance top: 89.6484375

New cuda time: 1.8147289752960205
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9556889533996582
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1238.536865234375, gpu time: 263.5191295146942
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 271
Expert2 unused count: 277
Expert1 balance top: 85.205078125
Expert2 balance top: 86.962890625

New cuda time: 9.015081405639648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7872090339660645
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 718.737548828125, gpu time: 196.26842272281647
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.396484375
Expert2 overflow: 4.345703125
Expert1 unused count: 287
Expert2 unused count: 276
Expert1 balance top: 89.892578125
Expert2 balance top: 83.837890625

New cuda time: 1.802088975906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888089418411255
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1351.029296875, gpu time: 265.4991343021393
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.41796875
Expert2 overflow: 21.240234375
Expert1 unused count: 314
Expert2 unused count: 360
Expert1 balance top: 92.7734375
Expert2 balance top: 97.412109375

New cuda time: 1.8006479740142822
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775048017501831
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2104.04052734375, gpu time: 286.498113155365
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.490234375
Expert2 overflow: 9.1796875
Expert1 unused count: 316
Expert2 unused count: 358
Expert1 balance top: 93.408203125
Expert2 balance top: 97.0703125

New cuda time: 1.8169690370559692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0462489128112793
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1261.038330078125, gpu time: 252.84292542934418
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.025390625
Expert1 unused count: 331
Expert2 unused count: 346
Expert1 balance top: 93.1640625
Expert2 balance top: 95.01953125

1.779526948928833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7758469581604004
New cuda time: 1.773287057876587
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862470149993896
New cuda time: 1.9478470087051392
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7926470041275024
New cuda time: 1.7793669700622559
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902460098266602
New cuda time: 1.7819269895553589
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.937608003616333
New cuda time: 1.7862470149993896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9390469789505005
New cuda time: 1.7905659675598145
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7980870008468628
New cuda time: 1.775367021560669
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796326994895935
New cuda time: 1.7848069667816162
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.739712715148926
New cuda time: 1.773287057876587
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868870496749878
New cuda time: 1.7808070182800293
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7928069829940796
New cuda time: 1.7763270139694214
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7838460206985474
New cuda time: 1.7774460315704346
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9470469951629639
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888059616088867
New cuda time: 1.7868870496749878
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7737669944763184
New cuda time: 1.7768059968948364
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785669565200806
New cuda time: 1.8987270593643188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9414470195770264
New cuda time: 1.7856069803237915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929669618606567
New cuda time: 1.7772860527038574
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9620879888534546
New cuda time: 1.7713669538497925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9566470384597778
New cuda time: 1.8414469957351685
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796645998954773
New cuda time: 1.7793660163879395
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862470149993896
New cuda time: 1.7696069478988647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8040070533752441
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.793766975402832
New cuda time: 1.7752059698104858
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8112070560455322
New cuda time: 1.7838469743728638
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7878470420837402
New cuda time: 1.7803269624710083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8081669807434082
New cuda time: 1.9371269941329956
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798887014389038
New cuda time: 1.7852870225906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9553669691085815
New cuda time: 1.7558469772338867
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8000069856643677
New cuda time: 1.7656069993972778
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.943207025527954
New cuda time: 1.7684860229492188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904069423675537
New cuda time: 1.780007004737854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9542479515075684
New cuda time: 1.784006953239441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8019260168075562
New cuda time: 1.9297670125961304
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7835270166397095
New cuda time: 1.793766975402832
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787047028541565
New cuda time: 1.7843270301818848
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.808487057685852
New cuda time: 1.7915270328521729
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.09824800491333
New cuda time: 1.775367021560669
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7947269678115845
New cuda time: 1.7707270383834839
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798406958580017
New cuda time: 1.7892860174179077
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8088070154190063
New cuda time: 1.9520080089569092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889670133590698
New cuda time: 1.7721669673919678
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8014459609985352
New cuda time: 1.78096604347229
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7881669998168945
New cuda time: 1.7900869846343994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9417680501937866
New cuda time: 1.759045958518982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7945669889450073
New cuda time: 1.7865660190582275
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.793766975402832
New cuda time: 1.7883269786834717
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7923270463943481
New cuda time: 1.9384069442749023
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784646987915039
New cuda time: 1.775367021560669
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876869440078735
New cuda time: 1.7828869819641113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786566972732544
New cuda time: 1.7865660190582275
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9576079845428467
New cuda time: 1.782086968421936
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9419269561767578
New cuda time: 1.774886965751648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7921669483184814
New cuda time: 1.7894459962844849
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787047028541565
New cuda time: 1.9379279613494873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.803846001625061
New cuda time: 1.7792069911956787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9646470546722412
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795686960220337
New cuda time: 1.7889670133590698
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9545669555664062
New cuda time: 1.777927041053772
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795686960220337
New cuda time: 1.7761659622192383
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7971270084381104
New cuda time: 1.7768059968948364
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8025660514831543
New cuda time: 1.9280070066452026
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884860038757324
New cuda time: 1.78512704372406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795686960220337
New cuda time: 1.7796870470046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784487009048462
New cuda time: 1.7806459665298462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.975527048110962
New cuda time: 1.7888070344924927
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.769126057624817
New cuda time: 1.7905659675598145
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.772807002067566
New cuda time: 1.7683260440826416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9584070444107056
New cuda time: 8.998113632202148
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936069965362549
New cuda time: 1.79920494556427
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7774460315704346
New cuda time: 1.784006953239441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782886028289795
New cuda time: 1.7665669918060303
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 5.2936201095581055
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8155200481414795
New cuda time: 1.7713600397109985
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833600044250488
New cuda time: 1.9508800506591797
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940800189971924
New cuda time: 1.787680983543396
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7966409921646118
New cuda time: 1.77183997631073
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9830399751663208
New cuda time: 1.7721610069274902
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9587199687957764
New cuda time: 1.7892800569534302
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7807999849319458
New cuda time: 1.7752000093460083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804481029510498
New cuda time: 1.7753609418869019
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.72192096710205
New cuda time: 1.7848010063171387
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8228800296783447
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876800298690796
New cuda time: 1.7774410247802734
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804321050643921
New cuda time: 1.7851200103759766
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9676799774169922
New cuda time: 1.7745599746704102
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7988799810409546
New cuda time: 1.7822400331497192
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7838399410247803
New cuda time: 1.7665599584579468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8008010387420654
New cuda time: 1.7846399545669556
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.937440037727356
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827199697494507
New cuda time: 1.770400047302246
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9707200527191162
New cuda time: 1.7747210264205933
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9630399942398071
New cuda time: 1.8366400003433228
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779039978981018
New cuda time: 1.7735999822616577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894400358200073
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862399816513062
New cuda time: 1.7870399951934814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828799486160278
New cuda time: 1.7828799486160278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7963199615478516
New cuda time: 1.7875200510025024
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8007999658584595
New cuda time: 1.7739200592041016
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801759958267212
New cuda time: 1.942080020904541
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8015999794006348
New cuda time: 1.7782410383224487
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9547200202941895
New cuda time: 1.7849600315093994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867200374603271
New cuda time: 1.772320032119751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9615999460220337
New cuda time: 1.762719988822937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79312002658844
New cuda time: 1.7854399681091309
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9516799449920654
New cuda time: 1.7862399816513062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990399599075317
New cuda time: 1.9433599710464478
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8151999711990356
New cuda time: 1.7825599908828735
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867200374603271
New cuda time: 1.7807999849319458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7705600261688232
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.1174399852752686
New cuda time: 1.7852799892425537
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7747199535369873
New cuda time: 1.7735999822616577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913600206375122
New cuda time: 1.782080054283142
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.767359972000122
New cuda time: 1.9592000246047974
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7963199615478516
New cuda time: 1.7827199697494507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7905609607696533
New cuda time: 1.7729610204696655
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.773921012878418
New cuda time: 1.7713600397109985
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.946239948272705
New cuda time: 1.7771199941635132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7851200103759766
New cuda time: 1.7841600179672241
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884800434112549
New cuda time: 1.7688000202178955
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795199990272522
New cuda time: 1.9385600090026855
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960009574890137
New cuda time: 1.7771199941635132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824000120162964
New cuda time: 1.7756799459457397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964799404144287
New cuda time: 1.7727999687194824
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9555200338363647
New cuda time: 1.7665599584579468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9332799911499023
New cuda time: 1.7776000499725342
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7923200130462646
New cuda time: 1.7675199508666992
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817599773406982
New cuda time: 1.9422399997711182
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8015999794006348
New cuda time: 1.784000039100647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.944159984588623
New cuda time: 1.7841609716415405
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7830400466918945
New cuda time: 1.7836799621582031
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.955680012702942
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7883199453353882
New cuda time: 1.774880051612854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7836799621582031
New cuda time: 1.7803200483322144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7984000444412231
New cuda time: 1.934880018234253
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.7711999416351318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8032000064849854
New cuda time: 1.7817599773406982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876800298690796
New cuda time: 1.7766400575637817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9763209819793701
New cuda time: 1.7740800380706787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7980799674987793
New cuda time: 1.7585599422454834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868800163269043
New cuda time: 1.7830400466918945
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.946560025215149
New cuda time: 8.990080833435059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 1.7827199697494507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827210426330566
New cuda time: 1.7844810485839844
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910410165786743
New cuda time: 1.7747199535369873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 5.279681205749512
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867130041122437
New cuda time: 1.7641539573669434
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8217530250549316
New cuda time: 1.8079930543899536
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8187129497528076
New cuda time: 1.7814329862594604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8182330131530762
New cuda time: 1.784952998161316
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.963992953300476
New cuda time: 1.7772730588912964
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9604729413986206
New cuda time: 1.762233018875122
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8214329481124878
New cuda time: 1.7599929571151733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8294329643249512
New cuda time: 1.7729530334472656
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.841086387634277
New cuda time: 1.8023929595947266
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913529872894287
New cuda time: 1.7489540576934814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8004729747772217
New cuda time: 1.7655930519104004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8214329481124878
New cuda time: 1.7702339887619019
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8323129415512085
New cuda time: 1.7561529874801636
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8276729583740234
New cuda time: 1.7684730291366577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8151930570602417
New cuda time: 1.7756730318069458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8203129768371582
New cuda time: 8.848925590515137
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8119930028915405
New cuda time: 1.7639930248260498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8191930055618286
New cuda time: 1.7772730588912964
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9521520137786865
New cuda time: 1.785433053970337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9841519594192505
New cuda time: 1.7769529819488525
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857530117034912
New cuda time: 1.7673540115356445
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8147130012512207
New cuda time: 1.7651139497756958
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775514006614685
New cuda time: 1.7614339590072632
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8337520360946655
New cuda time: 1.761592984199524
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7865530252456665
New cuda time: 1.7575939893722534
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8214329481124878
New cuda time: 1.75199294090271
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8273530006408691
New cuda time: 1.8188730478286743
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8223929405212402
New cuda time: 1.7748730182647705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9422329664230347
New cuda time: 1.76671302318573
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8307130336761475
New cuda time: 1.7795130014419556
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9635130167007446
New cuda time: 1.7727930545806885
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8209530115127563
New cuda time: 1.7860740423202515
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7742329835891724
New cuda time: 1.7567930221557617
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787192940711975
New cuda time: 1.8081530332565308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7860729694366455
New cuda time: 1.7665539979934692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.7671929597854614
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787194013595581
New cuda time: 1.768792986869812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9603129625320435
New cuda time: 1.7763140201568604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929530143737793
New cuda time: 1.7731130123138428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7969529628753662
New cuda time: 1.7513530254364014
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7959929704666138
New cuda time: 1.971992015838623
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.7668720483779907
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824152946472168
New cuda time: 1.7651129961013794
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8126330375671387
New cuda time: 1.776473045349121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8099130392074585
New cuda time: 1.775352954864502
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.820631980895996
New cuda time: 1.7543929815292358
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8071930408477783
New cuda time: 1.780953049659729
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7863930463790894
New cuda time: 1.8243130445480347
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.77327299118042
New cuda time: 1.7740739583969116
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8212729692459106
New cuda time: 1.7755130529403687
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8091130256652832
New cuda time: 1.7780729532241821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9670319557189941
New cuda time: 1.7665530443191528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817529439926147
New cuda time: 1.7563140392303467
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.81967294216156
New cuda time: 1.7660729885101318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8148729801177979
New cuda time: 1.8366329669952393
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8263930082321167
New cuda time: 1.7614339590072632
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7710330486297607
New cuda time: 1.7609529495239258
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8140729665756226
New cuda time: 1.778074026107788
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9844729900360107
New cuda time: 1.763192057609558
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8230329751968384
New cuda time: 1.7635129690170288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7959929704666138
New cuda time: 1.7612730264663696
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910330295562744
New cuda time: 1.8107130527496338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8140729665756226
New cuda time: 1.7710330486297607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8119930028915405
New cuda time: 1.7598329782485962
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817540168762207
New cuda time: 1.7649530172348022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9628729820251465
New cuda time: 1.764793038368225
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8113529682159424
New cuda time: 1.7827130556106567
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8145530223846436
New cuda time: 1.7711939811706543
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9356720447540283
New cuda time: 8.948286056518555
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8270330429077148
New cuda time: 1.7759939432144165
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8095929622650146
New cuda time: 1.7766330242156982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8219130039215088
New cuda time: 1.7614330053329468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7305530309677124
New cuda time: 1.8012880086898804
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9432090520858765
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1102.707275390625, gpu time: 192.0312842130661
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 3.90625
Expert1 unused count: 334
Expert2 unused count: 338
Expert1 balance top: 93.9453125
Expert2 balance top: 94.921875

New cuda time: 1.799847960472107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786087989807129
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1248.886962890625, gpu time: 267.10506653785706
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.6171875
Expert1 unused count: 323
Expert2 unused count: 346
Expert1 balance top: 92.529296875
Expert2 balance top: 95.80078125

New cuda time: 1.8068879842758179
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7598479986190796
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 728.71630859375, gpu time: 199.83515870571136
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 3.90625
Expert1 unused count: 334
Expert2 unused count: 333
Expert1 balance top: 93.505859375
Expert2 balance top: 93.06640625

New cuda time: 1.8084889650344849
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899279594421387
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1361.078857421875, gpu time: 269.0975502729416
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.173828125
Expert1 unused count: 198
Expert2 unused count: 296
Expert1 balance top: 80.56640625
Expert2 balance top: 92.578125

New cuda time: 1.800328016281128
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884880304336548
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2113.953369140625, gpu time: 290.0869292020798
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.640625
Expert1 unused count: 213
Expert2 unused count: 318
Expert1 balance top: 81.54296875
Expert2 balance top: 94.580078125

New cuda time: 1.8032079935073853
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.77456796169281
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1271.231689453125, gpu time: 256.4207023382187
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.416015625
Expert1 unused count: 226
Expert2 unused count: 312
Expert1 balance top: 81.298828125
Expert2 balance top: 94.23828125

New cuda time: 1.7993680238723755
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788648009300232
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1112.62841796875, gpu time: 195.6193002462387
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.9296875
Expert1 unused count: 225
Expert2 unused count: 284
Expert1 balance top: 78.466796875
Expert2 balance top: 90.234375

New cuda time: 1.8051279783248901
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8209680318832397
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1259.253173828125, gpu time: 270.7311636209488
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.439453125
Expert1 unused count: 254
Expert2 unused count: 291
Expert1 balance top: 83.544921875
Expert2 balance top: 90.966796875

New cuda time: 1.8064090013504028
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7558480501174927
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 739.074951171875, gpu time: 203.39741575717926
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.634765625
Expert1 unused count: 248
Expert2 unused count: 274
Expert1 balance top: 81.8359375
Expert2 balance top: 85.693359375

New cuda time: 1.7873680591583252
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7961679697036743
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1370.79345703125, gpu time: 272.6810863018036
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.634765625
Expert1 unused count: 77
Expert2 unused count: 217
Expert1 balance top: 53.125
Expert2 balance top: 83.349609375

New cuda time: 1.8008090257644653
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.944842338562012
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2131.407958984375, gpu time: 300.83258056640625
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.10546875
Expert1 unused count: 93
Expert2 unused count: 280
Expert1 balance top: 54.00390625
Expert2 balance top: 91.30859375

New cuda time: 1.812648057937622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9876890182495117
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1281.514892578125, gpu time: 260.22104036808014
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 114
Expert2 unused count: 247
Expert1 balance top: 58.7890625
Expert2 balance top: 88.916015625

New cuda time: 1.816648006439209
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8204879760742188
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1121.171875, gpu time: 199.25643622875214
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 103
Expert2 unused count: 229
Expert1 balance top: 60.009765625
Expert2 balance top: 85.302734375

New cuda time: 1.7961679697036743
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7840080261230469
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1268.079345703125, gpu time: 274.3113396167755
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 126
Expert2 unused count: 186
Expert1 balance top: 61.669921875
Expert2 balance top: 73.876953125

New cuda time: 1.8152090311050415
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9545689821243286
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 754.37744140625, gpu time: 207.16719377040863
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.171875
Expert1 unused count: 156
Expert2 unused count: 174
Expert1 balance top: 67.822265625
Expert2 balance top: 71.044921875

New cuda time: 1.8056080341339111
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.812168002128601
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1381.824951171875, gpu time: 276.2988632917404
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.1953125
Expert1 unused count: 140
Expert2 unused count: 271
Expert1 balance top: 59.5703125
Expert2 balance top: 88.671875

New cuda time: 1.8081680536270142
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920089960098267
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2141.15087890625, gpu time: 304.4327576160431
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.908203125
Expert1 unused count: 148
Expert2 unused count: 289
Expert1 balance top: 61.81640625
Expert2 balance top: 90.673828125

New cuda time: 1.7992080450057983
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875280380249023
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1290.509765625, gpu time: 263.80777645111084
2024-07-11 01:41:53 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.341796875
Expert1 unused count: 159
Expert2 unused count: 261
Expert1 balance top: 62.353515625
Expert2 balance top: 88.57421875

New cuda time: 1.9643290042877197
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7723280191421509
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1136.452392578125, gpu time: 202.993093252182
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 143
Expert2 unused count: 239
Expert1 balance top: 60.693359375
Expert2 balance top: 84.86328125

New cuda time: 1.804008960723877
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8163280487060547
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1279.842529296875, gpu time: 277.9316756725311
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 173
Expert2 unused count: 230
Expert1 balance top: 67.67578125
Expert2 balance top: 84.033203125

New cuda time: 1.7838490009307861
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7852879762649536
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 763.42578125, gpu time: 210.73633074760437
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.615234375
Expert1 unused count: 189
Expert2 unused count: 214
Expert1 balance top: 71.09375
Expert2 balance top: 81.591796875

New cuda time: 1.8094489574432373
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9440089464187622
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1395.295654296875, gpu time: 280.0523202419281
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.150390625
Expert1 unused count: 154
Expert2 unused count: 266
Expert1 balance top: 71.435546875
Expert2 balance top: 89.35546875

New cuda time: 1.7772890329360962
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960089445114136
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2150.567626953125, gpu time: 308.0060555934906
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.1953125
Expert1 unused count: 170
Expert2 unused count: 290
Expert1 balance top: 76.5625
Expert2 balance top: 91.40625

New cuda time: 1.8030489683151245
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.967208981513977
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1302.273193359375, gpu time: 267.57803440093994
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 1.953125
Expert1 unused count: 184
Expert2 unused count: 293
Expert1 balance top: 76.513671875
Expert2 balance top: 91.50390625

New cuda time: 1.8048089742660522
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7963279485702515
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1145.713134765625, gpu time: 206.5942301750183
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 0.29296875
Expert1 unused count: 206
Expert2 unused count: 275
Expert1 balance top: 78.7109375
Expert2 balance top: 89.306640625

New cuda time: 8.701959609985352
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7766480445861816
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1296.3271484375, gpu time: 288.41028332710266
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 205
Expert2 unused count: 270
Expert1 balance top: 80.859375
Expert2 balance top: 88.4765625

New cuda time: 1.8108890056610107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79072904586792
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 773.588623046875, gpu time: 214.3379487991333
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.4921875
Expert2 overflow: 2.1484375
Expert1 unused count: 231
Expert2 unused count: 251
Expert1 balance top: 83.740234375
Expert2 balance top: 80.810546875

New cuda time: 1.804648995399475
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.816329002380371
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1403.962158203125, gpu time: 283.67329823970795
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.615234375
Expert1 unused count: 113
Expert2 unused count: 268
Expert1 balance top: 66.796875
Expert2 balance top: 89.892578125

New cuda time: 1.8174480199813843
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9528089761734009
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2166.6533203125, gpu time: 311.7763125896454
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.443359375
Expert1 unused count: 110
Expert2 unused count: 297
Expert1 balance top: 66.552734375
Expert2 balance top: 93.212890625

New cuda time: 1.8078479766845703
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9628889560699463
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1318.3291015625, gpu time: 271.34877133369446
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.46484375
Expert1 unused count: 115
Expert2 unused count: 279
Expert1 balance top: 67.431640625
Expert2 balance top: 91.40625

New cuda time: 1.8166489601135254
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843279838562012
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1155.5830078125, gpu time: 210.19520711898804
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 117
Expert2 unused count: 239
Expert1 balance top: 67.3828125
Expert2 balance top: 86.962890625

New cuda time: 1.8030489683151245
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9774500131607056
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1364.380126953125, gpu time: 292.1907813549042
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 132
Expert2 unused count: 203
Expert1 balance top: 69.04296875
Expert2 balance top: 83.10546875

New cuda time: 1.8033679723739624
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792809009552002
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 783.222900390625, gpu time: 217.93412578105927
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 4.98046875
Expert1 unused count: 127
Expert2 unused count: 180
Expert1 balance top: 70.01953125
Expert2 balance top: 77.392578125

New cuda time: 1.8065680265426636
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.983530044555664
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1481.4267578125, gpu time: 287.4633963108063
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 8.642578125
Expert1 unused count: 222
Expert2 unused count: 320
Expert1 balance top: 78.369140625
Expert2 balance top: 93.896484375

New cuda time: 1.81168794631958
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7878479957580566
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2175.652099609375, gpu time: 315.375848531723
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 4.78515625
Expert1 unused count: 236
Expert2 unused count: 306
Expert1 balance top: 81.0546875
Expert2 balance top: 92.1875

New cuda time: 1.804967999458313
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 68.31551361083984
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1393.832763671875, gpu time: 341.4692529439926
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 2.490234375
Expert1 unused count: 248
Expert2 unused count: 304
Expert1 balance top: 80.46875
Expert2 balance top: 92.724609375

New cuda time: 1.797287940979004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897679805755615
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1164.707275390625, gpu time: 213.7822630405426
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.541015625
Expert2 overflow: 1.416015625
Expert1 unused count: 262
Expert2 unused count: 290
Expert1 balance top: 83.69140625
Expert2 balance top: 89.990234375

New cuda time: 1.8139280080795288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8265680074691772
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1373.1474609375, gpu time: 295.8312773704529
2024-07-11 01:41:54 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 1.07421875
Expert1 unused count: 271
Expert2 unused count: 294
Expert1 balance top: 83.3984375
Expert2 balance top: 89.697265625

New cuda time: 1.7995280027389526
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.979369044303894
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 855.58544921875, gpu time: 221.7130228281021
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 1.513671875
Expert1 unused count: 266
Expert2 unused count: 281
Expert1 balance top: 83.740234375
Expert2 balance top: 84.619140625

New cuda time: 1.8081690073013306
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8064080476760864
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1489.9453125, gpu time: 291.0779733657837
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.88671875
Expert2 overflow: 5.95703125
Expert1 unused count: 293
Expert2 unused count: 338
Expert1 balance top: 88.18359375
Expert2 balance top: 95.751953125

New cuda time: 1.819208025932312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7825679779052734
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2184.601318359375, gpu time: 318.9776254892349
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.494140625
Expert2 overflow: 3.22265625
Expert1 unused count: 301
Expert2 unused count: 347
Expert1 balance top: 89.0625
Expert2 balance top: 95.41015625

New cuda time: 1.8176089525222778
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.793768048286438
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1402.7099609375, gpu time: 345.08062994480133
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 3.369140625
Expert1 unused count: 291
Expert2 unused count: 337
Expert1 balance top: 86.81640625
Expert2 balance top: 93.896484375

New cuda time: 1.7939280271530151
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.776487946510315
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1173.57177734375, gpu time: 217.35267901420593
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.6875
Expert2 overflow: 2.5390625
Expert1 unused count: 292
Expert2 unused count: 321
Expert1 balance top: 86.5234375
Expert2 balance top: 92.138671875

New cuda time: 1.7929680347442627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824089527130127
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1382.040283203125, gpu time: 299.40665435791016
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.3671875
Expert2 overflow: 3.857421875
Expert1 unused count: 311
Expert2 unused count: 331
Expert1 balance top: 89.111328125
Expert2 balance top: 94.482421875

New cuda time: 1.8225680589675903
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801448941230774
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 864.513916015625, gpu time: 225.3370407819748
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 2.5390625
Expert1 unused count: 306
Expert2 unused count: 327
Expert1 balance top: 88.037109375
Expert2 balance top: 90.380859375

New cuda time: 1.8032089471817017
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.776487946510315
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1498.76953125, gpu time: 294.6576702594757
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.025390625
Expert1 unused count: 130
Expert2 unused count: 234
Expert1 balance top: 67.3828125
Expert2 balance top: 86.03515625

New cuda time: 1.8144090175628662
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7793680429458618
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2193.425048828125, gpu time: 322.57140254974365
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.46875
Expert1 unused count: 151
Expert2 unused count: 287
Expert1 balance top: 73.876953125
Expert2 balance top: 91.455078125

New cuda time: 1.81312894821167
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891290187835693
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1411.602294921875, gpu time: 348.68288791179657
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.171875
Expert1 unused count: 151
Expert2 unused count: 268
Expert1 balance top: 72.75390625
Expert2 balance top: 88.76953125

New cuda time: 1.8006490468978882
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.77456796169281
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1182.421142578125, gpu time: 220.92789602279663
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.171875
Expert1 unused count: 176
Expert2 unused count: 261
Expert1 balance top: 73.876953125
Expert2 balance top: 89.0625

New cuda time: 1.7977689504623413
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78656804561615
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1390.92578125, gpu time: 302.99099135398865
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.1953125
Expert1 unused count: 203
Expert2 unused count: 236
Expert1 balance top: 76.7578125
Expert2 balance top: 83.447265625

New cuda time: 1.8099290132522583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8240089416503906
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 873.231689453125, gpu time: 228.97097873687744
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 2.63671875
Expert1 unused count: 191
Expert2 unused count: 211
Expert1 balance top: 77.685546875
Expert2 balance top: 76.904296875

New cuda time: 1.8052879571914673
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.76528799533844
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1507.5947265625, gpu time: 298.2282462120056
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.9609375
Expert2 overflow: 5.6640625
Expert1 unused count: 293
Expert2 unused count: 341
Expert1 balance top: 88.720703125
Expert2 balance top: 95.99609375

New cuda time: 1.807047963142395
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.1000099182128906
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2207.81591796875, gpu time: 326.47846043109894
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.982421875
Expert2 overflow: 5.76171875
Expert1 unused count: 302
Expert2 unused count: 339
Expert1 balance top: 89.208984375
Expert2 balance top: 94.287109375

New cuda time: 1.8102480173110962
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876880168914795
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1420.4677734375, gpu time: 352.28082394599915
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.294921875
Expert2 overflow: 2.978515625
Expert1 unused count: 296
Expert2 unused count: 335
Expert1 balance top: 87.255859375
Expert2 balance top: 94.091796875

New cuda time: 1.9707289934158325
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.825767993927002
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1191.518310546875, gpu time: 224.72439301013947
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.4921875
Expert2 overflow: 2.63671875
Expert1 unused count: 310
Expert2 unused count: 316
Expert1 balance top: 88.18359375
Expert2 balance top: 92.041015625

New cuda time: 1.94576895236969
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8296079635620117
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1404.62841796875, gpu time: 306.76636826992035
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.9765625
Expert2 overflow: 4.736328125
Expert1 unused count: 313
Expert2 unused count: 330
Expert1 balance top: 90.72265625
Expert2 balance top: 93.505859375

New cuda time: 1.8051279783248901
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.825767993927002
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 881.90576171875, gpu time: 232.60187470912933
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 1.07421875
Expert1 unused count: 315
Expert2 unused count: 318
Expert1 balance top: 87.20703125
Expert2 balance top: 88.818359375

New cuda time: 1.8065680265426636
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0753700733184814
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1519.2099609375, gpu time: 302.11018431186676
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 2.734375
Expert1 unused count: 190
Expert2 unused count: 287
Expert1 balance top: 72.607421875
Expert2 balance top: 91.015625

New cuda time: 1.803048014640808
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8240089416503906
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2216.388427734375, gpu time: 330.10551738739014
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.68359375
Expert1 unused count: 223
Expert2 unused count: 309
Expert1 balance top: 77.001953125
Expert2 balance top: 92.236328125

New cuda time: 1.8078479766845703
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7766480445861816
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1430.938232421875, gpu time: 355.8653199672699
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 220
Expert2 unused count: 303
Expert1 balance top: 75.09765625
Expert2 balance top: 90.576171875

New cuda time: 1.807528018951416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817679643630981
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1201.6806640625, gpu time: 228.31368899345398
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 1.025390625
Expert1 unused count: 246
Expert2 unused count: 291
Expert1 balance top: 78.271484375
Expert2 balance top: 90.185546875

New cuda time: 1.8022480010986328
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7852879762649536
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1414.843994140625, gpu time: 310.35390424728394
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 259
Expert2 unused count: 296
Expert1 balance top: 80.078125
Expert2 balance top: 88.720703125

New cuda time: 1.8099290132522583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899279594421387
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 891.688232421875, gpu time: 236.20173168182373
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 270
Expert2 unused count: 274
Expert1 balance top: 81.103515625
Expert2 balance top: 83.251953125

New cuda time: 1.8300889730453491
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.781609058380127
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1528.08154296875, gpu time: 305.72188234329224
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.25
Expert2 overflow: 3.7109375
Expert1 unused count: 267
Expert2 unused count: 338
Expert1 balance top: 83.7890625
Expert2 balance top: 95.654296875

New cuda time: 1.8076879978179932
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7768080234527588
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2225.654052734375, gpu time: 333.6900134086609
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.17578125
Expert2 overflow: 3.22265625
Expert1 unused count: 286
Expert2 unused count: 342
Expert1 balance top: 85.400390625
Expert2 balance top: 94.873046875

New cuda time: 1.8132879734039307
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806479930877686
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1439.90625, gpu time: 359.4592559337616
2024-07-11 01:41:55 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 2.392578125
Expert1 unused count: 290
Expert2 unused count: 334
Expert1 balance top: 83.69140625
Expert2 balance top: 94.43359375

New cuda time: 1.809928059577942
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806479930877686
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1210.69775390625, gpu time: 231.904265999794
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.58984375
Expert2 overflow: 2.392578125
Expert1 unused count: 286
Expert2 unused count: 322
Expert1 balance top: 84.130859375
Expert2 balance top: 92.7734375

New cuda time: 1.7921689748764038
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950479984283447
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1427.345703125, gpu time: 313.9411212205887
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 3.955078125
Expert1 unused count: 304
Expert2 unused count: 318
Expert1 balance top: 87.98828125
Expert2 balance top: 92.919921875

New cuda time: 1.909769058227539
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780648946762085
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 907.645751953125, gpu time: 239.89214861392975
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 4.58984375
Expert1 unused count: 313
Expert2 unused count: 314
Expert1 balance top: 86.71875
Expert2 balance top: 89.74609375

New cuda time: 1.816329002380371
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775048017501831
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1537.743896484375, gpu time: 309.31325936317444
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 10.791015625
Expert1 unused count: 161
Expert2 unused count: 281
Expert1 balance top: 75.244140625
Expert2 balance top: 91.845703125

New cuda time: 1.818727970123291
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7830480337142944
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2235.583740234375, gpu time: 337.2917894124985
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 8.203125
Expert1 unused count: 179
Expert2 unused count: 296
Expert1 balance top: 76.708984375
Expert2 balance top: 92.431640625

New cuda time: 1.9694490432739258
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7854479551315308
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1449.44580078125, gpu time: 363.21415293216705
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 8.349609375
Expert1 unused count: 193
Expert2 unused count: 301
Expert1 balance top: 77.83203125
Expert2 balance top: 92.041015625

New cuda time: 1.771360993385315
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.93503999710083
New cuda time: 1.7761600017547607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.802240014076233
New cuda time: 1.7824000120162964
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8099199533462524
New cuda time: 1.7782399654388428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9524799585342407
New cuda time: 1.7817599773406982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 1.7832000255584717
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7943999767303467
New cuda time: 1.7766400575637817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7963199615478516
New cuda time: 1.779520034790039
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.955680012702942
New cuda time: 1.7766400575637817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795199990272522
New cuda time: 1.9139200448989868
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.811040997505188
New cuda time: 1.780640959739685
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.950080871582031
New cuda time: 1.7878409624099731
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9622399806976318
New cuda time: 1.7908799648284912
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.7708799839019775
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.848479986190796
New cuda time: 1.7828799486160278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.958400011062622
New cuda time: 1.7844799757003784
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9336010217666626
New cuda time: 1.7731200456619263
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.806399941444397
New cuda time: 1.7849600315093994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8001600503921509
New cuda time: 1.9321600198745728
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891199588775635
New cuda time: 1.7803200483322144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9356800317764282
New cuda time: 1.76944100856781
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7870399951934814
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9822399616241455
New cuda time: 1.7719999551773071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888000011444092
New cuda time: 1.7708799839019775
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9708800315856934
New cuda time: 1.7871999740600586
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785600423812866
New cuda time: 8.783520698547363
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7947200536727905
New cuda time: 1.7780799865722656
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7993600368499756
New cuda time: 1.783681035041809
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960000038146973
New cuda time: 1.7838399410247803
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9523199796676636
New cuda time: 1.779360055923462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8806400299072266
New cuda time: 1.7846410274505615
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841600179672241
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9692800045013428
New cuda time: 1.7726399898529053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.800320029258728
New cuda time: 1.7857600450515747
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9796799421310425
New cuda time: 1.7857600450515747
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8243199586868286
New cuda time: 1.7889599800109863
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 68.33040618896484
New cuda time: 1.772320032119751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857600450515747
New cuda time: 1.7729599475860596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.797760009765625
New cuda time: 1.7798399925231934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9657599925994873
New cuda time: 1.7792010307312012
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841600179672241
New cuda time: 1.7913600206375122
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843199968338013
New cuda time: 1.779039978981018
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828799486160278
New cuda time: 1.765120029449463
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910399436950684
New cuda time: 1.7735999822616577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7945599555969238
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790719985961914
New cuda time: 1.7753599882125854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9281599521636963
New cuda time: 1.784000039100647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892800569534302
New cuda time: 1.788640022277832
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910399436950684
New cuda time: 1.7633600234985352
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910399436950684
New cuda time: 1.77183997631073
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955199480056763
New cuda time: 1.7897599935531616
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7923200130462646
New cuda time: 1.7670400142669678
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.940000057220459
New cuda time: 1.7625600099563599
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9620800018310547
New cuda time: 1.788640022277832
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8065600395202637
New cuda time: 1.960479974746704
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7942399978637695
New cuda time: 1.9615999460220337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8041599988937378
New cuda time: 1.781599998474121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7979199886322021
New cuda time: 1.769279956817627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 4.122719764709473
New cuda time: 1.7735999822616577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848000526428223
New cuda time: 1.7787200212478638
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 1.783519983291626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7791999578475952
New cuda time: 1.7782399654388428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939209938049316
New cuda time: 1.7892800569534302
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929600477218628
New cuda time: 1.7803210020065308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.818560004234314
New cuda time: 1.7680009603500366
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7836799621582031
New cuda time: 1.756160020828247
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801440954208374
New cuda time: 1.7752009630203247
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786080002784729
New cuda time: 1.7735999822616577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8220800161361694
New cuda time: 8.66416072845459
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848000526428223
New cuda time: 1.7888009548187256
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.7755199670791626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848000526428223
New cuda time: 1.931839942932129
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790719985961914
New cuda time: 1.7889599800109863
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: New cuda time: 1.7772870063781738
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.952327013015747
New cuda time: 1.7731269598007202
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7900869846343994
New cuda time: 1.7752070426940918
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7995270490646362
New cuda time: 1.7894459962844849
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9379279613494873
New cuda time: 1.770885944366455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78512704372406
New cuda time: 1.780007004737854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931269407272339
New cuda time: 1.7793669700622559
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833659648895264
New cuda time: 1.786566972732544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9433670043945312
New cuda time: 1.768646001815796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8091269731521606
New cuda time: 1.906087040901184
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789126992225647
New cuda time: 1.7761659622192383
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.949633598327637
New cuda time: 1.7832070589065552
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9545669555664062
New cuda time: 1.7700870037078857
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7995270490646362
New cuda time: 1.782405972480774
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.861767053604126
New cuda time: 1.7705670595169067
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951686978340149
New cuda time: 1.7740859985351562
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9368070363998413
New cuda time: 1.7929660081863403
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7784069776535034
New cuda time: 1.7763270139694214
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8004870414733887
New cuda time: 1.9361679553985596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796807050704956
New cuda time: 1.7928069829940796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9400060176849365
New cuda time: 1.7771270275115967
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875269651412964
New cuda time: 1.7768069505691528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9851280450820923
New cuda time: 1.79168701171875
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824070453643799
New cuda time: 1.779845952987671
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953766942024231
New cuda time: 1.7838469743728638
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784487009048462
New cuda time: 8.662592887878418
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920069694519043
New cuda time: 1.787047028541565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862470149993896
New cuda time: 1.775367021560669
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7792069911956787
New cuda time: 1.775046944618225
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9571280479431152
New cuda time: 1.7918460369110107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9539270401000977
New cuda time: 1.7940870523452759
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876869440078735
New cuda time: 1.7700870037078857
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9667270183563232
New cuda time: 1.7859270572662354
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7916860580444336
New cuda time: 1.7822469472885132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.972486972808838
New cuda time: 1.773287057876587
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7704060077667236
New cuda time: 1.7862470149993896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 68.29769897460938
New cuda time: 1.773447036743164
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7944070100784302
New cuda time: 1.7868859767913818
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7801669836044312
New cuda time: 1.7785669565200806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9721670150756836
New cuda time: 1.784006953239441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936069965362549
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.791206955909729
New cuda time: 1.7836860418319702
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8126469850540161
New cuda time: 1.7776069641113281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79168701171875
New cuda time: 1.77040696144104
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796807050704956
New cuda time: 1.7811260223388672
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792165994644165
New cuda time: 1.7884860038757324
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9342470169067383
New cuda time: 1.7724870443344116
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910469770431519
New cuda time: 1.7638460397720337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7905670404434204
New cuda time: 1.7996870279312134
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.791206955909729
New cuda time: 1.76624596118927
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7700860500335693
New cuda time: 1.7724870443344116
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787207007408142
New cuda time: 1.7950470447540283
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.940647006034851
New cuda time: 1.7822469472885132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9424079656600952
New cuda time: 1.7857669591903687
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7875269651412964
New cuda time: 1.9526469707489014
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.797126054763794
New cuda time: 1.9534480571746826
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7934470176696777
New cuda time: 1.7729660272598267
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936060428619385
New cuda time: 1.7678459882736206
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7404860258102417
New cuda time: 1.7652870416641235
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7782469987869263
New cuda time: 1.7782460451126099
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868870496749878
New cuda time: 1.7747269868850708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7944070100784302
New cuda time: 1.7848069667816162
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817670106887817
New cuda time: 1.7910469770431519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868870496749878
New cuda time: 1.787047028541565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8180869817733765
New cuda time: 1.7892869710922241
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848069667816162
New cuda time: 1.7723259925842285
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7800060510635376
New cuda time: 1.7764869928359985
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784965991973877
New cuda time: 1.7832070589065552
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7678459882736206
New cuda time: 8.54371166229248
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777927041053772
New cuda time: 1.787047028541565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796807050704956
New cuda time: 1.7643259763717651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7977670431137085
New cuda time: 1.9484870433807373
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8324869871139526
New cuda time: 1.7955269813537598
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: New cuda time: 1.7731139659881592
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9809520244598389
New cuda time: 1.7721530199050903
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.7611130475997925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.825273036956787
New cuda time: 1.7694339752197266
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8116730451583862
New cuda time: 1.7791930437088013
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8209530115127563
New cuda time: 1.7633529901504517
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8140729665756226
New cuda time: 1.7723129987716675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.7702330350875854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777529954910278
New cuda time: 1.7767930030822754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819512963294983
New cuda time: 1.7756739854812622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8164730072021484
New cuda time: 1.7787129878997803
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.94924545288086
New cuda time: 1.775833010673523
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.946552038192749
New cuda time: 1.766394019126892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.769273042678833
New cuda time: 1.7689529657363892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7745529413223267
New cuda time: 1.7807940244674683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.940953016281128
New cuda time: 1.7681540250778198
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7798329591751099
New cuda time: 1.7535929679870605
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8148729801177979
New cuda time: 1.7695930004119873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7819130420684814
New cuda time: 1.8116730451583862
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.818073034286499
New cuda time: 1.7551929950714111
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7868729829788208
New cuda time: 1.7811130285263062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8211129903793335
New cuda time: 1.7803130149841309
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9563119411468506
New cuda time: 1.7817529439926147
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.77327299118042
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.959831953048706
New cuda time: 1.7673530578613281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8036730289459229
New cuda time: 1.9167920351028442
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.812952995300293
New cuda time: 1.7583930492401123
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8268729448318481
New cuda time: 1.7582329511642456
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7671929597854614
New cuda time: 1.7719930410385132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9788730144500732
New cuda time: 1.7654329538345337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9667119979858398
New cuda time: 1.773913025856018
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8191930055618286
New cuda time: 1.7665530443191528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9435110092163086
New cuda time: 1.7614330053329468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8052730560302734
New cuda time: 1.760633945465088
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9476710557937622
New cuda time: 1.759194016456604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787192940711975
New cuda time: 1.7580740451812744
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 68.30645751953125
New cuda time: 1.771353006362915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8153530359268188
New cuda time: 1.773432970046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7750329971313477
New cuda time: 1.7574330568313599
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9534330368041992
New cuda time: 1.7719930410385132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7969529628753662
New cuda time: 1.7703930139541626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7935930490493774
New cuda time: 1.761273980140686
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7919930219650269
New cuda time: 1.7747139930725098
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892730236053467
New cuda time: 1.7668730020523071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7945530414581299
New cuda time: 1.7587130069732666
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7731130123138428
New cuda time: 1.7686330080032349
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7807929515838623
New cuda time: 1.7767939567565918
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796633005142212
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939130067825317
New cuda time: 1.7756730318069458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7951929569244385
New cuda time: 1.773913025856018
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918330430984497
New cuda time: 1.785112977027893
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7759939432144165
New cuda time: 1.7767930030822754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7822329998016357
New cuda time: 1.7759939432144165
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.1124720573425293
New cuda time: 1.7630330324172974
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7959929704666138
New cuda time: 1.929751992225647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.770393967628479
New cuda time: 1.961272954940796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796729803085327
New cuda time: 1.7766330242156982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7836730480194092
New cuda time: 1.768314003944397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.039191961288452
New cuda time: 1.7831929922103882
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924729585647583
New cuda time: 1.7761540412902832
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8254330158233643
New cuda time: 1.762233018875122
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8191930055618286
New cuda time: 1.7547130584716797
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824152946472168
New cuda time: 1.7852729558944702
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824633002281189
New cuda time: 1.7799930572509766
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777529954910278
New cuda time: 1.7635129690170288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8145530223846436
New cuda time: 1.7803130149841309
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990330457687378
New cuda time: 1.764633059501648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8004729747772217
New cuda time: 1.7521530389785767
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7887929677963257
New cuda time: 8.458527565002441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788153052330017
New cuda time: 1.759672999382019
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8294329643249512
New cuda time: 1.7630330324172974
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.81967294216156
New cuda time: 1.9361519813537598
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7958329916000366
New cuda time: 1.764153003692627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: New cuda time: 1.825929045677185
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7488080263137817
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1230.808837890625, gpu time: 235.47900199890137
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 1.708984375
Expert1 unused count: 213
Expert2 unused count: 291
Expert1 balance top: 79.00390625
Expert2 balance top: 91.064453125

New cuda time: 1.809607982635498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.772007942199707
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1438.417724609375, gpu time: 317.5227371454239
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 213
Expert2 unused count: 259
Expert1 balance top: 78.7109375
Expert2 balance top: 87.646484375

New cuda time: 1.7974480390548706
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915279865264893
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 917.451904296875, gpu time: 243.48112559318542
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.1015625
Expert2 overflow: 1.07421875
Expert1 unused count: 234
Expert2 unused count: 259
Expert1 balance top: 81.8359375
Expert2 balance top: 83.544921875

New cuda time: 1.814247965812683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7856080532073975
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1547.066650390625, gpu time: 312.9131153821945
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 7.32421875
Expert1 unused count: 191
Expert2 unused count: 288
Expert1 balance top: 74.951171875
Expert2 balance top: 91.6015625

New cuda time: 1.8022480010986328
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9478490352630615
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2253.7880859375, gpu time: 341.04188644886017
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.61328125
Expert1 unused count: 197
Expert2 unused count: 301
Expert1 balance top: 79.052734375
Expert2 balance top: 92.724609375

New cuda time: 1.7982490062713623
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7700879573822021
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1459.506103515625, gpu time: 366.7824898958206
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 1.123046875
Expert1 unused count: 208
Expert2 unused count: 302
Expert1 balance top: 78.7109375
Expert2 balance top: 91.50390625

New cuda time: 1.7950479984283447
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.795367956161499
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1240.40234375, gpu time: 239.0694179534912
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.443359375
Expert2 overflow: 1.904296875
Expert1 unused count: 220
Expert2 unused count: 287
Expert1 balance top: 79.443359375
Expert2 balance top: 90.673828125

New cuda time: 1.8041679859161377
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7825679779052734
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1447.97509765625, gpu time: 321.1094731092453
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.07421875
Expert1 unused count: 218
Expert2 unused count: 278
Expert1 balance top: 79.58984375
Expert2 balance top: 90.087890625

New cuda time: 1.8091280460357666
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.892969012260437
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 927.274169921875, gpu time: 247.18322360515594
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.80859375
Expert2 overflow: 3.369140625
Expert1 unused count: 233
Expert2 unused count: 260
Expert1 balance top: 80.859375
Expert2 balance top: 82.91015625

New cuda time: 1.952968955039978
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915279865264893
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1569.285400390625, gpu time: 316.657612323761
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.787109375
Expert1 unused count: 139
Expert2 unused count: 268
Expert1 balance top: 71.142578125
Expert2 balance top: 89.990234375

New cuda time: 1.9816089868545532
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7811280488967896
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2267.119384765625, gpu time: 344.8046234846115
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.490234375
Expert2 overflow: 3.61328125
Expert1 unused count: 157
Expert2 unused count: 297
Expert1 balance top: 73.095703125
Expert2 balance top: 92.138671875

New cuda time: 1.7985680103302002
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9518489837646484
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1469.4228515625, gpu time: 370.53290688991547
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 161
Expert2 unused count: 282
Expert1 balance top: 74.951171875
Expert2 balance top: 90.380859375

New cuda time: 1.8014479875564575
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 12.571418762207031
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1261.33935546875, gpu time: 253.4422847032547
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 0.439453125
Expert1 unused count: 185
Expert2 unused count: 263
Expert1 balance top: 77.44140625
Expert2 balance top: 88.4765625

New cuda time: 1.8099290132522583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9430489540100098
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1457.947021484375, gpu time: 324.86245012283325
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 195
Expert2 unused count: 229
Expert1 balance top: 76.904296875
Expert2 balance top: 83.056640625

New cuda time: 1.8062479496002197
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.93264901638031
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 937.016357421875, gpu time: 250.92212057113647
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.001953125
Expert2 overflow: 4.541015625
Expert1 unused count: 212
Expert2 unused count: 237
Expert1 balance top: 82.373046875
Expert2 balance top: 81.103515625

New cuda time: 1.8131279945373535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857680320739746
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1578.713623046875, gpu time: 320.2565083503723
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.26953125
Expert1 unused count: 162
Expert2 unused count: 269
Expert1 balance top: 71.044921875
Expert2 balance top: 89.794921875

New cuda time: 1.8228880167007446
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.797767996788025
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2276.596435546875, gpu time: 348.4252794981003
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.369140625
Expert1 unused count: 167
Expert2 unused count: 296
Expert1 balance top: 74.365234375
Expert2 balance top: 91.40625

New cuda time: 1.807047963142395
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.936648964881897
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1485.474365234375, gpu time: 374.27660489082336
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 0.830078125
Expert1 unused count: 188
Expert2 unused count: 286
Expert1 balance top: 75.732421875
Expert2 balance top: 90.673828125

New cuda time: 1.8036880493164062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.772968053817749
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1271.581298828125, gpu time: 257.01894080638885
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.759765625
Expert2 overflow: 2.392578125
Expert1 unused count: 216
Expert2 unused count: 272
Expert1 balance top: 79.296875
Expert2 balance top: 89.111328125

New cuda time: 1.8104079961776733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8179279565811157
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1466.9423828125, gpu time: 328.49078702926636
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 0.927734375
Expert1 unused count: 229
Expert2 unused count: 260
Expert1 balance top: 82.666015625
Expert2 balance top: 85.009765625

New cuda time: 1.8084889650344849
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827279567718506
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 946.79736328125, gpu time: 254.5133374929428
2024-07-11 01:41:56 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.91015625
Expert2 overflow: 5.95703125
Expert1 unused count: 246
Expert2 unused count: 246
Expert1 balance top: 85.64453125
Expert2 balance top: 81.15234375

New cuda time: 1.797287940979004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.76944899559021
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1593.570068359375, gpu time: 323.82324635982513
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.634765625
Expert1 unused count: 181
Expert2 unused count: 281
Expert1 balance top: 72.8515625
Expert2 balance top: 90.72265625

New cuda time: 1.7969690561294556
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889690399169922
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2286.594970703125, gpu time: 352.01121759414673
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.87890625
Expert1 unused count: 208
Expert2 unused count: 307
Expert1 balance top: 78.41796875
Expert2 balance top: 91.552734375

New cuda time: 1.8129680156707764
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.955849051475525
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1500.373779296875, gpu time: 378.045422911644
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.517578125
Expert1 unused count: 218
Expert2 unused count: 309
Expert1 balance top: 81.103515625
Expert2 balance top: 92.67578125

New cuda time: 3.990899085998535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.781769037246704
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1283.509033203125, gpu time: 262.7916089296341
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 1.07421875
Expert1 unused count: 230
Expert2 unused count: 283
Expert1 balance top: 81.591796875
Expert2 balance top: 90.33203125

New cuda time: 1.8038480281829834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9548890590667725
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1483.88623046875, gpu time: 332.24952507019043
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 258
Expert2 unused count: 289
Expert1 balance top: 85.64453125
Expert2 balance top: 89.208984375

New cuda time: 1.7899279594421387
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9201689958572388
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 955.955322265625, gpu time: 258.2234344482422
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.8828125
Expert2 overflow: 7.71484375
Expert1 unused count: 254
Expert2 unused count: 267
Expert1 balance top: 86.962890625
Expert2 balance top: 82.91015625

New cuda time: 1.7980890274047852
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7758480310440063
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1602.373291015625, gpu time: 327.3971823453903
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 4.00390625
Expert1 unused count: 202
Expert2 unused count: 318
Expert1 balance top: 79.19921875
Expert2 balance top: 93.84765625

New cuda time: 1.8012880086898804
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7763279676437378
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2296.52685546875, gpu time: 355.58883357048035
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.734375
Expert2 overflow: 1.513671875
Expert1 unused count: 212
Expert2 unused count: 318
Expert1 balance top: 80.908203125
Expert2 balance top: 93.115234375

New cuda time: 1.8171279430389404
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780168056488037
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1509.754638671875, gpu time: 381.64271891117096
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.26953125
Expert1 unused count: 228
Expert2 unused count: 318
Expert1 balance top: 79.58984375
Expert2 balance top: 92.919921875

New cuda time: 2.0510499477386475
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843290567398071
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1300.961181640625, gpu time: 266.62698793411255
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.638671875
Expert2 overflow: 3.125
Expert1 unused count: 234
Expert2 unused count: 301
Expert1 balance top: 82.275390625
Expert2 balance top: 90.185546875

New cuda time: 1.8073680400848389
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7932889461517334
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1494.003662109375, gpu time: 335.8501830101013
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 2.734375
Expert1 unused count: 243
Expert2 unused count: 281
Expert1 balance top: 83.59375
Expert2 balance top: 88.134765625

New cuda time: 1.8035279512405396
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790889024734497
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 965.256591796875, gpu time: 261.8178514242172
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.173828125
Expert2 overflow: 3.369140625
Expert1 unused count: 269
Expert2 unused count: 291
Expert1 balance top: 84.66796875
Expert2 balance top: 86.669921875

New cuda time: 1.8100889921188354
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873680591583252
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1612.013427734375, gpu time: 330.99463844299316
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.076171875
Expert1 unused count: 71
Expert2 unused count: 253
Expert1 balance top: 59.9609375
Expert2 balance top: 88.57421875

New cuda time: 1.7968080043792725
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951369047164917
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2311.914794921875, gpu time: 359.33701062202454
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.759765625
Expert1 unused count: 77
Expert2 unused count: 263
Expert1 balance top: 62.548828125
Expert2 balance top: 89.990234375

New cuda time: 1.8062490224838257
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.772487998008728
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1519.968017578125, gpu time: 385.2214559316635
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.830078125
Expert1 unused count: 83
Expert2 unused count: 233
Expert1 balance top: 62.353515625
Expert2 balance top: 87.109375

New cuda time: 1.8064080476760864
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7748889923095703
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1311.01416015625, gpu time: 270.2082849740982
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 92
Expert2 unused count: 219
Expert1 balance top: 61.71875
Expert2 balance top: 84.9609375

New cuda time: 1.795367956161499
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7696080207824707
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1504.032958984375, gpu time: 339.4151600599289
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 0.78125
Expert1 unused count: 108
Expert2 unused count: 174
Expert1 balance top: 62.744140625
Expert2 balance top: 78.125

New cuda time: 1.8200080394744873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.972041130065918
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 985.765380859375, gpu time: 272.60990059375763
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 2.490234375
Expert1 unused count: 127
Expert2 unused count: 149
Expert1 balance top: 67.28515625
Expert2 balance top: 70.849609375

New cuda time: 1.8091280460357666
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790889024734497
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1621.652587890625, gpu time: 334.5946555137634
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.857421875
Expert2 overflow: 14.794921875
Expert1 unused count: 277
Expert2 unused count: 334
Expert1 balance top: 90.185546875
Expert2 balance top: 94.970703125

New cuda time: 1.7934479713439941
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7804880142211914
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2321.902099609375, gpu time: 362.9109466075897
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.568359375
Expert1 unused count: 294
Expert2 unused count: 339
Expert1 balance top: 91.064453125
Expert2 balance top: 95.60546875

New cuda time: 1.8032079935073853
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859280109405518
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1529.650146484375, gpu time: 388.81059193611145
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 3.173828125
Expert1 unused count: 297
Expert2 unused count: 346
Expert1 balance top: 90.52734375
Expert2 balance top: 95.556640625

New cuda time: 1.799847960472107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794888973236084
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1320.644287109375, gpu time: 273.8030219078064
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.7109375
Expert2 overflow: 6.54296875
Expert1 unused count: 326
Expert2 unused count: 337
Expert1 balance top: 93.5546875
Expert2 balance top: 94.82421875

New cuda time: 2.048168897628784
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7755279541015625
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1520.541015625, gpu time: 343.23885691165924
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 7.421875
Expert1 unused count: 330
Expert2 unused count: 344
Expert1 balance top: 93.017578125
Expert2 balance top: 95.01953125

New cuda time: 1.8009690046310425
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899279594421387
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 994.904296875, gpu time: 276.2007975578308
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.5625
Expert2 overflow: 2.9296875
Expert1 unused count: 328
Expert2 unused count: 329
Expert1 balance top: 91.2109375
Expert2 balance top: 91.259765625

New cuda time: 1.802888035774231
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7840089797973633
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1631.021728515625, gpu time: 338.181552529335
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.568359375
Expert1 unused count: 110
Expert2 unused count: 265
Expert1 balance top: 65.8203125
Expert2 balance top: 90.283203125

New cuda time: 1.7956880331039429
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7763279676437378
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2331.0166015625, gpu time: 366.4829626083374
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 2.197265625
Expert1 unused count: 106
Expert2 unused count: 278
Expert1 balance top: 68.896484375
Expert2 balance top: 91.162109375

New cuda time: 1.7964880466461182
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.943848967552185
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1543.382568359375, gpu time: 392.55092895030975
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 117
Expert2 unused count: 257
Expert1 balance top: 67.724609375
Expert2 balance top: 89.208984375

New cuda time: 1.8134479522705078
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7849680185317993
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1330.08935546875, gpu time: 277.4014378786087
2024-07-11 01:41:57 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 135
Expert2 unused count: 240
Expert1 balance top: 69.04296875
Expert2 balance top: 88.037109375

New cuda time: 1.8067280054092407
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891279458999634
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1529.70556640625, gpu time: 346.83471286296844
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 125
Expert2 unused count: 223
Expert1 balance top: 66.89453125
Expert2 balance top: 84.765625

New cuda time: 1.8017679452896118
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7846479415893555
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1004.866943359375, gpu time: 279.7872134447098
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 128
Expert2 unused count: 190
Expert1 balance top: 69.43359375
Expert2 balance top: 75.341796875

New cuda time: 1.8150490522384644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.143721580505371
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1647.8642578125, gpu time: 349.14032316207886
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.615234375
Expert1 unused count: 122
Expert2 unused count: 243
Expert1 balance top: 64.74609375
Expert2 balance top: 87.59765625

New cuda time: 1.797929048538208
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.966249942779541
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2347.697509765625, gpu time: 370.24714159965515
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 2.734375
Expert1 unused count: 128
Expert2 unused count: 281
Expert1 balance top: 69.23828125
Expert2 balance top: 91.40625

New cuda time: 1.8097679615020752
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7942490577697754
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1552.86865234375, gpu time: 396.1549459695816
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 132
Expert2 unused count: 270
Expert1 balance top: 68.65234375
Expert2 balance top: 89.74609375

New cuda time: 1.8067289590835571
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7846490144729614
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1339.424560546875, gpu time: 280.9928148984909
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 137
Expert2 unused count: 236
Expert1 balance top: 67.724609375
Expert2 balance top: 86.572265625

New cuda time: 1.7942479848861694
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843290567398071
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1539.092529296875, gpu time: 350.4132899045944
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 176
Expert2 unused count: 179
Expert1 balance top: 70.361328125
Expert2 balance top: 77.83203125

New cuda time: 1.7980890274047852
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7705680131912231
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1017.503173828125, gpu time: 283.3558704853058
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.78125
Expert1 unused count: 160
Expert2 unused count: 195
Expert1 balance top: 70.654296875
Expert2 balance top: 75.634765625

New cuda time: 1.719048023223877
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7766480445861816
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1661.912353515625, gpu time: 352.6360192298889
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 7.421875
Expert1 unused count: 129
Expert2 unused count: 275
Expert1 balance top: 72.75390625
Expert2 balance top: 90.869140625

New cuda time: 1.8118480443954468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786087989807129
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2357.5146484375, gpu time: 373.8450776338577
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.392578125
Expert2 overflow: 3.955078125
Expert1 unused count: 149
Expert2 unused count: 304
Expert1 balance top: 73.681640625
Expert2 balance top: 93.5546875

New cuda time: 1.7955290079116821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7854479551315308
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1562.469482421875, gpu time: 399.7359229326248
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.587890625
Expert1 unused count: 148
Expert2 unused count: 281
Expert1 balance top: 73.095703125
Expert2 balance top: 91.162109375

New cuda time: 1.8056089878082275
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9433690309524536
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1353.339599609375, gpu time: 284.74179196357727
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.318359375
Expert1 unused count: 158
Expert2 unused count: 259
Expert1 balance top: 74.169921875
Expert2 balance top: 88.525390625

New cuda time: 1.779528021812439
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7926490306854248
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1549.76611328125, gpu time: 353.9854669570923
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 0.732421875
Expert1 unused count: 171
Expert2 unused count: 222
Expert1 balance top: 75.244140625
Expert2 balance top: 84.27734375

New cuda time: 1.9049689769744873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8017679452896118
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1034.001953125, gpu time: 287.0626074075699
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 166
Expert2 unused count: 204
Expert1 balance top: 74.853515625
Expert2 balance top: 79.052734375

New cuda time: 1.809928059577942
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960079908370972
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1671.29150390625, gpu time: 356.24195528030396
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.376953125
Expert1 unused count: 163
Expert2 unused count: 263
Expert1 balance top: 72.16796875
Expert2 balance top: 88.37890625

New cuda time: 1.814247965812683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9492889642715454
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2373.3671875, gpu time: 377.60861563682556
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 9.423828125
Expert1 unused count: 169
Expert2 unused count: 277
Expert1 balance top: 76.85546875
Expert2 balance top: 91.015625

New cuda time: 1.7976089715957642
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7849689722061157
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1571.8125, gpu time: 403.3185008764267
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 4.58984375
Expert1 unused count: 179
Expert2 unused count: 288
Expert1 balance top: 75.830078125
Expert2 balance top: 90.625

New cuda time: 1.8195279836654663
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990490198135376
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1362.626220703125, gpu time: 288.3603689670563
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 2.9296875
Expert1 unused count: 194
Expert2 unused count: 267
Expert1 balance top: 77.9296875
Expert2 balance top: 89.0625

New cuda time: 1.967208981513977
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8001680374145508
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1561.64501953125, gpu time: 357.7528439760208
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 208
Expert2 unused count: 249
Expert1 balance top: 78.125
Expert2 balance top: 85.9375

New cuda time: 1.8081680536270142
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9808100461959839
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1048.7099609375, gpu time: 290.8515864610672
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 1.123046875
Expert1 unused count: 221
Expert2 unused count: 247
Expert1 balance top: 79.296875
Expert2 balance top: 81.73828125

New cuda time: 1.7964880466461182
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7883280515670776
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1680.156494140625, gpu time: 359.82677137851715
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.24609375
Expert1 unused count: 126
Expert2 unused count: 268
Expert1 balance top: 68.896484375
Expert2 balance top: 89.0625

New cuda time: 1.8108880519866943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.777448058128357
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2382.8369140625, gpu time: 381.1969517469406
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.44140625
Expert2 overflow: 5.2734375
Expert1 unused count: 146
Expert2 unused count: 295
Expert1 balance top: 70.263671875
Expert2 balance top: 92.7734375

New cuda time: 1.8108890056610107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9603290557861328
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1584.543701171875, gpu time: 407.08971893787384
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.537109375
Expert2 overflow: 3.955078125
Expert1 unused count: 142
Expert2 unused count: 278
Expert1 balance top: 70.068359375
Expert2 balance top: 90.72265625

New cuda time: 1.7932889461517334
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7726479768753052
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1371.4365234375, gpu time: 291.9263058900833
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 158
Expert2 unused count: 255
Expert1 balance top: 71.484375
Expert2 balance top: 87.939453125

4.689457893371582
New cuda time: 1.771366000175476
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7764860391616821
New cuda time: 1.7739269733428955
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920069694519043
New cuda time: 1.7900869846343994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7980870008468628
New cuda time: 1.7584069967269897
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.965127944946289
New cuda time: 1.7788870334625244
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8011269569396973
New cuda time: 1.782086968421936
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7952070236206055
New cuda time: 1.7852870225906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7974469661712646
New cuda time: 1.7900869846343994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8987270593643188
New cuda time: 1.9763269424438477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888070344924927
New cuda time: 1.958888053894043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832070589065552
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827270030975342
New cuda time: 1.8030459880828857
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9534469842910767
New cuda time: 1.7918460369110107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.768805980682373
New cuda time: 1.7808070182800293
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924870252609253
New cuda time: 1.7865660190582275
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8044869899749756
New cuda time: 1.777446985244751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884869575500488
New cuda time: 1.7811269760131836
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9515279531478882
New cuda time: 1.7809669971466064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794245958328247
New cuda time: 1.7822469472885132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913670539855957
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960070371627808
New cuda time: 1.7828869819641113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9905669689178467
New cuda time: 1.7740869522094727
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7985670566558838
New cuda time: 1.777446985244751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9393680095672607
New cuda time: 3.94673490524292
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892869710922241
New cuda time: 1.7816070318222046
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9507280588150024
New cuda time: 1.7673660516738892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7884869575500488
New cuda time: 1.7928069829940796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918469905853271
New cuda time: 1.7742470502853394
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7945669889450073
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779526948928833
New cuda time: 8.416671752929688
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789607048034668
New cuda time: 1.7808070182800293
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7814470529556274
New cuda time: 1.7766469717025757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902469635009766
New cuda time: 1.7848069667816162
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7803269624710083
New cuda time: 1.7955269813537598
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9600080251693726
New cuda time: 1.7747269868850708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79168701171875
New cuda time: 1.7827270030975342
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7881660461425781
New cuda time: 1.7856069803237915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798887014389038
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.959553718566895
New cuda time: 1.7648049592971802
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7715270519256592
New cuda time: 1.786726951599121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7787259817123413
New cuda time: 1.7876859903335571
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8006470203399658
New cuda time: 1.7852870225906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7864069938659668
New cuda time: 6.020183086395264
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796807050704956
New cuda time: 1.768807053565979
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904069423675537
New cuda time: 1.7747269868850708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794247031211853
New cuda time: 1.7758469581604004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7864069938659668
New cuda time: 1.7668869495391846
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9372869729995728
New cuda time: 1.7830469608306885
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929669618606567
New cuda time: 1.772807002067566
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7822469472885132
New cuda time: 1.7827260494232178
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7830469608306885
New cuda time: 1.7918469905853271
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.145955085754395
New cuda time: 1.7715270519256592
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9592070579528809
New cuda time: 1.773447036743164
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7787270545959473
New cuda time: 1.7742459774017334
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873669862747192
New cuda time: 1.7785660028457642
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7819260358810425
New cuda time: 1.770885944366455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792646050453186
New cuda time: 5.96194314956665
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843270301818848
New cuda time: 1.7844860553741455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7787270545959473
New cuda time: 1.7804869413375854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786726951599121
New cuda time: 1.7787270545959473
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0958480834960938
New cuda time: 1.7857660055160522
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7745660543441772
New cuda time: 9.00611400604248
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7819269895553589
New cuda time: 1.7908869981765747
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915270328521729
New cuda time: 1.7782469987869263
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.949607014656067
New cuda time: 1.7881669998168945
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.829287052154541
New cuda time: 1.7787270545959473
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796167016029358
New cuda time: 1.9630470275878906
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880070209503174
New cuda time: 1.7897659540176392
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9571280479431152
New cuda time: 1.7694469690322876
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9102469682693481
New cuda time: 1.7761670351028442
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794247031211853
New cuda time: 1.7838469743728638
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9620879888534546
New cuda time: 1.7809669971466064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892869710922241
New cuda time: 1.9345680475234985
torch.Size([4, 128, 103, 768]) 1.9735920429229736
New cuda time: 1.77327299118042
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8259129524230957
New cuda time: 1.7606329917907715
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8172730207443237
New cuda time: 1.7897529602050781
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8275129795074463
New cuda time: 1.7828730344772339
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9695919752120972
New cuda time: 1.755033016204834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8151930570602417
New cuda time: 1.7729530334472656
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8259129524230957
New cuda time: 1.752632975578308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8249529600143433
New cuda time: 1.7683130502700806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 12.274513244628906
New cuda time: 1.9508730173110962
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7854340076446533
New cuda time: 1.9425519704818726
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8219130039215088
New cuda time: 1.767833948135376
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.938392996788025
New cuda time: 1.7878329753875732
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.934393048286438
New cuda time: 1.7715129852294922
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.952793002128601
New cuda time: 1.750393033027649
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9243119955062866
New cuda time: 1.7539130449295044
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787192940711975
New cuda time: 1.7607929706573486
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7798329591751099
New cuda time: 1.7575939893722534
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.964792013168335
New cuda time: 1.7761529684066772
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8279930353164673
New cuda time: 1.7689529657363892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.778393030166626
New cuda time: 1.7563129663467407
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8284729719161987
New cuda time: 1.763672947883606
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.811993956565857
New cuda time: 1.7699129581451416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.815032958984375
New cuda time: 1.768314003944397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9500720500946045
New cuda time: 3.977905035018921
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8299130201339722
New cuda time: 1.7819130420684814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9809520244598389
New cuda time: 1.7772730588912964
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.934393048286438
New cuda time: 1.7686330080032349
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8095929622650146
New cuda time: 1.7563129663467407
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.81967294216156
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8091130256652832
New cuda time: 1.9031929969787598
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8247929811477661
New cuda time: 1.773434042930603
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8315130472183228
New cuda time: 1.7705529928207397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8214329481124878
New cuda time: 1.762073040008545
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7811139822006226
New cuda time: 1.7788729667663574
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9614330530166626
New cuda time: 1.7782330513000488
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8075129985809326
New cuda time: 1.7652729749679565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8177529573440552
New cuda time: 1.764633059501648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819512963294983
New cuda time: 1.7724729776382446
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.94412612915039
New cuda time: 1.7679929733276367
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785114049911499
New cuda time: 1.7627129554748535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8164730072021484
New cuda time: 1.7763129472732544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794232964515686
New cuda time: 1.759672999382019
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7822329998016357
New cuda time: 1.722072958946228
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955130338668823
New cuda time: 1.7705529928207397
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7956730127334595
New cuda time: 1.784952998161316
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8031929731369019
New cuda time: 1.7579129934310913
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.773753046989441
New cuda time: 1.775352954864502
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9545530080795288
New cuda time: 1.7670329809188843
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8223929405212402
New cuda time: 1.76671302318573
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7780729532241821
New cuda time: 1.7811130285263062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8255929946899414
New cuda time: 1.7695930004119873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.24588394165039
New cuda time: 1.7723139524459839
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9519920349121094
New cuda time: 1.770872950553894
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.808953046798706
New cuda time: 1.780953049659729
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.803352952003479
New cuda time: 1.7684730291366577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897529602050781
New cuda time: 1.7705539464950562
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8198330402374268
New cuda time: 5.9697370529174805
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8243130445480347
New cuda time: 1.752632975578308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8183929920196533
New cuda time: 1.7694330215454102
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8182330131530762
New cuda time: 1.7646340131759644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.961272954940796
New cuda time: 1.7775930166244507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8260730504989624
New cuda time: 8.992925643920898
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787513017654419
New cuda time: 1.770712971687317
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7959929704666138
New cuda time: 1.7695930004119873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9697530269622803
New cuda time: 1.7595139741897583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891130447387695
New cuda time: 1.7606329917907715
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873530387878418
New cuda time: 1.939031958580017
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873530387878418
New cuda time: 1.7462329864501953
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8233530521392822
New cuda time: 1.7606329917907715
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8023929595947266
New cuda time: 1.7713539600372314
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8167929649353027
New cuda time: 1.7612730264663696
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9401520490646362
New cuda time: 1.7676739692687988
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940729856491089
New cuda time: 1.813433051109314
torch.Size([4, 128, 103, 768]) torch.float16
4.704960823059082
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 1.7822400331497192
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785599946975708
New cuda time: 1.7664010524749756
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.778880000114441
New cuda time: 1.7817599773406982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9555200338363647
New cuda time: 1.7868800163269043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7932809591293335
New cuda time: 1.7655999660491943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7824000120162964
New cuda time: 1.7830400466918945
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7985600233078003
New cuda time: 1.7697609663009644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9048000574111938
New cuda time: 1.9728009700775146
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.811521053314209
New cuda time: 1.9592000246047974
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8060799837112427
New cuda time: 1.7883199453353882
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7915199995040894
New cuda time: 1.769279956817627
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.97360098361969
New cuda time: 1.7921600341796875
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857600450515747
New cuda time: 1.7776000499725342
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7864010334014893
New cuda time: 1.783519983291626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843199968338013
New cuda time: 1.7888000011444092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7776010036468506
New cuda time: 1.7838399410247803
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9486409425735474
New cuda time: 1.7849600315093994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806400060653687
New cuda time: 1.7843209505081177
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7910399436950684
New cuda time: 1.781599998474121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7801610231399536
New cuda time: 1.7715200185775757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0014400482177734
New cuda time: 1.7776010036468506
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8001600503921509
New cuda time: 1.7788809537887573
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969920039176941
New cuda time: 3.9911999702453613
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8012800216674805
New cuda time: 1.7675199508666992
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9617609977722168
New cuda time: 1.7777600288391113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7776000499725342
New cuda time: 1.7731200456619263
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804479956626892
New cuda time: 1.7739200592041016
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7988799810409546
New cuda time: 1.788640022277832
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.797760009765625
New cuda time: 8.417441368103027
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867209911346436
New cuda time: 1.774880051612854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7968000173568726
New cuda time: 1.7846399545669556
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8038409948349
New cuda time: 1.7784010171890259
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924799919128418
New cuda time: 1.7636799812316895
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.943200945854187
New cuda time: 1.7681599855422974
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950400114059448
New cuda time: 1.790719985961914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7787200212478638
New cuda time: 1.7684799432754517
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801759958267212
New cuda time: 1.781599998474121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.994721412658691
New cuda time: 1.77839994430542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7921600341796875
New cuda time: 1.7657610177993774
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7776000499725342
New cuda time: 1.7711999416351318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841600179672241
New cuda time: 1.785599946975708
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790241003036499
New cuda time: 6.014400959014893
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8316810131072998
New cuda time: 1.7705600261688232
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.80239999294281
New cuda time: 1.7867209911346436
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867200374603271
New cuda time: 1.7844799757003784
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894400358200073
New cuda time: 1.7724800109863281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9451199769973755
New cuda time: 1.7950409650802612
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873599529266357
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.807360053062439
New cuda time: 1.767199993133545
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894400358200073
New cuda time: 1.78656005859375
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.15088176727295
New cuda time: 1.7569600343704224
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8777610063552856
New cuda time: 1.7819199562072754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8163210153579712
New cuda time: 1.7742400169372559
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.825119972229004
New cuda time: 1.776960015296936
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8104000091552734
New cuda time: 1.7719999551773071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7942399978637695
New cuda time: 5.979841232299805
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940809726715088
New cuda time: 1.783519983291626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7896000146865845
New cuda time: 1.7705600261688232
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79312002658844
New cuda time: 1.7792010307312012
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.1185600757598877
New cuda time: 1.7742409706115723
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.809440016746521
New cuda time: 8.987041473388672
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790719985961914
New cuda time: 1.7700799703598022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7996809482574463
New cuda time: 1.776319980621338
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9566409587860107
New cuda time: 1.7812800407409668
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7817599773406982
New cuda time: 1.7899199724197388
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857600450515747
New cuda time: 1.955680012702942
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.813439965248108
New cuda time: 1.7935999631881714
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9582409858703613
New cuda time: 1.778880000114441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9201600551605225
New cuda time: 1.7844810485839844
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848000526428223
New cuda time: 1.7825599908828735
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.964959979057312
New cuda time: 1.7752000093460083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7896000146865845
New cuda time: 1.9379199743270874
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969609022140503
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786728024482727
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1575.8876953125, gpu time: 361.50918102264404
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 166
Expert2 unused count: 220
Expert1 balance top: 71.630859375
Expert2 balance top: 83.349609375

New cuda time: 1.772968053817749
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891279458999634
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1058.320556640625, gpu time: 294.41368341445923
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 184
Expert2 unused count: 229
Expert1 balance top: 75.78125
Expert2 balance top: 78.271484375

New cuda time: 1.7918479442596436
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976089715957642
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1689.690185546875, gpu time: 363.41622829437256
2024-07-11 01:41:58 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.251953125
Expert1 unused count: 185
Expert2 unused count: 296
Expert1 balance top: 76.904296875
Expert2 balance top: 92.48046875

New cuda time: 1.8132879734039307
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8220889568328857
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2393.86376953125, gpu time: 384.83232867717743
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 1.171875
Expert1 unused count: 206
Expert2 unused count: 298
Expert1 balance top: 80.126953125
Expert2 balance top: 91.89453125

New cuda time: 1.9283289909362793
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9537689685821533
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1601.021240234375, gpu time: 410.9718168973923
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 3.125
Expert1 unused count: 216
Expert2 unused count: 304
Expert1 balance top: 79.150390625
Expert2 balance top: 92.236328125

New cuda time: 1.798248052597046
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889679670333862
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1380.57861328125, gpu time: 295.51352286338806
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.076171875
Expert2 overflow: 0.68359375
Expert1 unused count: 224
Expert2 unused count: 281
Expert1 balance top: 82.51953125
Expert2 balance top: 89.697265625

New cuda time: 1.7985689640045166
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7860889434814453
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1584.85595703125, gpu time: 365.09383893013
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.48828125
Expert1 unused count: 242
Expert2 unused count: 276
Expert1 balance top: 82.958984375
Expert2 balance top: 89.0625

New cuda time: 1.8150490522384644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7923280000686646
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1067.197021484375, gpu time: 298.02105939388275
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.736328125
Expert2 overflow: 4.1015625
Expert1 unused count: 244
Expert2 unused count: 273
Expert1 balance top: 83.88671875
Expert2 balance top: 85.546875

New cuda time: 1.9552090167999268
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9556900262832642
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1711.43359375, gpu time: 367.32712733745575
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.466796875
Expert2 overflow: 10.302734375
Expert1 unused count: 190
Expert2 unused count: 314
Expert1 balance top: 80.419921875
Expert2 balance top: 94.23828125

New cuda time: 1.7980870008468628
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784168004989624
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2403.297607421875, gpu time: 388.4145836830139
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 3.271484375
Expert1 unused count: 170
Expert2 unused count: 315
Expert1 balance top: 80.17578125
Expert2 balance top: 93.994140625

New cuda time: 1.812168002128601
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7971279621124268
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1610.0625, gpu time: 414.5811128616333
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.0546875
Expert2 overflow: 0.537109375
Expert1 unused count: 161
Expert2 unused count: 303
Expert1 balance top: 78.955078125
Expert2 balance top: 92.67578125

New cuda time: 1.8164889812469482
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7705680131912231
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1389.556884765625, gpu time: 299.10057985782623
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.05078125
Expert2 overflow: 1.318359375
Expert1 unused count: 179
Expert2 unused count: 280
Expert1 balance top: 80.76171875
Expert2 balance top: 90.185546875

New cuda time: 1.81584894657135
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8001689910888672
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1593.76513671875, gpu time: 368.7098568677902
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 175
Expert2 unused count: 262
Expert1 balance top: 77.44140625
Expert2 balance top: 87.6953125

New cuda time: 1.7390480041503906
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782088041305542
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1086.052978515625, gpu time: 301.5421954393387
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 2.392578125
Expert1 unused count: 182
Expert2 unused count: 233
Expert1 balance top: 79.296875
Expert2 balance top: 83.10546875

New cuda time: 1.8089690208435059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783687949180603
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1720.12451171875, gpu time: 370.91978323459625
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 6.396484375
Expert1 unused count: 175
Expert2 unused count: 290
Expert1 balance top: 76.46484375
Expert2 balance top: 91.796875

New cuda time: 1.8030489683151245
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7800079584121704
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2412.581787109375, gpu time: 391.9976406097412
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.515625
Expert2 overflow: 2.63671875
Expert1 unused count: 205
Expert2 unused count: 307
Expert1 balance top: 80.6640625
Expert2 balance top: 93.359375

New cuda time: 1.8059289455413818
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784168004989624
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1620.064697265625, gpu time: 418.17120885849
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.689453125
Expert1 unused count: 190
Expert2 unused count: 302
Expert1 balance top: 79.541015625
Expert2 balance top: 92.28515625

New cuda time: 2.0417699813842773
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.108838081359863
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1411.648681640625, gpu time: 309.2511879205704
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 2.880859375
Expert1 unused count: 207
Expert2 unused count: 276
Expert1 balance top: 79.541015625
Expert2 balance top: 89.306640625

New cuda time: 1.802888035774231
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780168056488037
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1603.0341796875, gpu time: 372.2929139137268
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 220
Expert2 unused count: 257
Expert1 balance top: 79.248046875
Expert2 balance top: 87.255859375

New cuda time: 1.8172880411148071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8184080123901367
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1094.892333984375, gpu time: 305.1778914928436
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 2.392578125
Expert1 unused count: 236
Expert2 unused count: 248
Expert1 balance top: 82.2265625
Expert2 balance top: 82.421875

New cuda time: 1.8089679479599
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788807988166809
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1729.583984375, gpu time: 374.51755917072296
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 12.20703125
Expert1 unused count: 246
Expert2 unused count: 317
Expert1 balance top: 83.349609375
Expert2 balance top: 94.04296875

New cuda time: 1.7942490577697754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7814489603042603
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2425.376953125, gpu time: 395.57333862781525
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.904296875
Expert2 overflow: 4.736328125
Expert1 unused count: 254
Expert2 unused count: 337
Expert1 balance top: 85.546875
Expert2 balance top: 94.921875

New cuda time: 1.7955280542373657
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8430490493774414
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1632.261474609375, gpu time: 421.8097869157791
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 1.025390625
Expert1 unused count: 262
Expert2 unused count: 327
Expert1 balance top: 85.791015625
Expert2 balance top: 94.775390625

New cuda time: 1.9510489702224731
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7753679752349854
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1426.190185546875, gpu time: 312.97760486602783
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.171875
Expert2 overflow: 0.29296875
Expert1 unused count: 290
Expert2 unused count: 329
Expert1 balance top: 88.671875
Expert2 balance top: 94.580078125

New cuda time: 1.8000080585479736
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786728024482727
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1612.01171875, gpu time: 375.8796499967575
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 2.685546875
Expert1 unused count: 289
Expert2 unused count: 306
Expert1 balance top: 88.671875
Expert2 balance top: 90.966796875

New cuda time: 1.802409052848816
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7800079584121704
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1107.244873046875, gpu time: 308.7603085041046
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 7.71484375
Expert1 unused count: 312
Expert2 unused count: 314
Expert1 balance top: 91.2109375
Expert2 balance top: 90.33203125

New cuda time: 1.8139289617538452
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7878479957580566
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1738.453857421875, gpu time: 378.11933612823486
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 3.173828125
Expert1 unused count: 148
Expert2 unused count: 281
Expert1 balance top: 70.458984375
Expert2 balance top: 91.2109375

New cuda time: 1.8124890327453613
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8267279863357544
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2435.507568359375, gpu time: 399.21255564689636
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 3.3203125
Expert1 unused count: 173
Expert2 unused count: 266
Expert1 balance top: 77.734375
Expert2 balance top: 89.2578125

New cuda time: 1.8048089742660522
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891290187835693
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1641.206787109375, gpu time: 425.40372490882874
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 179
Expert2 unused count: 274
Expert1 balance top: 75.537109375
Expert2 balance top: 90.478515625

New cuda time: 1.810088038444519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.956009030342102
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1441.8603515625, gpu time: 316.74370193481445
2024-07-11 01:41:59 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 1.416015625
Expert1 unused count: 197
Expert2 unused count: 261
Expert1 balance top: 79.6875
Expert2 balance top: 87.939453125

New cuda time: 1.7974480390548706
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7912089824676514
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1621.698486328125, gpu time: 379.46830701828003
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.416015625
Expert1 unused count: 211
Expert2 unused count: 240
Expert1 balance top: 79.443359375
Expert2 balance top: 83.056640625

New cuda time: 1.8033679723739624
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7766480445861816
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1116.602783203125, gpu time: 312.34032452106476
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.19921875
Expert2 overflow: 4.443359375
Expert1 unused count: 219
Expert2 unused count: 229
Expert1 balance top: 81.787109375
Expert2 balance top: 79.638671875

New cuda time: 1.9732890129089355
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7808079719543457
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1753.446044921875, gpu time: 381.87343406677246
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.41796875
Expert1 unused count: 168
Expert2 unused count: 282
Expert1 balance top: 72.509765625
Expert2 balance top: 90.625

New cuda time: 1.8073689937591553
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9632090330123901
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2452.188720703125, gpu time: 402.9831336736679
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.001953125
Expert1 unused count: 185
Expert2 unused count: 294
Expert1 balance top: 75.927734375
Expert2 balance top: 90.8203125

New cuda time: 1.7968080043792725
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.813768982887268
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1650.017822265625, gpu time: 429.0143028497696
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 3.466796875
Expert1 unused count: 179
Expert2 unused count: 297
Expert1 balance top: 74.853515625
Expert2 balance top: 91.69921875

New cuda time: 1.8104079961776733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7782479524612427
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1451.370361328125, gpu time: 320.33235788345337
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.587890625
Expert2 overflow: 0.927734375
Expert1 unused count: 216
Expert2 unused count: 287
Expert1 balance top: 80.126953125
Expert2 balance top: 90.576171875

New cuda time: 1.799528956413269
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.93264901638031
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1637.111328125, gpu time: 383.2004849910736
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 212
Expert2 unused count: 272
Expert1 balance top: 78.7109375
Expert2 balance top: 88.57421875

New cuda time: 1.938730001449585
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8937690258026123
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1131.266357421875, gpu time: 316.17282354831696
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.4921875
Expert2 overflow: 3.662109375
Expert1 unused count: 231
Expert2 unused count: 261
Expert1 balance top: 80.56640625
Expert2 balance top: 82.2265625

New cuda time: 1.9571290016174316
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7897679805755615
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1768.6591796875, gpu time: 385.62033104896545
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.322265625
Expert1 unused count: 203
Expert2 unused count: 284
Expert1 balance top: 78.857421875
Expert2 balance top: 90.33203125

New cuda time: 1.8179290294647217
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8012880086898804
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2461.487548828125, gpu time: 406.6023507118225
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.07421875
Expert1 unused count: 218
Expert2 unused count: 311
Expert1 balance top: 78.41796875
Expert2 balance top: 91.748046875

New cuda time: 1.8008090257644653
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7728079557418823
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1659.42431640625, gpu time: 432.58791983127594
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.564453125
Expert1 unused count: 233
Expert2 unused count: 306
Expert1 balance top: 83.544921875
Expert2 balance top: 91.9921875

New cuda time: 1.8048089742660522
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.82368803024292
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1461.28173828125, gpu time: 323.960853934288
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 6.8359375
Expert1 unused count: 257
Expert2 unused count: 293
Expert1 balance top: 84.423828125
Expert2 balance top: 91.064453125

New cuda time: 1.9603300094604492
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8041690587997437
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1649.94482421875, gpu time: 386.9649840593338
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 0.9765625
Expert1 unused count: 256
Expert2 unused count: 286
Expert1 balance top: 85.15625
Expert2 balance top: 89.990234375

New cuda time: 1.8104089498519897
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786087989807129
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1142.246337890625, gpu time: 319.7693204879761
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.76171875
Expert2 overflow: 5.37109375
Expert1 unused count: 263
Expert2 unused count: 280
Expert1 balance top: 86.962890625
Expert2 balance top: 85.107421875

New cuda time: 1.802567958831787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8174489736557007
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1777.3447265625, gpu time: 389.24034798145294
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 9.5703125
Expert1 unused count: 184
Expert2 unused count: 290
Expert1 balance top: 74.560546875
Expert2 balance top: 92.529296875

New cuda time: 1.8089690208435059
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822888970375061
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2470.217041015625, gpu time: 410.23420763015747
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.318359375
Expert2 overflow: 3.125
Expert1 unused count: 184
Expert2 unused count: 287
Expert1 balance top: 76.025390625
Expert2 balance top: 90.966796875

New cuda time: 2.053450107574463
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876880168914795
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1684.780517578125, gpu time: 436.4290579557419
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.29296875
Expert1 unused count: 190
Expert2 unused count: 291
Expert1 balance top: 74.609375
Expert2 balance top: 91.40625

New cuda time: 1.7716879844665527
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7852879762649536
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1471.216552734375, gpu time: 327.51782989501953
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.443359375
Expert2 overflow: 1.708984375
Expert1 unused count: 193
Expert2 unused count: 272
Expert1 balance top: 75.244140625
Expert2 balance top: 87.6953125

New cuda time: 1.8124879598617554
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779049038887024
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1659.680419921875, gpu time: 390.5565210580826
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.220703125
Expert1 unused count: 213
Expert2 unused count: 252
Expert1 balance top: 78.22265625
Expert2 balance top: 87.255859375

New cuda time: 1.8156880140304565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8016079664230347
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1151.748291015625, gpu time: 323.38661646842957
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 3.466796875
Expert1 unused count: 218
Expert2 unused count: 250
Expert1 balance top: 79.541015625
Expert2 balance top: 84.130859375

New cuda time: 1.80656898021698
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9406490325927734
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1792.57958984375, gpu time: 392.9875659942627
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.64453125
Expert1 unused count: 205
Expert2 unused count: 299
Expert1 balance top: 77.83203125
Expert2 balance top: 92.96875

New cuda time: 1.9592089653015137
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786247968673706
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2485.848876953125, gpu time: 413.9796645641327
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.390625
Expert2 overflow: 4.345703125
Expert1 unused count: 210
Expert2 unused count: 294
Expert1 balance top: 79.150390625
Expert2 balance top: 91.552734375

New cuda time: 1.8040080070495605
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798248052597046
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1693.94970703125, gpu time: 440.0313140153885
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 218
Expert2 unused count: 306
Expert1 balance top: 77.9296875
Expert2 balance top: 91.30859375

New cuda time: 1.8062490224838257
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7937690019607544
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1480.517578125, gpu time: 331.1178479194641
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 0.830078125
Expert1 unused count: 233
Expert2 unused count: 306
Expert1 balance top: 82.51953125
Expert2 balance top: 91.357421875

New cuda time: 1.7662479877471924
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9553680419921875
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1676.323974609375, gpu time: 394.27813708782196
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.634765625
Expert1 unused count: 244
Expert2 unused count: 285
Expert1 balance top: 81.884765625
Expert2 balance top: 91.064453125

New cuda time: 1.8148889541625977
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8140889406204224
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1160.534423828125, gpu time: 327.0155943632126
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 3.02734375
Expert1 unused count: 244
Expert2 unused count: 268
Expert1 balance top: 83.056640625
Expert2 balance top: 84.86328125

New cuda time: 1.8056080341339111
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7822480201721191
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1801.71533203125, gpu time: 396.5754220485687
2024-07-11 01:42:00 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.15234375
Expert2 overflow: 19.775390625
Expert1 unused count: 394
Expert2 unused count: 399
Expert1 balance top: 99.267578125
Expert2 balance top: 99.51171875

New cuda time: 1.7852879762649536
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78656804561615
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2495.190673828125, gpu time: 417.5515205860138
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.6875
Expert2 overflow: 16.2109375
Expert1 unused count: 396
Expert2 unused count: 393
Expert1 balance top: 99.365234375
Expert2 balance top: 99.21875

New cuda time: 1.8217689990997314
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8051279783248901
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1702.85986328125, gpu time: 443.6582100391388
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.564453125
Expert2 overflow: 13.37890625
Expert1 unused count: 382
Expert2 unused count: 370
Expert1 balance top: 98.681640625
Expert2 balance top: 98.095703125

New cuda time: 1.9798489809036255
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880079746246338
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1495.38037109375, gpu time: 334.88570487499237
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.130859375
Expert2 overflow: 5.908203125
Expert1 unused count: 383
Expert2 unused count: 379
Expert1 balance top: 98.73046875
Expert2 balance top: 98.2421875

New cuda time: 7.833957195281982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777680158615112
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1691.618408203125, gpu time: 403.88986229896545
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.9609375
Expert2 overflow: 8.88671875
Expert1 unused count: 392
Expert2 unused count: 385
Expert1 balance top: 99.169921875
Expert2 balance top: 98.828125

New cuda time: 1.8176079988479614
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.776968002319336
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1169.87451171875, gpu time: 330.6101703643799
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.935546875
Expert2 overflow: 14.84375
Expert1 unused count: 384
Expert2 unused count: 366
Expert1 balance top: 98.779296875
Expert2 balance top: 97.55859375

New cuda time: 1.7828890085220337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7747279405593872
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1810.6123046875, gpu time: 400.13303804397583
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.369140625
Expert1 unused count: 86
Expert2 unused count: 241
Expert1 balance top: 58.740234375
Expert2 balance top: 87.451171875

New cuda time: 8.718441009521484
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788167953491211
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2512.472412109375, gpu time: 428.0581295490265
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.02734375
Expert1 unused count: 96
Expert2 unused count: 275
Expert1 balance top: 62.40234375
Expert2 balance top: 90.869140625

New cuda time: 1.8027280569076538
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7792079448699951
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1712.85888671875, gpu time: 447.24014699459076
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 116
Expert2 unused count: 245
Expert1 balance top: 63.232421875
Expert2 balance top: 86.962890625

New cuda time: 1.9707289934158325
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7964880466461182
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1508.875732421875, gpu time: 338.6529219150543
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.732421875
Expert1 unused count: 111
Expert2 unused count: 225
Expert1 balance top: 63.8671875
Expert2 balance top: 84.5703125

New cuda time: 1.7956880331039429
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7920080423355103
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1700.75390625, gpu time: 407.4775583744049
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 119
Expert2 unused count: 192
Expert1 balance top: 66.748046875
Expert2 balance top: 77.685546875

New cuda time: 1.8153690099716187
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9470490217208862
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1183.92919921875, gpu time: 334.3725883960724
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.66015625
Expert1 unused count: 143
Expert2 unused count: 163
Expert1 balance top: 72.0703125
Expert2 balance top: 69.921875

New cuda time: 1.8108890056610107
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976080179214478
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1819.802978515625, gpu time: 403.741534113884
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.708984375
Expert1 unused count: 76
Expert2 unused count: 266
Expert1 balance top: 61.865234375
Expert2 balance top: 88.8671875

New cuda time: 1.8016090393066406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9771289825439453
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2527.488037109375, gpu time: 431.8368675708771
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.103515625
Expert1 unused count: 89
Expert2 unused count: 275
Expert1 balance top: 63.037109375
Expert2 balance top: 91.2109375

New cuda time: 1.8067289590835571
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889679670333862
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1722.26953125, gpu time: 450.8358439207077
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.37109375
Expert1 unused count: 87
Expert2 unused count: 255
Expert1 balance top: 62.40234375
Expert2 balance top: 88.28125

New cuda time: 1.7811280488967896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9592100381851196
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1524.974365234375, gpu time: 342.39326000213623
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 93
Expert2 unused count: 226
Expert1 balance top: 64.697265625
Expert2 balance top: 86.5234375

New cuda time: 1.7676880359649658
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7825679779052734
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1710.557373046875, gpu time: 411.02781438827515
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 89
Expert2 unused count: 208
Expert1 balance top: 62.255859375
Expert2 balance top: 81.005859375

torch.float16
New cuda time: 1.8316869735717773
New cuda time: 1.7824070453643799
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7705670595169067
New cuda time: 1.7838469743728638
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7886470556259155
New cuda time: 1.7849669456481934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8043270111083984
New cuda time: 1.9350470304489136
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9448070526123047
New cuda time: 1.7875269651412964
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873669862747192
New cuda time: 1.7787270545959473
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8460869789123535
New cuda time: 1.7920069694519043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.773287057876587
New cuda time: 1.9625669717788696
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9337669610977173
New cuda time: 1.7742459774017334
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7899270057678223
New cuda time: 1.7811269760131836
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8081669807434082
New cuda time: 1.787047028541565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794247031211853
New cuda time: 1.7744059562683105
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7953670024871826
New cuda time: 6.3976240158081055
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787045955657959
New cuda time: 1.7758469581604004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.794247031211853
New cuda time: 1.7806470394134521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.797126054763794
New cuda time: 1.7782469987869263
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8172869682312012
New cuda time: 8.395552635192871
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.141151428222656
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976069450378418
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7923270463943481
New cuda time: 1.933927059173584
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7948869466781616
New cuda time: 1.7856069803237915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7883269786834717
New cuda time: 1.7747260332107544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9531279802322388
New cuda time: 1.9504079818725586
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8811269998550415
New cuda time: 1.7731260061264038
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.808007001876831
New cuda time: 1.7830469608306885
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7969670295715332
New cuda time: 1.7918469905853271
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.836487054824829
New cuda time: 1.784487009048462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8017669916152954
New cuda time: 1.7718470096588135
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.771366000175476
New cuda time: 1.7827260494232178
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9641679525375366
New cuda time: 1.787047028541565
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859270572662354
New cuda time: 1.7924859523773193
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7878459692001343
New cuda time: 1.9532870054244995
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.802886962890625
New cuda time: 1.7932870388031006
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9500880241394043
New cuda time: 1.7846460342407227
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7798470258712769
New cuda time: 1.7740869522094727
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7992069721221924
New cuda time: 1.7888070344924927
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.302592277526855
New cuda time: 1.9486470222473145
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7836869955062866
New cuda time: 1.9414479732513428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806470394134521
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777669429779053
New cuda time: 1.7716870307922363
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786726951599121
New cuda time: 1.7740869522094727
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939260005950928
New cuda time: 1.9441670179367065
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7860870361328125
New cuda time: 1.7835270166397095
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8032070398330688
New cuda time: 1.7694469690322876
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7876869440078735
New cuda time: 1.7769670486450195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7995270490646362
New cuda time: 9.047554969787598
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904069423675537
New cuda time: 1.7894469499588013
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7856069803237915
New cuda time: 1.7764869928359985
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7944070100784302
New cuda time: 1.7849669456481934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8024070262908936
New cuda time: 1.7792069911956787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0673680305480957
New cuda time: 1.9118469953536987
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8004870414733887
New cuda time: 1.7768069505691528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7788859605789185
New cuda time: 1.7748860120773315
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785669565200806
New cuda time: 1.7745660543441772
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9524869918823242
New cuda time: 1.7899270057678223
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8011269569396973
New cuda time: 1.7894469499588013
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7908860445022583
New cuda time: 1.7928069829940796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8065669536590576
New cuda time: 1.7852870225906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796870470046997
New cuda time: 1.9443279504776
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7908869981765747
New cuda time: 7.800509929656982
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841670513153076
New cuda time: 1.7862470149993896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904059886932373
New cuda time: 1.775367021560669
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862470149993896
New cuda time: 8.87187385559082
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796807050704956
New cuda time: 1.7768059968948364
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7924870252609253
New cuda time: 1.9424070119857788
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7891260385513306
New cuda time: 1.7788859605789185
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7803269624710083
New cuda time: 1.7755260467529297
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9385679960250854
New cuda time: 1.7739269733428955
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7854470014572144
New cuda time: 1.7752059698104858
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9644869565963745
New cuda time: 1.767846941947937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784646987915039
New cuda time: 1.7875269651412964
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9689669609069824
New cuda time: 1.7790470123291016
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7700870037078857
New cuda time: 1.7880070209503174
New cuda time: 1.8097529411315918
New cuda time: 1.783033013343811
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.813433051109314
New cuda time: 1.7639930248260498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7887929677963257
New cuda time: 1.7556730508804321
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7830339670181274
New cuda time: 8.72364616394043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9673529863357544
New cuda time: 1.7655930519104004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8233530521392822
New cuda time: 1.7737540006637573
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798712968826294
New cuda time: 1.7777529954910278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790073037147522
New cuda time: 1.9347130060195923
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9575920104980469
New cuda time: 1.7492729425430298
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8275129795074463
New cuda time: 1.7633529901504517
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913529872894287
New cuda time: 1.754552960395813
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7879940271377563
New cuda time: 1.7759939432144165
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8006329536437988
New cuda time: 1.9556729793548584
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8203129768371582
New cuda time: 1.7731130123138428
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873530387878418
New cuda time: 1.7684730291366577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8116730451583862
New cuda time: 1.7750329971313477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8046330213546753
New cuda time: 1.9055919647216797
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.171008110046387
New cuda time: 1.7756739854812622
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8127930164337158
New cuda time: 1.7715129852294922
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7799930572509766
New cuda time: 1.7743929624557495
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8207930326461792
New cuda time: 1.7654329538345337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.826712965965271
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9767930507659912
New cuda time: 1.9571130275726318
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7879929542541504
New cuda time: 1.7561529874801636
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7839930057525635
New cuda time: 1.7553540468215942
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.826712965965271
New cuda time: 1.7702330350875854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873530387878418
New cuda time: 1.7684730291366577
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7780729532241821
New cuda time: 1.7657530307769775
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7847930192947388
New cuda time: 1.7614330053329468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9811129570007324
New cuda time: 1.7748730182647705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8198330402374268
New cuda time: 1.7702330350875854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822232961654663
New cuda time: 1.9543919563293457
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8198330402374268
New cuda time: 1.7780729532241821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.97359299659729
New cuda time: 1.7774330377578735
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7759929895401
New cuda time: 1.761752963066101
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8223929405212402
New cuda time: 1.771353006362915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.316449165344238
New cuda time: 1.9556729793548584
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862329483032227
New cuda time: 1.8001530170440674
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785112977027893
New cuda time: 1.768792986869812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7865530252456665
New cuda time: 1.776473045349121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7931129932403564
New cuda time: 1.7699129581451416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7739139795303345
New cuda time: 1.8169529438018799
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833529710769653
New cuda time: 1.785593032836914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7902330160140991
New cuda time: 1.76671302318573
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7756730318069458
New cuda time: 1.7710340023040771
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7799930572509766
New cuda time: 1.9028719663619995
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8156729936599731
New cuda time: 1.771353006362915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.820633053779602
New cuda time: 1.791674017906189
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822072982788086
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8263930082321167
New cuda time: 1.771353006362915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9667129516601562
New cuda time: 1.9593520164489746
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8028730154037476
New cuda time: 1.7748730182647705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7889529466629028
New cuda time: 1.7654329538345337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7852729558944702
New cuda time: 1.7817529439926147
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.976472020149231
New cuda time: 1.7745529413223267
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7911930084228516
New cuda time: 1.7767930030822754
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.784472942352295
New cuda time: 1.7740739583969116
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7959929704666138
New cuda time: 1.7516729831695557
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8139129877090454
New cuda time: 1.8294329643249512
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8174339532852173
New cuda time: 7.800769805908203
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8263930082321167
New cuda time: 1.7595139741897583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8167929649353027
New cuda time: 1.807832956314087
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8190330266952515
New cuda time: 1.9137530326843262
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8139129877090454
New cuda time: 1.773432970046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8177529573440552
New cuda time: 1.941112995147705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.768792986869812
New cuda time: 1.7614330053329468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859139442443848
New cuda time: 1.7607929706573486
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9615919589996338
New cuda time: 1.7769529819488525
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7879929542541504
New cuda time: 1.7775930166244507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9590330123901367
New cuda time: 1.769273042678833
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7979129552841187
New cuda time: 1.7635129690170288
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.987671971321106
New cuda time: 1.7580740451812744
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8054330348968506
New cuda time: 1.7777529954910278
New cuda time: 1.7824000120162964
New cuda time: 1.7663999795913696
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8086400032043457
New cuda time: 1.7729599475860596
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790560007095337
New cuda time: 1.7838399410247803
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7940800189971924
New cuda time: 1.9310400485992432
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9569610357284546
New cuda time: 1.780959963798523
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7846399545669556
New cuda time: 1.765120029449463
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.856160044670105
New cuda time: 1.7702410221099854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804960012435913
New cuda time: 1.9767999649047852
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9667199850082397
New cuda time: 1.7894400358200073
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7860809564590454
New cuda time: 1.7777600288391113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.799839973449707
New cuda time: 1.767359972000122
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792641043663025
New cuda time: 1.7828799486160278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 6.400640964508057
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7836799621582031
New cuda time: 1.784000039100647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.793280005455017
New cuda time: 1.7771199941635132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8059200048446655
New cuda time: 1.7796809673309326
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7937599420547485
New cuda time: 8.383042335510254
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.145920753479004
New cuda time: 1.7819210290908813
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859200239181519
New cuda time: 1.7851200103759766
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7896000146865845
New cuda time: 1.928320050239563
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888000011444092
New cuda time: 1.7707200050354004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7812800407409668
New cuda time: 1.7745599746704102
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9475209712982178
New cuda time: 1.9750399589538574
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.879520058631897
New cuda time: 1.77839994430542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783519983291626
New cuda time: 1.7825599908828735
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7992000579833984
New cuda time: 1.7747199535369873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8412799835205078
New cuda time: 1.7787200212478638
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7912009954452515
New cuda time: 1.7727999687194824
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801759958267212
New cuda time: 1.79312002658844
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9574400186538696
New cuda time: 1.7772799730300903
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892800569534302
New cuda time: 1.7659200429916382
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785120964050293
New cuda time: 1.9495999813079834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8075200319290161
New cuda time: 1.7710399627685547
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9664009809494019
New cuda time: 1.769760012626648
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7825599908828735
New cuda time: 1.7753609418869019
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7830400466918945
New cuda time: 1.780959963798523
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.414080619812012
New cuda time: 1.957919955253601
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.815999984741211
New cuda time: 1.937440037727356
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8019200563430786
New cuda time: 1.7787209749221802
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8118410110473633
New cuda time: 1.7848000526428223
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8132799863815308
New cuda time: 1.7827199697494507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7996799945831299
New cuda time: 1.946239948272705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8179199695587158
New cuda time: 1.7704010009765625
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7716799974441528
New cuda time: 1.779041051864624
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955210208892822
New cuda time: 1.7857600450515747
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785600423812866
New cuda time: 9.043360710144043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804321050643921
New cuda time: 1.781440019607544
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7935999631881714
New cuda time: 1.7913600206375122
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7968000173568726
New cuda time: 1.7716799974441528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785599946975708
New cuda time: 1.7833600044250488
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.164960861206055
New cuda time: 1.9379199743270874
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7832000255584717
New cuda time: 1.7900810241699219
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.816161036491394
New cuda time: 1.783519983291626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976000308990479
New cuda time: 1.7776010036468506
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9630399942398071
New cuda time: 1.7799999713897705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848000526428223
New cuda time: 1.7686400413513184
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7958400249481201
New cuda time: 1.7680000066757202
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782080054283142
New cuda time: 1.7844799757003784
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892800569534302
New cuda time: 1.9412800073623657
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7955199480056763
New cuda time: 7.799681186676025
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78656005859375
New cuda time: 1.7817610502243042
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904000282287598
New cuda time: 1.7715200185775757
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7849600315093994
New cuda time: 8.792000770568848
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7870399951934814
New cuda time: 1.779360055923462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843199968338013
New cuda time: 1.9409600496292114
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8268799781799316
New cuda time: 1.7793610095977783
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8020800352096558
New cuda time: 1.7758400440216064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9531199932098389
New cuda time: 1.7768000364303589
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7843199968338013
New cuda time: 1.7796800136566162
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9531209468841553
New cuda time: 1.7691199779510498
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8227200508117676
New cuda time: 1.760159969329834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9576009511947632
New cuda time: 1.7772799730300903
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8036799430847168
New cuda time: 1.7771209478378296
torch.Size([4, 128, 103, 768]) New cuda time: 1.8032079935073853
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.782088041305542
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1195.593017578125, gpu time: 337.9578844308853
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.927734375
Expert1 unused count: 115
Expert2 unused count: 161
Expert1 balance top: 65.185546875
Expert2 balance top: 71.875

New cuda time: 1.8080079555511475
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8193689584732056
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1830.228515625, gpu time: 407.3689110279083
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 5.615234375
Expert1 unused count: 211
Expert2 unused count: 302
Expert1 balance top: 79.78515625
Expert2 balance top: 93.310546875

New cuda time: 1.7742480039596558
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880079746246338
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2537.024169921875, gpu time: 435.39912354946136
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.171875
Expert2 overflow: 2.099609375
Expert1 unused count: 219
Expert2 unused count: 306
Expert1 balance top: 81.201171875
Expert2 balance top: 92.1875

New cuda time: 1.983528971672058
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777680158615112
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1737.58935546875, gpu time: 454.5971409082413
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.294921875
Expert1 unused count: 223
Expert2 unused count: 305
Expert1 balance top: 79.541015625
Expert2 balance top: 91.650390625

New cuda time: 1.8105679750442505
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827279567718506
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1534.614990234375, gpu time: 345.98655593395233
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.80859375
Expert2 overflow: 2.392578125
Expert1 unused count: 238
Expert2 unused count: 295
Expert1 balance top: 83.154296875
Expert2 balance top: 90.33203125

New cuda time: 1.7843279838562012
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783208966255188
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1719.87451171875, gpu time: 414.59535133838654
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.537109375
Expert1 unused count: 258
Expert2 unused count: 285
Expert1 balance top: 81.982421875
Expert2 balance top: 88.623046875

New cuda time: 1.8035290241241455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8176089525222778
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1206.29296875, gpu time: 341.57902240753174
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.125
Expert2 overflow: 2.294921875
Expert1 unused count: 252
Expert2 unused count: 292
Expert1 balance top: 82.666015625
Expert2 balance top: 86.1328125

New cuda time: 7.050432205200195
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8196879625320435
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1849.776123046875, gpu time: 416.23903119564056
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.708984375
Expert2 overflow: 16.796875
Expert1 unused count: 179
Expert2 unused count: 280
Expert1 balance top: 76.904296875
Expert2 balance top: 91.357421875

New cuda time: 1.8134490251541138
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.812168002128601
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2545.59326171875, gpu time: 439.0247405767441
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 4.345703125
Expert1 unused count: 193
Expert2 unused count: 311
Expert1 balance top: 78.759765625
Expert2 balance top: 92.724609375

New cuda time: 1.7926479578018188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.816648006439209
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1746.16162109375, gpu time: 458.2064368724823
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.34375
Expert1 unused count: 190
Expert2 unused count: 291
Expert1 balance top: 77.685546875
Expert2 balance top: 91.6015625

New cuda time: 1.8032079935073853
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8409680128097534
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1543.2421875, gpu time: 349.63073194026947
2024-07-11 01:42:01 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.076171875
Expert2 overflow: 1.318359375
Expert1 unused count: 211
Expert2 unused count: 273
Expert1 balance top: 77.587890625
Expert2 balance top: 88.818359375

New cuda time: 1.816167950630188
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9518489837646484
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1733.1552734375, gpu time: 418.3633682727814
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.48828125
Expert1 unused count: 211
Expert2 unused count: 257
Expert1 balance top: 80.6640625
Expert2 balance top: 86.962890625

New cuda time: 1.9905699491500854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.823367953300476
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1285.889404296875, gpu time: 345.3929603099823
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.001953125
Expert2 overflow: 2.783203125
Expert1 unused count: 230
Expert2 unused count: 252
Expert1 balance top: 81.884765625
Expert2 balance top: 81.982421875

New cuda time: 1.9648089408874512
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.811048984527588
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1927.74755859375, gpu time: 420.0148891210556
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.6640625
Expert2 overflow: 8.056640625
Expert1 unused count: 259
Expert2 unused count: 323
Expert1 balance top: 83.59375
Expert2 balance top: 94.62890625

New cuda time: 1.9435290098190308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9292889833450317
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2629.60888671875, gpu time: 442.89755856990814
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.248046875
Expert2 overflow: 2.490234375
Expert1 unused count: 270
Expert2 unused count: 328
Expert1 balance top: 85.44921875
Expert2 balance top: 93.701171875

New cuda time: 1.9129689931869507
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8225680589675903
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1828.35400390625, gpu time: 461.94197392463684
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 1.85546875
Expert1 unused count: 271
Expert2 unused count: 322
Expert1 balance top: 83.984375
Expert2 balance top: 93.06640625

New cuda time: 1.906088948249817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.809128999710083
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1625.5107421875, gpu time: 353.34594988822937
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.25
Expert2 overflow: 2.34375
Expert1 unused count: 293
Expert2 unused count: 313
Expert1 balance top: 86.474609375
Expert2 balance top: 91.6015625

New cuda time: 1.8008079528808594
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.983528971672058
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1814.752197265625, gpu time: 422.1477051973343
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 2.63671875
Expert1 unused count: 290
Expert2 unused count: 306
Expert1 balance top: 87.060546875
Expert2 balance top: 91.845703125

New cuda time: 1.8008079528808594
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0864100456237793
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1365.35595703125, gpu time: 349.28017938137054
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.05078125
Expert2 overflow: 3.955078125
Expert1 unused count: 308
Expert2 unused count: 321
Expert1 balance top: 88.037109375
Expert2 balance top: 89.306640625

New cuda time: 1.8051279783248901
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9734489917755127
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2020.302734375, gpu time: 423.793466091156
2024-07-11 01:42:02 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.720703125
Expert1 unused count: 187
Expert2 unused count: 285
Expert1 balance top: 75.78125
Expert2 balance top: 91.943359375

New cuda time: 1.9083280563354492
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8260879516601562
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2715.943359375, gpu time: 446.63197457790375
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.9765625
Expert2 overflow: 11.23046875
Expert1 unused count: 198
Expert2 unused count: 287
Expert1 balance top: 79.833984375
Expert2 balance top: 91.748046875

New cuda time: 1.9636900424957275
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8172880411148071
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1909.03857421875, gpu time: 465.7229520082474
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.78125
Expert2 overflow: 0.1953125
Expert1 unused count: 198
Expert2 unused count: 301
Expert1 balance top: 79.6875
Expert2 balance top: 91.89453125

New cuda time: 1.9761699438095093
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8097690343856812
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1702.050048828125, gpu time: 357.13188886642456
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 2.685546875
Expert1 unused count: 231
Expert2 unused count: 298
Expert1 balance top: 82.421875
Expert2 balance top: 91.796875

New cuda time: 1.9849690198898315
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9686490297317505
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1899.859619140625, gpu time: 426.1013232469559
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.87890625
Expert1 unused count: 248
Expert2 unused count: 290
Expert1 balance top: 82.91015625
Expert2 balance top: 91.015625

New cuda time: 1.8067280054092407
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.97632896900177
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1443.314697265625, gpu time: 353.06323635578156
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.708984375
Expert2 overflow: 3.466796875
Expert1 unused count: 249
Expert2 unused count: 285
Expert1 balance top: 83.642578125
Expert2 balance top: 86.083984375

New cuda time: 1.8192089796066284
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.975849986076355
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2098.616943359375, gpu time: 427.588525056839
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 23.291015625
Expert2 overflow: 33.154296875
Expert1 unused count: 272
Expert2 unused count: 369
Expert1 balance top: 90.576171875
Expert2 balance top: 98.046875

New cuda time: 1.8072079420089722
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9750499725341797
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2784.1162109375, gpu time: 450.4142335653305
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 16.69921875
Expert2 overflow: 33.10546875
Expert1 unused count: 292
Expert2 unused count: 375
Expert1 balance top: 91.650390625
Expert2 balance top: 98.33984375

New cuda time: 1.8195290565490723
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.900169014930725
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1997.680419921875, gpu time: 469.44264900684357
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.005859375
Expert2 overflow: 21.58203125
Expert1 unused count: 296
Expert2 unused count: 356
Expert1 balance top: 90.91796875
Expert2 balance top: 96.923828125

New cuda time: 1.7950479984283447
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9780889749526978
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1783.175537109375, gpu time: 360.9050258398056
2024-07-11 01:42:03 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.177734375
Expert2 overflow: 17.3828125
Expert1 unused count: 289
Expert2 unused count: 328
Expert1 balance top: 90.8203125
Expert2 balance top: 94.970703125

New cuda time: 1.9667290449142456
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 5.889307975769043
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1999.17041015625, gpu time: 433.9573612213135
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.44140625
Expert2 overflow: 6.8359375
Expert1 unused count: 291
Expert2 unused count: 315
Expert1 balance top: 88.623046875
Expert2 balance top: 92.3828125

New cuda time: 1.8073680400848389
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.984009027481079
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1521.34326171875, gpu time: 356.8546134233475
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.734375
Expert2 overflow: 10.44921875
Expert1 unused count: 320
Expert2 unused count: 314
Expert1 balance top: 92.96875
Expert2 balance top: 91.748046875

New cuda time: 1.8078479766845703
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9860889911651611
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2180.276123046875, gpu time: 431.3824630975723
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 8.3984375
Expert1 unused count: 194
Expert2 unused count: 297
Expert1 balance top: 76.416015625
Expert2 balance top: 90.8203125

New cuda time: 1.8059279918670654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9736089706420898
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2849.34375, gpu time: 454.193771481514
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 4.00390625
Expert1 unused count: 207
Expert2 unused count: 305
Expert1 balance top: 81.396484375
Expert2 balance top: 92.529296875

New cuda time: 1.8179279565811157
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.12837219238281
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2085.1767578125, gpu time: 552.3889491558075
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 4.345703125
Expert1 unused count: 211
Expert2 unused count: 294
Expert1 balance top: 79.736328125
Expert2 balance top: 91.89453125

New cuda time: 1.8134490251541138
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.978248953819275
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1867.78466796875, gpu time: 364.6967227458954
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.61328125
Expert2 overflow: 5.810546875
Expert1 unused count: 238
Expert2 unused count: 277
Expert1 balance top: 82.080078125
Expert2 balance top: 89.697265625

New cuda time: 1.8011280298233032
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 69.19071960449219
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2076.938232421875, gpu time: 504.94920885562897
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.341796875
Expert1 unused count: 243
Expert2 unused count: 281
Expert1 balance top: 81.689453125
Expert2 balance top: 88.96484375

New cuda time: 1.8193680047988892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777689695358276
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1530.2763671875, gpu time: 360.4517503976822
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.296875
Expert2 overflow: 4.052734375
Expert1 unused count: 250
Expert2 unused count: 262
Expert1 balance top: 83.203125
Expert2 balance top: 83.10546875

New cuda time: 68.1390380859375
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827279567718506
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2254.57568359375, gpu time: 501.3042291402817
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.859375
Expert2 overflow: 4.1015625
Expert1 unused count: 221
Expert2 unused count: 310
Expert1 balance top: 81.298828125
Expert2 balance top: 93.603515625

New cuda time: 1.8004889488220215
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9804890155792236
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2934.384765625, gpu time: 457.9747494459152
2024-07-11 01:42:04 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.4921875
Expert2 overflow: 3.759765625
Expert1 unused count: 223
Expert2 unused count: 326
Expert1 balance top: 82.2265625
Expert2 balance top: 94.43359375

New cuda time: 1.9588890075683594
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9689689874649048
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2160.08740234375, gpu time: 556.3168081045151
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 1.5625
Expert1 unused count: 214
Expert2 unused count: 313
Expert1 balance top: 79.78515625
Expert2 balance top: 92.626953125

New cuda time: 1.9131289720535278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.969290018081665
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1950.766357421875, gpu time: 368.5791417360306
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.37109375
Expert2 overflow: 2.9296875
Expert1 unused count: 227
Expert2 unused count: 284
Expert1 balance top: 82.71484375
Expert2 balance top: 90.380859375

New cuda time: 1.8064090013504028
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9865700006484985
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2159.48388671875, gpu time: 508.74218785762787
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 3.466796875
Expert1 unused count: 247
Expert2 unused count: 262
Expert1 balance top: 82.421875
Expert2 balance top: 87.939453125

New cuda time: 1.8124890327453613
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9275280237197876
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1607.369384765625, gpu time: 364.19176638126373
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 3.662109375
Expert1 unused count: 245
Expert2 unused count: 274
Expert1 balance top: 82.51953125
Expert2 balance top: 86.5234375

New cuda time: 1.8160090446472168
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7900880575180054
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2262.27978515625, gpu time: 504.9103262424469
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.537109375
Expert2 overflow: 8.447265625
Expert1 unused count: 127
Expert2 unused count: 284
Expert1 balance top: 70.21484375
Expert2 balance top: 91.064453125

New cuda time: 1.967208981513977
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79584801197052
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2946.76123046875, gpu time: 461.7378064393997
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.41796875
Expert2 overflow: 3.271484375
Expert1 unused count: 109
Expert2 unused count: 265
Expert1 balance top: 68.994140625
Expert2 balance top: 89.501953125

New cuda time: 1.8128080368041992
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9739290475845337
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2174.495849609375, gpu time: 560.1035451889038
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 112
Expert2 unused count: 271
Expert1 balance top: 68.017578125
Expert2 balance top: 89.35546875

New cuda time: 1.8153680562973022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8140889406204224
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1959.238525390625, gpu time: 372.2085987329483
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.244140625
Expert1 unused count: 126
Expert2 unused count: 236
Expert1 balance top: 67.919921875
Expert2 balance top: 85.83984375

New cuda time: 1.8118489980697632
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8086479902267456
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2168.022705078125, gpu time: 512.3626838922501
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 147
Expert2 unused count: 207
Expert1 balance top: 68.994140625
Expert2 balance top: 82.568359375

New cuda time: 1.8092880249023438
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9694490432739258
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1616.6044921875, gpu time: 367.97050344944
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 161
Expert2 unused count: 186
Expert1 balance top: 71.38671875
Expert2 balance top: 74.8046875

New cuda time: 1.8102489709854126
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8235290050506592
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2270.214599609375, gpu time: 508.54410326480865
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 5.517578125
Expert1 unused count: 188
Expert2 unused count: 276
Expert1 balance top: 74.90234375
Expert2 balance top: 90.625

New cuda time: 1.8115290403366089
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8251290321350098
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2955.132568359375, gpu time: 465.37446451187134
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 4.443359375
Expert1 unused count: 212
Expert2 unused count: 306
Expert1 balance top: 79.8828125
Expert2 balance top: 92.67578125

New cuda time: 1.8158479928970337
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9680099487304688
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2192.07763671875, gpu time: 563.8874031305313
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 2.685546875
Expert1 unused count: 212
Expert2 unused count: 311
Expert1 balance top: 79.6875
Expert2 balance top: 92.7734375

New cuda time: 1.8043290376663208
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8286479711532593
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1967.8388671875, gpu time: 375.8415757417679
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.58984375
Expert2 overflow: 2.001953125
Expert1 unused count: 226
Expert2 unused count: 287
Expert1 balance top: 80.517578125
Expert2 balance top: 90.13671875

New cuda time: 1.8048080205917358
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8160090446472168
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2176.544677734375, gpu time: 515.9835019111633
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.78125
Expert1 unused count: 250
Expert2 unused count: 275
Expert1 balance top: 82.568359375
Expert2 balance top: 88.232421875

New cuda time: 1.7939289808273315
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9745689630508423
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1628.88623046875, gpu time: 371.7390013933182
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.859375
Expert2 overflow: 4.78515625
Expert1 unused count: 249
Expert2 unused count: 254
Expert1 balance top: 83.88671875
Expert2 balance top: 82.763671875

New cuda time: 1.800487995147705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7723280191421509
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2278.81982421875, gpu time: 512.1169202327728
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.25
Expert2 overflow: 12.939453125
Expert1 unused count: 274
Expert2 unused count: 339
Expert1 balance top: 91.748046875
Expert2 balance top: 96.38671875

New cuda time: 1.8214479684829712
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7676880359649658
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2964.16845703125, gpu time: 468.9636005163193
2024-07-11 01:42:05 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.984375
Expert2 overflow: 5.224609375
Expert1 unused count: 261
Expert2 unused count: 339
Expert1 balance top: 90.966796875
Expert2 balance top: 95.99609375

New cuda time: 1.8041690587997437
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7856080532073975
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2204.1396484375, gpu time: 567.4771791696548
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 17.1875
Expert2 overflow: 8.69140625
Expert1 unused count: 258
Expert2 unused count: 341
Expert1 balance top: 90.380859375
Expert2 balance top: 95.703125

New cuda time: 1.9102489948272705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7849689722061157
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1978.27587890625, gpu time: 379.53679370880127
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.740234375
Expert2 overflow: 2.197265625
Expert1 unused count: 245
Expert2 unused count: 316
Expert1 balance top: 88.037109375
Expert2 balance top: 94.82421875

New cuda time: 1.8200089931488037
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.776648998260498
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2185.40966796875, gpu time: 519.5801589488983
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.1015625
Expert1 unused count: 259
Expert2 unused count: 312
Expert1 balance top: 88.134765625
Expert2 balance top: 93.896484375

New cuda time: 1.8102480173110962
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7961679697036743
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1636.66015625, gpu time: 375.34541738033295
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.708984375
Expert2 overflow: 2.392578125
Expert1 unused count: 233
Expert2 unused count: 286
Expert1 balance top: 87.01171875
Expert2 balance top: 89.6484375

New cuda time: 1.8059279918670654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8072090148925781
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2286.593994140625, gpu time: 515.7300581932068
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.783203125
Expert1 unused count: 100
Expert2 unused count: 256
Expert1 balance top: 62.5
Expert2 balance top: 88.8671875

New cuda time: 1.8016090393066406
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8216079473495483
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2972.5673828125, gpu time: 472.58681750297546
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.904296875
Expert1 unused count: 99
Expert2 unused count: 273
Expert1 balance top: 63.37890625
Expert2 balance top: 90.478515625

New cuda time: 2.05745005607605
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.970729947090149
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2219.69775390625, gpu time: 571.5053582191467
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.44140625
Expert1 unused count: 104
Expert2 unused count: 261
Expert1 balance top: 63.720703125
Expert2 balance top: 89.404296875

New cuda time: 1.799528956413269
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8193689584732056
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1986.607177734375, gpu time: 383.15569162368774
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 1.26953125
Expert1 unused count: 111
Expert2 unused count: 222
Expert1 balance top: 63.232421875
Expert2 balance top: 84.86328125

New cuda time: 1.802888035774231
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.548205375671387
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2201.697998046875, gpu time: 530.9312523603439
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.09765625
Expert1 unused count: 105
Expert2 unused count: 182
Expert1 balance top: 62.451171875
Expert2 balance top: 78.076171875

New cuda time: 1.7955290079116821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8160079717636108
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1645.177978515625, gpu time: 378.95695436000824
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 1.66015625
Expert1 unused count: 148
Expert2 unused count: 155
Expert1 balance top: 67.28515625
Expert2 balance top: 71.435546875

New cuda time: 1.958569049835205
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8145689964294434
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2294.056884765625, gpu time: 519.5031962394714
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.2734375
Expert1 unused count: 223
Expert2 unused count: 322
Expert1 balance top: 80.322265625
Expert2 balance top: 94.189453125

New cuda time: 1.8131279945373535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9779289960861206
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2985.91064453125, gpu time: 476.37787449359894
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.41796875
Expert1 unused count: 251
Expert2 unused count: 316
Expert1 balance top: 83.447265625
Expert2 balance top: 92.7734375

New cuda time: 1.8184089660644531
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8180880546569824
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2228.218505859375, gpu time: 575.1418552398682
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.759765625
Expert2 overflow: 1.220703125
Expert1 unused count: 239
Expert2 unused count: 305
Expert1 balance top: 81.73828125
Expert2 balance top: 91.162109375

New cuda time: 1.9814499616622925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7822480201721191
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2031.746826171875, gpu time: 386.91938960552216
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 3.61328125
Expert1 unused count: 279
Expert2 unused count: 312
Expert1 balance top: 85.205078125
Expert2 balance top: 91.943359375

New cuda time: 1.811208963394165
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.830409049987793
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2209.84130859375, gpu time: 534.5728703737259
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.029296875
Expert1 unused count: 291
Expert2 unused count: 322
Expert1 balance top: 87.20703125
Expert2 balance top: 92.919921875

New cuda time: 1.8123279809951782
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8128089904785156
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1653.634765625, gpu time: 382.58209133148193
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.46875
Expert2 overflow: 2.24609375
Expert1 unused count: 299
Expert2 unused count: 316
Expert1 balance top: 89.16015625
Expert2 balance top: 90.478515625

torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7886470556259155
New cuda time: 1.7761659622192383
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9534469842910767
New cuda time: 1.7620869874954224
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780485987663269
New cuda time: 1.9406479597091675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7921669483184814
New cuda time: 1.7739269733428955
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8064069747924805
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78752601146698
New cuda time: 1.7667269706726074
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.79168701171875
New cuda time: 7.014266014099121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8041670322418213
New cuda time: 1.784646987915039
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8016070127487183
New cuda time: 1.7696069478988647
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7963260412216187
New cuda time: 1.7824070453643799
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798406958580017
New cuda time: 1.7771259546279907
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9403270483016968
New cuda time: 1.9577679634094238
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8046469688415527
New cuda time: 1.9500880241394043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7913670539855957
New cuda time: 1.9585679769515991
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0715279579162598
New cuda time: 71.32299041748047
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9340870380401611
New cuda time: 76.37069702148438
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789126992225647
New cuda time: 1.7880070209503174
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9531279802322388
New cuda time: 1.7833670377731323
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.9718520641326904
New cuda time: 1.7920069694519043
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9777679443359375
New cuda time: 80.1606216430664
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9598469734191895
New cuda time: 1.968487024307251
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9520070552825928
New cuda time: 1.9419269561767578
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9529680013656616
New cuda time: 1.9470469951629639
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9646480083465576
New cuda time: 1.7812869548797607
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9723269939422607
New cuda time: 1.7740869522094727
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953766942024231
New cuda time: 1.775527000427246
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.968168020248413
New cuda time: 1.7905670404434204
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 75.13516998291016
New cuda time: 1.7441669702529907
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9582469463348389
New cuda time: 1.9526469707489014
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.780994415283203
New cuda time: 1.7776069641113281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.96144700050354
New cuda time: 1.772966980934143
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9632079601287842
New cuda time: 1.7812860012054443
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9747270345687866
New cuda time: 1.7884869575500488
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.29103088378906
New cuda time: 1.7902469635009766
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9809670448303223
New cuda time: 1.7787270545959473
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 69.20970153808594
New cuda time: 1.7664060592651367
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892869710922241
New cuda time: 68.14058685302734
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8024070262908936
New cuda time: 1.782086968421936
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.984807014465332
New cuda time: 1.9409680366516113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9520080089569092
New cuda time: 8.971075057983398
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9561660289764404
New cuda time: 1.7785669565200806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9692870378494263
New cuda time: 1.7832059860229492
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 70.05339050292969
New cuda time: 1.9377679824829102
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.854246973991394
New cuda time: 1.9424070119857788
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7768069505691528
New cuda time: 1.7873669862747192
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9510469436645508
New cuda time: 1.786726951599121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7833670377731323
New cuda time: 1.770887017250061
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7932870388031006
New cuda time: 1.780007004737854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.942247986793518
New cuda time: 1.7892869710922241
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7873669862747192
New cuda time: 1.7760059833526611
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787207007408142
New cuda time: 1.7726470232009888
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9433670043945312
New cuda time: 1.7822469472885132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.800806999206543
New cuda time: 1.7796870470046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7841670513153076
New cuda time: 1.7579269409179688
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9449670314788818
New cuda time: 1.7864069938659668
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7990469932556152
New cuda time: 1.7756869792938232
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8000069856643677
New cuda time: 1.7784069776535034
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9552079439163208
New cuda time: 1.8979270458221436
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7785669565200806
New cuda time: 1.782405972480774
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9596879482269287
New cuda time: 1.7721669673919678
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9348870515823364
New cuda time: 1.79408597946167
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9452879428863525
New cuda time: 1.7771270275115967
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8001660108566284
New cuda time: 8.91555404663086
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9627269506454468
New cuda time: 1.7849669456481934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9430480003356934
New cuda time: 1.7828869819641113
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.510757446289062
New cuda time: 1.7785669565200806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7848060131072998
New cuda time: 1.9465670585632324
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78512704372406
New cuda time: 1.7854470014572144
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9651269912719727
New cuda time: 1.7862470149993896
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798887014389038
New cuda time: 1.9480079412460327
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7972869873046875
New cuda time: 1.7792060375213623
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8064069747924805
New cuda time: 1.7921669483184814
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8030469417572021
New cuda time: torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8244730234146118
New cuda time: 1.7683130502700806
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918330430984497
New cuda time: 1.792153000831604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8124730587005615
New cuda time: 1.8188730478286743
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8198330402374268
New cuda time: 1.7780729532241821
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8300729990005493
New cuda time: 1.7668730020523071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.819993019104004
New cuda time: 1.7651129961013794
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7846330404281616
New cuda time: 1.7431930303573608
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7804739475250244
New cuda time: 1.7745529413223267
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7847930192947388
New cuda time: 1.7711939811706543
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790073037147522
New cuda time: 1.761273980140686
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7831929922103882
New cuda time: 1.7675130367279053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9646320343017578
New cuda time: 1.9558320045471191
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8086340427398682
New cuda time: 1.9367929697036743
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7719930410385132
New cuda time: 1.9195129871368408
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.892153024673462
New cuda time: 71.3434066772461
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7815929651260376
New cuda time: 1.9078329801559448
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7879929542541504
New cuda time: 1.761754035949707
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9495929479599
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7532730102539062
New cuda time: 1.7639939785003662
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9449520111083984
New cuda time: 80.1651382446289
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7796729803085327
New cuda time: 1.9353530406951904
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7982330322265625
New cuda time: 1.9443130493164062
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7756730318069458
New cuda time: 1.8094329833984375
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9452730417251587
New cuda time: 1.7569539546966553
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9555130004882812
New cuda time: 1.776473045349121
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9622329473495483
New cuda time: 1.7619140148162842
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.950553059577942
New cuda time: 1.7572740316390991
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.0540719032287598
New cuda time: 1.7951929569244385
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.959352970123291
New cuda time: 1.9593520164489746
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 5.600779056549072
New cuda time: 1.7561529874801636
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9591929912567139
New cuda time: 1.7878329753875732
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9433519840240479
New cuda time: 1.7761529684066772
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.948153018951416
New cuda time: 1.775354027748108
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.15840911865234
New cuda time: 1.759192943572998
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9607919454574585
New cuda time: 1.7702330350875854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 69.2568588256836
New cuda time: 1.7707140445709229
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824152946472168
New cuda time: 68.13350677490234
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7982330322265625
New cuda time: 1.7612730264663696
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9550329446792603
New cuda time: 1.9417519569396973
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9499109983444214
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953752040863037
New cuda time: 1.7796729803085327
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9537529945373535
New cuda time: 1.752472996711731
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 70.09077453613281
New cuda time: 1.7689529657363892
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859129905700684
New cuda time: 1.943511962890625
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.787032961845398
New cuda time: 1.7555129528045654
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8167929649353027
New cuda time: 1.7599929571151733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7919930219650269
New cuda time: 1.7766339778900146
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7777529954910278
New cuda time: 1.7782340049743652
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8257529735565186
New cuda time: 1.7665539979934692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7724729776382446
New cuda time: 1.7702330350875854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7771129608154297
New cuda time: 1.7627129554748535
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8284729719161987
New cuda time: 1.7587130069732666
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7678329944610596
New cuda time: 1.7761529684066772
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7815940380096436
New cuda time: 1.7814340591430664
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8276729583740234
New cuda time: 1.7747130393981934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.824152946472168
New cuda time: 1.7623929977416992
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.825273036956787
New cuda time: 1.775033950805664
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8153530359268188
New cuda time: 1.8627129793167114
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857539653778076
New cuda time: 1.7675130367279053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7894330024719238
New cuda time: 1.7771129608154297
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9294320344924927
New cuda time: 1.7697529792785645
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.761754035949707
New cuda time: 1.7604730129241943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859129905700684
New cuda time: 1.9132729768753052
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9515119791030884
New cuda time: 1.7751940488815308
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7759929895401
New cuda time: 1.7604730129241943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.508923530578613
New cuda time: 1.7836730480194092
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7828739881515503
New cuda time: 1.9427119493484497
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7799930572509766
New cuda time: 1.764312982559204
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8419129848480225
New cuda time: 1.7691129446029663
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8020730018615723
New cuda time: 1.948153018951416
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8283129930496216
New cuda time: 1.7644740343093872
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7743929624557495
New cuda time: 1.775352954864502
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7977529764175415
New cuda time: torch.float16
New cuda time: 1.7868800163269043
New cuda time: 1.782080054283142
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9417599439620972
New cuda time: 1.7828799486160278
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.790719985961914
New cuda time: 1.9460810422897339
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.788640022277832
New cuda time: 1.7852809429168701
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8032000064849854
New cuda time: 1.772320032119751
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7859200239181519
New cuda time: 1.7758400440216064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7844799757003784
New cuda time: 1.9980800151824951
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7961599826812744
New cuda time: 1.7611199617385864
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7705609798431396
New cuda time: 1.7768000364303589
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7865610122680664
New cuda time: 1.7726399898529053
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8017610311508179
New cuda time: 1.769919991493225
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9387199878692627
New cuda time: 1.9587199687957764
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7659200429916382
New cuda time: 1.9448000192642212
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7849609851837158
New cuda time: 1.960479974746704
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.061761856079102
New cuda time: 2.1040000915527344
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.932960033416748
New cuda time: 76.37504577636719
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7984000444412231
New cuda time: 1.7867200374603271
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9707200527191162
New cuda time: 1.7739200592041016
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 2.984800100326538
New cuda time: 1.7878400087356567
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9878400564193726
New cuda time: 80.16353607177734
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.950721025466919
New cuda time: 1.960319995880127
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.951200008392334
New cuda time: 1.9627200365066528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9523199796676636
New cuda time: 1.945600986480713
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.957759976387024
New cuda time: 1.7833600044250488
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9783999919891357
New cuda time: 1.7689599990844727
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9580800533294678
New cuda time: 1.776479959487915
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9731199741363525
New cuda time: 1.790719985961914
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 75.13809967041016
New cuda time: 1.7896009683609009
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9635200500488281
New cuda time: 1.9641599655151367
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 8.558720588684082
New cuda time: 1.7811199426651
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.953279972076416
New cuda time: 1.7710410356521606
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9598400592803955
New cuda time: 1.7940800189971924
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9678399562835693
New cuda time: 1.7747199535369873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 81.2948989868164
New cuda time: 1.7871999740600586
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9860800504684448
New cuda time: 1.7848000526428223
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 69.21968841552734
New cuda time: 1.7814409732818604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7918410301208496
New cuda time: 68.14496612548828
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.806879997253418
New cuda time: 1.7849609851837158
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.978559970855713
New cuda time: 1.9528000354766846
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.955680012702942
New cuda time: 1.7801599502563477
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9515199661254883
New cuda time: 1.7896000146865845
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9520000219345093
New cuda time: 1.7798399925231934
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 70.08241271972656
New cuda time: 1.9366400241851807
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8665599822998047
New cuda time: 1.9443199634552002
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.815999984741211
New cuda time: 1.789760947227478
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9534399509429932
New cuda time: 1.7876800298690796
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7768000364303589
New cuda time: 1.7665599584579468
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8020800352096558
New cuda time: 1.7904000282287598
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9451199769973755
New cuda time: 1.7793610095977783
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7827199697494507
New cuda time: 1.767680048942566
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7779209613800049
New cuda time: 1.792160987854004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9550410509109497
New cuda time: 1.7824009656906128
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.78656005859375
New cuda time: 1.7752000093460083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7888000011444092
New cuda time: 1.7950400114059448
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9547200202941895
New cuda time: 1.779360055923462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7945599555969238
New cuda time: 1.7849600315093994
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8009599447250366
New cuda time: 1.7684810161590576
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9540810585021973
New cuda time: 1.7768009901046753
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8187199831008911
New cuda time: 1.7753599882125854
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9528000354766846
New cuda time: 1.7854399681091309
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9475209712982178
New cuda time: 1.788159966468811
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.942080020904541
New cuda time: 1.783200979232788
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7880009412765503
New cuda time: 8.900321960449219
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9475200176239014
New cuda time: 1.7774399518966675
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9313600063323975
New cuda time: 1.7708799839019775
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 9.502720832824707
New cuda time: 1.7681599855422974
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7904000282287598
New cuda time: 1.9611200094223022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.778560996055603
New cuda time: 1.7766410112380981
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9672000408172607
New cuda time: 1.7747199535369873
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.785601019859314
New cuda time: 1.9518400430679321
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7937599420547485
New cuda time: 1.7848010063171387
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7819199562072754
New cuda time: 1.770400047302246
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7900810241699219
New cuda time: 1.9422399997711182
New cuda time: 1.9505690336227417
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9336090087890625
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2308.624755859375, gpu time: 523.3873742818832
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.646484375
Expert1 unused count: 188
Expert2 unused count: 303
Expert1 balance top: 78.80859375
Expert2 balance top: 93.65234375

New cuda time: 1.807049036026001
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.813768982887268
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2994.486083984375, gpu time: 479.9986925125122
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 6.982421875
Expert1 unused count: 202
Expert2 unused count: 306
Expert1 balance top: 78.955078125
Expert2 balance top: 93.45703125

New cuda time: 1.8078490495681763
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8134479522705078
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2236.850830078125, gpu time: 578.7631522417068
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 2.490234375
Expert1 unused count: 199
Expert2 unused count: 309
Expert1 balance top: 78.662109375
Expert2 balance top: 93.5546875

New cuda time: 1.8062479496002197
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9435299634933472
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2044.679443359375, gpu time: 390.6691675186157
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.076171875
Expert1 unused count: 209
Expert2 unused count: 288
Expert1 balance top: 79.541015625
Expert2 balance top: 90.72265625

New cuda time: 1.8169679641723633
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.786728024482727
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2218.4921875, gpu time: 538.1765674352646
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.68359375
Expert1 unused count: 224
Expert2 unused count: 258
Expert1 balance top: 78.759765625
Expert2 balance top: 87.646484375

New cuda time: 1.8153680562973022
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8118480443954468
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1662.218505859375, gpu time: 386.2093074321747
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 1.220703125
Expert1 unused count: 235
Expert2 unused count: 243
Expert1 balance top: 80.17578125
Expert2 balance top: 82.8125

New cuda time: 1.8126490116119385
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7489689588546753
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2325.260009765625, gpu time: 526.9489922523499
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 7.666015625
Expert1 unused count: 151
Expert2 unused count: 269
Expert1 balance top: 72.705078125
Expert2 balance top: 89.35546875

New cuda time: 1.7958489656448364
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8140889406204224
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3003.050048828125, gpu time: 483.60863041877747
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 2.978515625
Expert1 unused count: 172
Expert2 unused count: 298
Expert1 balance top: 75.68359375
Expert2 balance top: 92.236328125

New cuda time: 1.809928059577942
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.798408031463623
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2245.65380859375, gpu time: 582.3714892864227
2024-07-11 01:42:06 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.390625
Expert2 overflow: 5.517578125
Expert1 unused count: 172
Expert2 unused count: 293
Expert1 balance top: 75.1953125
Expert2 balance top: 91.6015625

New cuda time: 1.816329002380371
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7612890005111694
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2056.489990234375, gpu time: 394.24678552150726
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.41796875
Expert2 overflow: 3.369140625
Expert1 unused count: 195
Expert2 unused count: 277
Expert1 balance top: 77.001953125
Expert2 balance top: 90.576171875

New cuda time: 1.8126490116119385
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7844879627227783
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2227.3251953125, gpu time: 541.773703455925
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 201
Expert2 unused count: 252
Expert1 balance top: 77.63671875
Expert2 balance top: 86.03515625

New cuda time: 1.8097690343856812
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9942489862442017
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1675.494384765625, gpu time: 390.01332545280457
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 4.931640625
Expert1 unused count: 211
Expert2 unused count: 243
Expert1 balance top: 80.615234375
Expert2 balance top: 80.126953125

New cuda time: 1.8243290185928345
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.783208966255188
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2336.1416015625, gpu time: 530.5565302371979
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.271484375
Expert1 unused count: 146
Expert2 unused count: 277
Expert1 balance top: 70.556640625
Expert2 balance top: 89.794921875

New cuda time: 1.809609055519104
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.804489016532898
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3011.677978515625, gpu time: 487.22272849082947
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 5.712890625
Expert1 unused count: 171
Expert2 unused count: 303
Expert1 balance top: 73.73046875
Expert2 balance top: 93.701171875

New cuda time: 1.9643290042877197
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7798479795455933
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2261.37451171875, gpu time: 586.1156672239304
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.83203125
Expert1 unused count: 169
Expert2 unused count: 295
Expert1 balance top: 74.90234375
Expert2 balance top: 91.748046875

New cuda time: 1.9102489948272705
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9214489459991455
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2072.223388671875, gpu time: 398.0784834623337
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.392578125
Expert1 unused count: 179
Expert2 unused count: 255
Expert1 balance top: 75.390625
Expert2 balance top: 87.158203125

New cuda time: 1.8174489736557007
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7806479930877686
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2236.193115234375, gpu time: 545.3717994689941
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 1.171875
Expert1 unused count: 192
Expert2 unused count: 240
Expert1 balance top: 76.513671875
Expert2 balance top: 86.42578125

New cuda time: 1.8108880519866943
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9872089624404907
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1687.526611328125, gpu time: 393.81142246723175
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 2.83203125
Expert1 unused count: 228
Expert2 unused count: 240
Expert1 balance top: 82.12890625
Expert2 balance top: 80.37109375

New cuda time: 1.9736089706420898
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8238489627838135
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2350.1044921875, gpu time: 534.3539881706238
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.833984375
Expert1 unused count: 131
Expert2 unused count: 264
Expert1 balance top: 69.7265625
Expert2 balance top: 88.57421875

New cuda time: 1.802088975906372
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8169690370559692
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3020.234130859375, gpu time: 490.8417865037918
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 5.17578125
Expert1 unused count: 141
Expert2 unused count: 294
Expert1 balance top: 70.1171875
Expert2 balance top: 92.87109375

New cuda time: 1.8033679723739624
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8315279483795166
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2270.001708984375, gpu time: 589.7505631446838
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.806640625
Expert1 unused count: 163
Expert2 unused count: 304
Expert1 balance top: 73.046875
Expert2 balance top: 93.45703125

New cuda time: 1.966568946838379
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7659289836883545
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2086.193115234375, gpu time: 401.810982465744
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.0
Expert1 unused count: 165
Expert2 unused count: 267
Expert1 balance top: 73.14453125
Expert2 balance top: 89.453125

New cuda time: 1.809128999710083
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.779047966003418
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2244.853271484375, gpu time: 548.9599764347076
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 1.3671875
Expert1 unused count: 164
Expert2 unused count: 226
Expert1 balance top: 74.51171875
Expert2 balance top: 83.69140625

New cuda time: 1.797287940979004
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7849680185317993
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1696.26025390625, gpu time: 397.39367949962616
2024-07-11 01:42:07 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.443359375
Expert1 unused count: 188
Expert2 unused count: 209
Expert1 balance top: 76.5625
Expert2 balance top: 78.955078125

1.9512079954147339
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9382469654083252
New cuda time: 1.7764869928359985
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7929669618606567
New cuda time: 1.7948869466781616
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7932870388031006
New cuda time: 1.7745670080184937
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9454480409622192
New cuda time: 1.7835270166397095
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8612879514694214
New cuda time: 1.7833670377731323
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.801285982131958
New cuda time: 1.7817670106887817
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 4.962900161743164
New cuda time: 1.7822469472885132
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.796807050704956
New cuda time: 1.8136069774627686
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9083280563354492
New cuda time: 1.7809669971466064
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9425679445266724
New cuda time: 1.7796870470046997
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9084869623184204
New cuda time: 1.7819269895553589
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7950470447540283
New cuda time: 1.7886470556259155
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7926470041275024
New cuda time: 1.7792069911956787
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7932870388031006
New cuda time: 1.9486470222473145
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8356870412826538
New cuda time: 1.8852880001068115
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9448070526123047
New cuda time: 1.784487009048462
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7936069965362549
New cuda time: 1.775527000427246
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9760069847106934
New cuda time: 1.9337669610977173
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7960070371627808
New cuda time: 1.7910469770431519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7716870307922363
New cuda time: 1.7744070291519165
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7926470041275024
New cuda time: 1.937127947807312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7892869710922241
New cuda time: 1.7908869981765747
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9392069578170776
New cuda time: 1.780485987663269
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9232079982757568
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.939041018486023
New cuda time: 1.7814409732818604
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7801599502563477
New cuda time: 1.767199993133545
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7862399816513062
New cuda time: 1.7659209966659546
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9440009593963623
New cuda time: 1.7878400087356567
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.862239956855774
New cuda time: 1.7724800109863281
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7934410572052002
New cuda time: 1.776481032371521
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 4.959200859069824
New cuda time: 1.7883199453353882
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7871999740600586
New cuda time: 1.8027199506759644
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9118399620056152
New cuda time: 1.760159969329834
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9593600034713745
New cuda time: 1.7750400304794312
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9177600145339966
New cuda time: 1.7760000228881836
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.832000970840454
New cuda time: 1.77839994430542
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867209911346436
New cuda time: 1.7776010036468506
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7942399978637695
New cuda time: 1.9460810422897339
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.836959958076477
New cuda time: 1.8884799480438232
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9495999813079834
New cuda time: 1.7649600505828857
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7976000308990479
New cuda time: 1.7859200239181519
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9769610166549683
New cuda time: 1.9334399700164795
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7729599475860596
New cuda time: 1.7716799974441528
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7939200401306152
New cuda time: 1.7899199724197388
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8015999794006348
New cuda time: 1.9310400485992432
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.792799949645996
New cuda time: 1.7761609554290771
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9430400133132935
New cuda time: 1.7812800407409668
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9331200122833252
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
1.9243119955062866
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9820729494094849
New cuda time: 1.7590340375900269
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7732720375061035
New cuda time: 1.7564729452133179
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780953049659729
New cuda time: 1.782073974609375
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.968472957611084
New cuda time: 1.7599929571151733
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7867130041122437
New cuda time: 1.7611130475997925
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7811130285263062
New cuda time: 1.7756730318069458
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.95231294631958
New cuda time: 1.7715129852294922
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7812730073928833
New cuda time: 1.7447930574417114
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789592981338501
New cuda time: 1.7684739828109741
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.822072982788086
New cuda time: 1.7857530117034912
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.789592981338501
New cuda time: 1.773753046989441
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9787119626998901
New cuda time: 1.7703930139541626
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.8143930435180664
New cuda time: 1.7785530090332031
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7807940244674683
New cuda time: 1.9374330043792725
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7863940000534058
New cuda time: 8.6409273147583
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9444730281829834
New cuda time: 1.7860729694366455
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.806393027305603
New cuda time: 1.7713539600372314
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.9478329420089722
New cuda time: 1.7995129823684692
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7839939594268799
New cuda time: 1.7828730344772339
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7923129796981812
New cuda time: 1.7740730047225952
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.775352954864502
New cuda time: 1.8137530088424683
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.817592978477478
New cuda time: 1.7579129934310913
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.780953049659729
New cuda time: 1.7668730020523071
torch.Size([4, 128, 103, 768]) torch.float16
New cuda time: 1.7857530117034912
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:42:07 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:42:07 | INFO | fairseq_cli.eval_lm | Evaluated 825,641 tokens in 50.4s (16380.94 tokens/s)
2024-07-11 01:42:07 | INFO | fairseq_cli.eval_lm | valid Loss (base 2): 2.9556, Perplexity: 7.76
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 4 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
