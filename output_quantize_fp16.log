2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:17325
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:12043
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:12043
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:12043
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:13291
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:12112
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:12112
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:14282
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:14282
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:13291
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:14282
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:12043
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:12112
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:14282
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:12112
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 3
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 1
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:13291
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 2
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:13291
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 1
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 2
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 1
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 3
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 0
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 1
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 3
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 2
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 2
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:13967
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 3
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 0
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 0
2024-07-09 22:06:55 | INFO | fairseq.distributed.utils | initialized host t007-001.hpcfund as rank 0
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:13791
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:13791
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:16702
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:13967
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:16702
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:13967
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 1
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:13791
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:17325
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:13791
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:16702
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:17325
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:13967
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 3
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:17325
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:16702
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:12112', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:14282', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:56 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:12043', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:56 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:56 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:13291', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:56 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:56 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:56 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:56 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:56 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:56 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:56 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:56 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:56 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:56 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 1
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 2
2024-07-09 22:06:56 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 0
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 2
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 1
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 2
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 1
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 3
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 3
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 0
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 3
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 2
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 0
2024-07-09 22:06:57 | INFO | fairseq.distributed.utils | initialized host t007-002.hpcfund as rank 0
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:13967', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:57 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:57 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:57 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:13791', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:17325', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.5}", 'results_path': None, 'is_moe': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:16702', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | model	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-09 22:06:57 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-09 22:06:57 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:57 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:57 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:57 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:57 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:57 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:06:57 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-09 22:06:57 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-09 22:06:57 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:00 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:01 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-09 22:07:24 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:25 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:25 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:25 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:25 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:25 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:26 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:26 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-09 22:07:50 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:08 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:09 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:09 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:09 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:14 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-09 22:08:25 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:25 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:25 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-09 22:08:31 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-09 22:08:41 | INFO | fairseq_cli.eval_lm | load time: 104.76 seconds
2024-07-09 22:09:02 | INFO | fairseq_cli.eval_lm | load time: 124.80 seconds
W0709 22:09:16.032230 139814839875392 torch/multiprocessing/spawn.py:145] Terminating process 636449 via signal SIGTERM
W0709 22:09:16.038271 139814839875392 torch/multiprocessing/spawn.py:145] Terminating process 636453 via signal SIGTERM
W0709 22:09:16.038645 139814839875392 torch/multiprocessing/spawn.py:145] Terminating process 636455 via signal SIGTERM
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 458, in <module>
    cli_main()
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 454, in cli_main
    distributed_utils.call_main(convert_namespace_to_omegaconf(args), main)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 351, in call_main
    torch.multiprocessing.spawn(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 281, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 237, in start_processes
    while not context.join():
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 169, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 1 terminated with signal SIGKILL
srun: error: t007-001: task 1: Exited with exit code 1
2024-07-09 22:09:23 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-09 22:09:33 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-09 22:09:47 | INFO | fairseq_cli.eval_lm | load time: 170.46 seconds
W0709 22:09:50.464198 139991290472256 torch/multiprocessing/spawn.py:145] Terminating process 2377503 via signal SIGTERM
W0709 22:09:51.308887 139991290472256 torch/multiprocessing/spawn.py:145] Terminating process 2377505 via signal SIGTERM
W0709 22:09:51.309222 139991290472256 torch/multiprocessing/spawn.py:145] Terminating process 2377507 via signal SIGTERM
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 458, in <module>
    cli_main()
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 454, in cli_main
    distributed_utils.call_main(convert_namespace_to_omegaconf(args), main)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 351, in call_main
    torch.multiprocessing.spawn(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 281, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 237, in start_processes
    while not context.join():
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 169, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 3 terminated with signal SIGKILL
srun: error: t007-002: task 7: Exited with exit code 1
2024-07-09 22:09:57 | INFO | fairseq_cli.eval_lm | load time: 181.11 seconds
2024-07-09 22:10:01 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-09 22:10:06 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:10:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5371.353271484375, gpu time: 5560.6063232421875
2024-07-09 22:10:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.393798828125, gpu time: 39.44527816772461
2024-07-09 22:10:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.6142578125, gpu time: 100.81551742553711
2024-07-09 22:10:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.373779296875, gpu time: 26.54287815093994
2024-07-09 22:10:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.381591796875, gpu time: 32.555519104003906
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:10:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.378662109375, gpu time: 28.06655788421631
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2024-07-09 22:10:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5371.9296875, gpu time: 5620.869359970093
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:10:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.74267578125, gpu time: 73.81087684631348
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2024-07-09 22:10:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.987548828125, gpu time: 191.33199977874756
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:10:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.75537109375, gpu time: 58.815195083618164
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:10:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.71826171875, gpu time: 116.84575653076172
2024-07-09 22:10:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 0.71728515625, gpu time: 59.075676918029785
2024-07-09 22:10:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5372.3017578125, gpu time: 5652.487917900085
2024-07-09 22:10:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.226806640625, gpu time: 98.80543518066406
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:10:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.324462890625, gpu time: 230.0780782699585
2024-07-09 22:10:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.191162109375, gpu time: 93.86671352386475
2024-07-09 22:10:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.1279296875, gpu time: 145.03647422790527
2024-07-09 22:10:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.043212890625, gpu time: 86.03535461425781
2024-07-09 22:10:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5372.832275390625, gpu time: 5692.467915534973
2024-07-09 22:10:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.637451171875, gpu time: 129.80799293518066
2024-07-09 22:10:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.677978515625, gpu time: 255.11071586608887
2024-07-09 22:10:25 | INFO | fairseq_cli.eval_lm | load time: 207.48 seconds
2024-07-09 22:10:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.51025390625, gpu time: 127.34031105041504
2024-07-09 22:10:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.45458984375, gpu time: 171.91615200042725
2024-07-09 22:10:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.411865234375, gpu time: 116.68511199951172
2024-07-09 22:10:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5373.20166015625, gpu time: 5731.664713859558
2024-07-09 22:10:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.00927734375, gpu time: 162.36783027648926
2024-07-09 22:10:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.43994140625, gpu time: 292.758394241333
2024-07-09 22:10:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.86962890625, gpu time: 152.75086879730225
2024-07-09 22:10:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.830810546875, gpu time: 209.2481508255005
W0709 22:10:26.989346 139713182123840 torch/multiprocessing/spawn.py:145] Terminating process 636460 via signal SIGTERM
W0709 22:10:27.031430 139713182123840 torch/multiprocessing/spawn.py:145] Terminating process 636461 via signal SIGTERM
W0709 22:10:27.031659 139713182123840 torch/multiprocessing/spawn.py:145] Terminating process 636463 via signal SIGTERM
2024-07-09 22:10:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.823974609375, gpu time: 141.07295036315918
2024-07-09 22:10:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5374.121826171875, gpu time: 5772.028071403503
W0709 22:10:27.363912 139931596904256 torch/multiprocessing/spawn.py:145] Terminating process 636464 via signal SIGTERM
W0709 22:10:27.407473 139931596904256 torch/multiprocessing/spawn.py:145] Terminating process 636466 via signal SIGTERM
W0709 22:10:27.407586 139931596904256 torch/multiprocessing/spawn.py:145] Terminating process 636467 via signal SIGTERM
2024-07-09 22:10:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.390380859375, gpu time: 197.50350856781006
2024-07-09 22:10:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.80078125, gpu time: 327.70415210723877
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 458, in <module>
    cli_main()
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 454, in cli_main
    distributed_utils.call_main(convert_namespace_to_omegaconf(args), main)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 351, in call_main
    torch.multiprocessing.spawn(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 281, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 237, in start_processes
    while not context.join():
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 188, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 75, in _wrap
    fn(i, *args)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 335, in distributed_main
    main(cfg, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 437, in main
    results, rr, end_time = eval_dataset(cfg, eval_split, task, models, start_time)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 322, in eval_dataset
    results = eval_lm(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 132, in eval_lm
    hypos = scorer.generate(models, sample)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/sequence_scorer.py", line 68, in generate
    decoder_out = model(**net_input)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/fairseq_model.py", line 508, in forward
    return self.decoder(src_tokens, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 930, in forward
    x, extra = self.extract_features(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 955, in extract_features
    return self.extract_features_scriptable(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 1016, in extract_features_scriptable
    x, layer_attn, _, l_aux_i = layer(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py", line 168, in _checkpointed_forward
    return original_forward(module, *args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/transformer_layer.py", line 568, in forward
    x, l_aux = self.moe_layer(x)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/moe_layer.py", line 253, in forward
    l_aux, combine_weights, dispatch_mask, self.metadata = self.gate(reshaped_input, reshaped_input_padding_mask)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 247, in forward
    return top2gating(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 197, in top2gating
    combine2_sec = torch.bmm(
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 4.00 GiB. GPU 

2024-07-09 22:10:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.3681640625, gpu time: 193.66286754608154
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 458, in <module>
    cli_main()
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 454, in cli_main
    distributed_utils.call_main(convert_namespace_to_omegaconf(args), main)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 351, in call_main
    torch.multiprocessing.spawn(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 281, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 237, in start_processes
    while not context.join():
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 188, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 75, in _wrap
    fn(i, *args)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 335, in distributed_main
    main(cfg, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 437, in main
    results, rr, end_time = eval_dataset(cfg, eval_split, task, models, start_time)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 322, in eval_dataset
    results = eval_lm(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 132, in eval_lm
    hypos = scorer.generate(models, sample)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/sequence_scorer.py", line 68, in generate
    decoder_out = model(**net_input)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/fairseq_model.py", line 508, in forward
    return self.decoder(src_tokens, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 930, in forward
    x, extra = self.extract_features(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 955, in extract_features
    return self.extract_features_scriptable(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 1016, in extract_features_scriptable
    x, layer_attn, _, l_aux_i = layer(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py", line 168, in _checkpointed_forward
    return original_forward(module, *args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/transformer_layer.py", line 568, in forward
    x, l_aux = self.moe_layer(x)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/moe_layer.py", line 253, in forward
    l_aux, combine_weights, dispatch_mask, self.metadata = self.gate(reshaped_input, reshaped_input_padding_mask)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 247, in forward
    return top2gating(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 197, in top2gating
    combine2_sec = torch.bmm(
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 4.00 GiB. GPU  has a total capacity of 63.98 GiB of which 2.60 GiB is free. Of the allocated memory 11.11 GiB is allocated by PyTorch, and 705.55 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-07-09 22:10:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.3076171875, gpu time: 243.62046909332275
2024-07-09 22:10:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.272216796875, gpu time: 173.65822792053223
2024-07-09 22:10:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5374.50732421875, gpu time: 5804.180709838867
2024-07-09 22:10:28 | INFO | fairseq_cli.eval_lm | load time: 211.07 seconds
2024-07-09 22:10:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.760498046875, gpu time: 232.43230724334717
2024-07-09 22:10:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.327392578125, gpu time: 361.1745500564575
2024-07-09 22:10:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.738525390625, gpu time: 227.60046482086182
2024-07-09 22:10:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.658203125, gpu time: 282.668625831604
2024-07-09 22:10:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.2724609375, gpu time: 206.07230472564697
srun: error: t007-001: task 3: Exited with exit code 1
2024-07-09 22:10:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5375.096923828125, gpu time: 5849.148387908936
srun: error: t007-001: task 2: Exited with exit code 1
2024-07-09 22:10:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.144287109375, gpu time: 263.6807851791382
2024-07-09 22:10:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.716552734375, gpu time: 392.5676689147949
2024-07-09 22:10:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.138671875, gpu time: 264.502703666687
2024-07-09 22:10:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.0380859375, gpu time: 314.36142349243164
2024-07-09 22:10:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.275390625, gpu time: 241.63182163238525
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 26 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
2024-07-09 22:10:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5375.802734375, gpu time: 5873.283905029297
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 26 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
2024-07-09 22:10:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.743408203125, gpu time: 289.0582218170166
2024-07-09 22:10:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.7353515625, gpu time: 610.6953468322754
2024-07-09 22:10:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.4765625, gpu time: 290.5719814300537
2024-07-09 22:10:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.893798828125, gpu time: 413.66238021850586
2024-07-09 22:10:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.797607421875, gpu time: 339.3998193740845
2024-07-09 22:10:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5376.425048828125, gpu time: 5937.046461105347
2024-07-09 22:10:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.17822265625, gpu time: 322.97469902038574
2024-07-09 22:10:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.112548828125, gpu time: 640.1615839004517
2024-07-09 22:10:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.89013671875, gpu time: 327.87837982177734
2024-07-09 22:10:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.26416015625, gpu time: 451.0761375427246
2024-07-09 22:10:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.1982421875, gpu time: 377.23309803009033
2024-07-09 22:10:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5377.135009765625, gpu time: 5968.257019042969
2024-07-09 22:10:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.92529296875, gpu time: 358.2708568572998
2024-07-09 22:10:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.67138671875, gpu time: 684.0035028457642
2024-07-09 22:10:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.278076171875, gpu time: 371.1204586029053
2024-07-09 22:10:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.6455078125, gpu time: 490.3263759613037
2024-07-09 22:10:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.575927734375, gpu time: 414.75517559051514
2024-07-09 22:10:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5377.5107421875, gpu time: 6011.370136260986
2024-07-09 22:10:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.814697265625, gpu time: 389.1394958496094
2024-07-09 22:10:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.362548828125, gpu time: 727.4902200698853
2024-07-09 22:10:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.8369140625, gpu time: 402.05981636047363
2024-07-09 22:10:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.070556640625, gpu time: 527.2847747802734
2024-07-09 22:10:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.9775390625, gpu time: 451.4057321548462
2024-07-09 22:10:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5377.89990234375, gpu time: 6049.193174362183
2024-07-09 22:10:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.236083984375, gpu time: 497.56813049316406
2024-07-09 22:10:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.6904296875, gpu time: 764.8425416946411
2024-07-09 22:10:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.818359375, gpu time: 451.66173362731934
2024-07-09 22:10:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.51171875, gpu time: 561.2129325866699
2024-07-09 22:10:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.33984375, gpu time: 475.55773067474365
2024-07-09 22:10:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5378.406494140625, gpu time: 6080.733012199402
2024-07-09 22:10:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.845703125, gpu time: 521.7231683731079
2024-07-09 22:10:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.326904296875, gpu time: 870.684624671936
2024-07-09 22:10:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.403076171875, gpu time: 561.255334854126
2024-07-09 22:10:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.0908203125, gpu time: 587.0606107711792
2024-07-09 22:10:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.056640625, gpu time: 499.8385305404663
2024-07-09 22:10:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5379.001220703125, gpu time: 6202.437808036804
2024-07-09 22:10:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.4091796875, gpu time: 551.1028480529785
2024-07-09 22:10:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.94580078125, gpu time: 894.7777452468872
2024-07-09 22:10:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.00830078125, gpu time: 671.1972560882568
2024-07-09 22:10:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.680908203125, gpu time: 611.2622108459473
2024-07-09 22:10:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.434814453125, gpu time: 631.0289297103882
2024-07-09 22:10:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5379.374267578125, gpu time: 6280.813168525696
2024-07-09 22:10:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.95263671875, gpu time: 586.7055673599243
2024-07-09 22:10:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.365966796875, gpu time: 933.9046258926392
2024-07-09 22:10:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.529052734375, gpu time: 699.579496383667
2024-07-09 22:10:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.047607421875, gpu time: 643.8417310714722
2024-07-09 22:10:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.796142578125, gpu time: 662.5578899383545
2024-07-09 22:10:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5379.745849609375, gpu time: 6312.1302881240845
2024-07-09 22:10:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.790771484375, gpu time: 613.9394874572754
2024-07-09 22:10:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.752197265625, gpu time: 964.108304977417
2024-07-09 22:10:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.872802734375, gpu time: 733.0105361938477
2024-07-09 22:10:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.397705078125, gpu time: 678.0577306747437
2024-07-09 22:10:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.14892578125, gpu time: 687.6764497756958
2024-07-09 22:10:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5380.096435546875, gpu time: 6339.650288581848
2024-07-09 22:10:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.8671875, gpu time: 646.3348474502563
2024-07-09 22:10:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.11181640625, gpu time: 1000.7593460083008
2024-07-09 22:10:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.213623046875, gpu time: 758.1329355239868
2024-07-09 22:10:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.769287109375, gpu time: 704.0372505187988
2024-07-09 22:10:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.492431640625, gpu time: 719.6846103668213
2024-07-09 22:10:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5380.513671875, gpu time: 6376.719089508057
2024-07-09 22:10:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.248046875, gpu time: 672.1103668212891
2024-07-09 22:10:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.463623046875, gpu time: 1027.8803062438965
2024-07-09 22:10:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.593994140625, gpu time: 789.3209352493286
2024-07-09 22:10:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.24560546875, gpu time: 734.288290977478
2024-07-09 22:10:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.90478515625, gpu time: 755.98108959198
2024-07-09 22:10:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5380.864990234375, gpu time: 6407.623571395874
2024-07-09 22:10:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.6044921875, gpu time: 702.587007522583
2024-07-09 22:10:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.5068359375, gpu time: 1059.6644659042358
2024-07-09 22:10:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.041015625, gpu time: 819.6660566329956
2024-07-09 22:10:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.6015625, gpu time: 765.155011177063
2024-07-09 22:10:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.512451171875, gpu time: 789.5937299728394
2024-07-09 22:10:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5381.2197265625, gpu time: 6440.529811859131
2024-07-09 22:10:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.31787109375, gpu time: 733.6508483886719
2024-07-09 22:10:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.852294921875, gpu time: 1097.4147062301636
2024-07-09 22:10:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.410400390625, gpu time: 854.7694158554077
2024-07-09 22:10:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.96240234375, gpu time: 803.0060510635376
2024-07-09 22:10:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.8759765625, gpu time: 821.6737308502197
2024-07-09 22:10:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5381.57080078125, gpu time: 6474.570774078369
2024-07-09 22:10:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.040771484375, gpu time: 764.795168876648
2024-07-09 22:10:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.459716796875, gpu time: 1128.8561458587646
2024-07-09 22:10:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.74267578125, gpu time: 884.9793357849121
2024-07-09 22:10:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.306884765625, gpu time: 833.7422103881836
2024-07-09 22:10:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.8349609375, gpu time: 859.6663703918457
2024-07-09 22:10:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5381.919921875, gpu time: 6511.521973609924
2024-07-09 22:10:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.38818359375, gpu time: 797.614688873291
2024-07-09 22:10:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.79541015625, gpu time: 1160.6798257827759
2024-07-09 22:10:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.093017578125, gpu time: 974.4326171875
2024-07-09 22:10:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.65185546875, gpu time: 862.2266912460327
2024-07-09 22:10:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.2939453125, gpu time: 896.65869140625
2024-07-09 22:10:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5382.27734375, gpu time: 6545.1474142074585
2024-07-09 22:10:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.733642578125, gpu time: 834.8958072662354
2024-07-09 22:10:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.136962890625, gpu time: 1211.71790599823
2024-07-09 22:10:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.428466796875, gpu time: 1002.2202978134155
2024-07-09 22:10:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.102783203125, gpu time: 899.2671718597412
2024-07-09 22:10:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.65380859375, gpu time: 924.2866926193237
2024-07-09 22:10:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5382.63232421875, gpu time: 6576.830775260925
2024-07-09 22:10:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.154296875, gpu time: 875.0921287536621
2024-07-09 22:10:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.47412109375, gpu time: 1244.4657459259033
2024-07-09 22:11:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.818603515625, gpu time: 1047.374056816101
2024-07-09 22:11:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.437744140625, gpu time: 939.7494125366211
2024-07-09 22:11:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.39501953125, gpu time: 965.3548517227173
2024-07-09 22:11:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5382.9921875, gpu time: 6607.762935638428
2024-07-09 22:11:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.50390625, gpu time: 899.9129304885864
2024-07-09 22:11:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.960693359375, gpu time: 1276.2599868774414
2024-07-09 22:11:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.162841796875, gpu time: 1077.7882995605469
2024-07-09 22:11:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.7861328125, gpu time: 974.7657337188721
2024-07-09 22:11:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.7412109375, gpu time: 996.2391738891602
2024-07-09 22:11:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5383.33837890625, gpu time: 6643.93173789978
2024-07-09 22:11:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.858642578125, gpu time: 930.9745321273804
2024-07-09 22:11:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.295654296875, gpu time: 1301.0982275009155
2024-07-09 22:11:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.49169921875, gpu time: 1109.6004610061646
2024-07-09 22:11:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.310791015625, gpu time: 1001.2023763656616
2024-07-09 22:11:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.081787109375, gpu time: 1033.9154968261719
2024-07-09 22:11:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5383.681884765625, gpu time: 6670.794139862061
2024-07-09 22:11:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.2021484375, gpu time: 965.6135749816895
2024-07-09 22:11:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.63232421875, gpu time: 1331.718069076538
2024-07-09 22:11:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.8330078125, gpu time: 1133.8943824768066
2024-07-09 22:11:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.751220703125, gpu time: 1034.8593368530273
2024-07-09 22:11:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.43212890625, gpu time: 1060.9817390441895
2024-07-09 22:11:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5384.046630859375, gpu time: 6703.073181152344
2024-07-09 22:11:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.539794921875, gpu time: 994.2929363250732
2024-07-09 22:11:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.9775390625, gpu time: 1364.8102321624756
2024-07-09 22:11:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.21044921875, gpu time: 1164.6335830688477
2024-07-09 22:11:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.1005859375, gpu time: 1059.0268592834473
2024-07-09 22:11:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.775146484375, gpu time: 1092.114860534668
2024-07-09 22:11:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5384.38818359375, gpu time: 6727.301342964172
2024-07-09 22:11:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.893798828125, gpu time: 1026.1842975616455
2024-07-09 22:11:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.818115234375, gpu time: 1390.0686349868774
2024-07-09 22:11:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.547607421875, gpu time: 1196.8663864135742
2024-07-09 22:11:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.434326171875, gpu time: 1090.0857391357422
2024-07-09 22:11:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.12158203125, gpu time: 1116.682222366333
2024-07-09 22:11:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5384.724365234375, gpu time: 6758.900223731995
2024-07-09 22:11:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.234130859375, gpu time: 1053.9806203842163
2024-07-09 22:11:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.14990234375, gpu time: 1421.7835178375244
2024-07-09 22:11:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.888427734375, gpu time: 1227.6793479919434
2024-07-09 22:11:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.7802734375, gpu time: 1130.1902198791504
2024-07-09 22:11:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.451171875, gpu time: 1147.7225465774536
2024-07-09 22:11:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5385.827392578125, gpu time: 6787.718144416809
2024-07-09 22:11:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.56591796875, gpu time: 1088.2129440307617
2024-07-09 22:11:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.697998046875, gpu time: 1459.7712001800537
2024-07-09 22:11:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.229248046875, gpu time: 1264.6484718322754
2024-07-09 22:11:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.12158203125, gpu time: 1160.287504196167
2024-07-09 22:11:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.799072265625, gpu time: 1178.0113496780396
2024-07-09 22:11:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5386.183837890625, gpu time: 6825.114468574524
2024-07-09 22:11:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.908447265625, gpu time: 1112.9334268569946
2024-07-09 22:11:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.03173828125, gpu time: 1491.8468837738037
2024-07-09 22:11:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.56884765625, gpu time: 1289.7118339538574
2024-07-09 22:11:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.463623046875, gpu time: 1191.7457466125488
2024-07-09 22:11:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.1435546875, gpu time: 1209.570074081421
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:11:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5386.52001953125, gpu time: 6850.619911193848
2024-07-09 22:11:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.380859375, gpu time: 1143.3841514587402
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2024-07-09 22:11:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.378173828125, gpu time: 1520.8267288208008
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:11:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.046875, gpu time: 1321.223035812378
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:11:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.8203125, gpu time: 1222.0204696655273
2024-07-09 22:11:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.553466796875, gpu time: 1246.4361591339111
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:11:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5386.854248046875, gpu time: 6881.586154937744
2024-07-09 22:11:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.7578125, gpu time: 1176.4574365615845
2024-07-09 22:11:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.8193359375, gpu time: 1558.7723331451416
2024-07-09 22:11:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.3974609375, gpu time: 1348.0193586349487
2024-07-09 22:11:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.138427734375, gpu time: 1259.945276260376
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:11:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.87548828125, gpu time: 1271.492961883545
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5387.202392578125, gpu time: 6913.419757843018
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.080322265625, gpu time: 1207.6635208129883
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.1435546875, gpu time: 1584.398736000061
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1964.04296875, gpu time: 1983.597812652588
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.337646484375, gpu time: 1379.1518421173096
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.364501953125, gpu time: 30.84865665435791
2024-07-09 22:11:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.471923828125, gpu time: 1283.9575996398926
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.743408203125, gpu time: 30.842254638671875
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.207763671875, gpu time: 1303.6739282608032
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.650146484375, gpu time: 32.1974573135376
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5387.516845703125, gpu time: 6938.500560760498
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.57177734375, gpu time: 37.195858001708984
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.39794921875, gpu time: 1245.7780876159668
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1.36279296875, gpu time: 25.767373085021973
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.466064453125, gpu time: 1615.9777793884277
W0709 22:11:16.952690 140141722781504 torch/multiprocessing/spawn.py:145] Terminating process 2377492 via signal SIGTERM
W0709 22:11:16.953360 140141722781504 torch/multiprocessing/spawn.py:145] Terminating process 2377496 via signal SIGTERM
W0709 22:11:16.953758 140141722781504 torch/multiprocessing/spawn.py:145] Terminating process 2377500 via signal SIGTERM
2024-07-09 22:11:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1966.055908203125, gpu time: 2012.2266273498535
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.663330078125, gpu time: 1408.0547256469727
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.1552734375, gpu time: 64.30531406402588
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.779541015625, gpu time: 1319.7065658569336
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.982666015625, gpu time: 77.95891952514648
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.52197265625, gpu time: 1340.9468936920166
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 458, in <module>
    cli_main()
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 454, in cli_main
    distributed_utils.call_main(convert_namespace_to_omegaconf(args), main)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 351, in call_main
    torch.multiprocessing.spawn(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 281, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 237, in start_processes
    while not context.join():
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 188, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 75, in _wrap
    fn(i, *args)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 335, in distributed_main
    main(cfg, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 437, in main
    results, rr, end_time = eval_dataset(cfg, eval_split, task, models, start_time)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 322, in eval_dataset
    results = eval_lm(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 132, in eval_lm
    hypos = scorer.generate(models, sample)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/sequence_scorer.py", line 68, in generate
    decoder_out = model(**net_input)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/fairseq_model.py", line 508, in forward
    return self.decoder(src_tokens, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 930, in forward
    x, extra = self.extract_features(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 955, in extract_features
    return self.extract_features_scriptable(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 1016, in extract_features_scriptable
    x, layer_attn, _, l_aux_i = layer(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py", line 168, in _checkpointed_forward
    return original_forward(module, *args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/transformer_layer.py", line 568, in forward
    x, l_aux = self.moe_layer(x)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/moe_layer.py", line 253, in forward
    l_aux, combine_weights, dispatch_mask, self.metadata = self.gate(reshaped_input, reshaped_input_padding_mask)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 247, in forward
    return top2gating(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 197, in top2gating
    combine2_sec = torch.bmm(
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 4.00 GiB. GPU  has a total capacity of 63.98 GiB of which 2.91 GiB is free. Of the allocated memory 11.11 GiB is allocated by PyTorch, and 705.55 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

W0709 22:11:17.657613 140397013903168 torch/multiprocessing/spawn.py:145] Terminating process 2377495 via signal SIGTERM
W0709 22:11:17.658182 140397013903168 torch/multiprocessing/spawn.py:145] Terminating process 2377498 via signal SIGTERM
W0709 22:11:17.658536 140397013903168 torch/multiprocessing/spawn.py:145] Terminating process 2377502 via signal SIGTERM
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.0361328125, gpu time: 70.47379684448242
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5387.874267578125, gpu time: 6974.371446609497
2024-07-09 22:11:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2.623291015625, gpu time: 67.9160327911377
2024-07-09 22:11:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.73046875, gpu time: 1277.0360136032104
2024-07-09 22:11:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.134033203125, gpu time: 59.548190116882324
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 458, in <module>
    cli_main()
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 454, in cli_main
    distributed_utils.call_main(convert_namespace_to_omegaconf(args), main)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 351, in call_main
    torch.multiprocessing.spawn(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 281, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 237, in start_processes
    while not context.join():
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 188, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/multiprocessing/spawn.py", line 75, in _wrap
    fn(i, *args)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py", line 335, in distributed_main
    main(cfg, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 437, in main
    results, rr, end_time = eval_dataset(cfg, eval_split, task, models, start_time)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 322, in eval_dataset
    results = eval_lm(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq_cli/eval_lm.py", line 132, in eval_lm
    hypos = scorer.generate(models, sample)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/sequence_scorer.py", line 68, in generate
    decoder_out = model(**net_input)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/fairseq_model.py", line 508, in forward
    return self.decoder(src_tokens, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 930, in forward
    x, extra = self.extract_features(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 955, in extract_features
    return self.extract_features_scriptable(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/models/transformer.py", line 1016, in extract_features_scriptable
    x, layer_attn, _, l_aux_i = layer(
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py", line 168, in _checkpointed_forward
    return original_forward(module, *args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/transformer_layer.py", line 568, in forward
    x, l_aux = self.moe_layer(x)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/moe_layer.py", line 253, in forward
    l_aux, combine_weights, dispatch_mask, self.metadata = self.gate(reshaped_input, reshaped_input_padding_mask)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 247, in forward
    return top2gating(
  File "/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/modules/moe/top2gate.py", line 197, in top2gating
    combine2_sec = torch.bmm(
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 4.00 GiB. GPU 

srun: error: t007-002: task 6: Exited with exit code 1
2024-07-09 22:11:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.781005859375, gpu time: 1650.7961854934692
2024-07-09 22:11:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1967.774658203125, gpu time: 2039.6660022735596
2024-07-09 22:11:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.013427734375, gpu time: 1443.4414501190186
2024-07-09 22:11:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.107666015625, gpu time: 1351.3848114013672
srun: error: t007-002: task 5: Exited with exit code 1
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.976318359375, gpu time: 92.40228843688965
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.993896484375, gpu time: 1375.5500993728638
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5388.220458984375, gpu time: 6998.955611228943
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.8603515625, gpu time: 1308.8852996826172
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.4423828125, gpu time: 184.51338005065918
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.18115234375, gpu time: 1677.2321891784668
2024-07-09 22:11:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.5703125, gpu time: 102.49669361114502
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.357177734375, gpu time: 1480.7844982147217
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.91015625, gpu time: 92.1886854171753
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.483154296875, gpu time: 1382.4177770614624
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 3.632080078125, gpu time: 89.25284481048584
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.864501953125, gpu time: 1405.4315433502197
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1969.0869140625, gpu time: 2064.034655570984
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5388.599853515625, gpu time: 7028.758177757263
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.086669921875, gpu time: 122.96582508087158
2024-07-09 22:11:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.208984375, gpu time: 1340.0320262908936
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.885009765625, gpu time: 210.38507270812988
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.6044921875, gpu time: 1734.6889991760254
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.868408203125, gpu time: 134.5152711868286
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.710693359375, gpu time: 1514.2485036849976
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 4.6982421875, gpu time: 130.82038593292236
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.821044921875, gpu time: 1419.9814653396606
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 15 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.7548828125, gpu time: 120.31493949890137
2024-07-09 22:11:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.26171875, gpu time: 1453.0753946304321
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1969.47216796875, gpu time: 2090.849868774414
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5388.951904296875, gpu time: 7068.884425163269
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.0625, gpu time: 148.02087879180908
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.549560546875, gpu time: 1371.9179515838623
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.0, gpu time: 236.8214054107666
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.258544921875, gpu time: 1768.6662855148315
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.49560546875, gpu time: 246.8423719406128
2024-07-09 22:11:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.044921875, gpu time: 1549.172191619873
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 37 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
2024-07-09 22:11:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.162353515625, gpu time: 1453.6667528152466
2024-07-09 22:11:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.68603515625, gpu time: 1488.477801322937
2024-07-09 22:11:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.989990234375, gpu time: 307.9399995803833
2024-07-09 22:11:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5389.3076171875, gpu time: 7103.060433387756
2024-07-09 22:11:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.631103515625, gpu time: 151.71751594543457
2024-07-09 22:11:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.895751953125, gpu time: 1410.0753993988037
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1970.565673828125, gpu time: 2127.4898891448975
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.6162109375, gpu time: 1807.1198930740356
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.233154296875, gpu time: 185.5045804977417
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.38427734375, gpu time: 1581.2557172775269
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.461181640625, gpu time: 274.33230209350586
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.514892578125, gpu time: 1487.738278388977
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5.911376953125, gpu time: 272.989426612854
2024-07-09 22:11:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.024658203125, gpu time: 1531.9718885421753
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.325927734375, gpu time: 346.8230619430542
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5389.655029296875, gpu time: 7131.3991594314575
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 7.991943359375, gpu time: 187.74537467956543
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.80126953125, gpu time: 1441.2928457260132
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1971.9921875, gpu time: 2156.978705406189
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.9814453125, gpu time: 1842.5477418899536
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.24072265625, gpu time: 226.16812229156494
2024-07-09 22:11:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.2333984375, gpu time: 1614.5843629837036
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.474853515625, gpu time: 312.6667251586914
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.339599609375, gpu time: 1524.3910856246948
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 6.972412109375, gpu time: 312.48480892181396
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.367919921875, gpu time: 1564.8322143554688
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.643798828125, gpu time: 371.49507427215576
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5390.0283203125, gpu time: 7158.388124465942
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.173583984375, gpu time: 1476.2096519470215
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.470703125, gpu time: 224.36763381958008
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.30615234375, gpu time: 1880.8866300582886
2024-07-09 22:11:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1973.037109375, gpu time: 2189.9158420562744
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.560791015625, gpu time: 1648.0784511566162
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.6875, gpu time: 253.05101585388184
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.672119140625, gpu time: 1562.0694932937622
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.812744140625, gpu time: 343.36914253234863
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.67822265625, gpu time: 1597.621340751648
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.09228515625, gpu time: 343.48514556884766
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5390.35546875, gpu time: 7195.518692016602
2024-07-09 22:11:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.1416015625, gpu time: 407.45381355285645
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.486328125, gpu time: 1510.1981391906738
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.312744140625, gpu time: 258.2820520401001
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.6572265625, gpu time: 1909.5906352996826
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1974.358154296875, gpu time: 2228.3200244903564
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.877685546875, gpu time: 1680.759575843811
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.4677734375, gpu time: 295.85039710998535
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.005859375, gpu time: 1594.2029390335083
2024-07-09 22:11:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.602783203125, gpu time: 367.70179557800293
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.005126953125, gpu time: 1637.9629487991333
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 8.518310546875, gpu time: 372.20244216918945
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5390.71630859375, gpu time: 7233.335821151733
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.88623046875, gpu time: 439.87543201446533
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.810302734375, gpu time: 1540.7495069503784
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.169677734375, gpu time: 282.4596652984619
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.974365234375, gpu time: 1941.6516027450562
2024-07-09 22:11:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1978.49072265625, gpu time: 2255.6102800369263
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.9775390625, gpu time: 1714.369981765747
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.9453125, gpu time: 328.62897396087646
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.638671875, gpu time: 1623.887264251709
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.48193359375, gpu time: 398.89349460601807
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.322265625, gpu time: 1673.6987962722778
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 9.365234375, gpu time: 398.45221614837646
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5391.03662109375, gpu time: 7264.878547668457
2024-07-09 22:11:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.404296875, gpu time: 464.05368518829346
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.77001953125, gpu time: 1577.7154340744019
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.334716796875, gpu time: 307.34207820892334
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.294921875, gpu time: 1979.5309705734253
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1980.034423828125, gpu time: 2280.060531616211
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.327392578125, gpu time: 1739.3602266311646
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.1298828125, gpu time: 433.27110385894775
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.988037109375, gpu time: 1658.2304725646973
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.389892578125, gpu time: 424.47478771209717
2024-07-09 22:11:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.657958984375, gpu time: 1706.1792840957642
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 10.625732421875, gpu time: 429.6082344055176
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5391.561767578125, gpu time: 7289.577752113342
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.30029296875, gpu time: 508.9186716079712
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.112060546875, gpu time: 1613.1212034225464
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.97998046875, gpu time: 334.908652305603
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.2138671875, gpu time: 2010.819296836853
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1981.078125, gpu time: 2306.0912656784058
2024-07-09 22:11:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.66845703125, gpu time: 1771.6757526397705
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.10009765625, gpu time: 468.3962411880493
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.343994140625, gpu time: 1696.0637607574463
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.132080078125, gpu time: 461.33480644226074
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.973876953125, gpu time: 1731.0423288345337
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.18310546875, gpu time: 453.9772071838379
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5391.97998046875, gpu time: 7325.746880531311
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.47998046875, gpu time: 1638.3872900009155
2024-07-09 22:11:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 11.684814453125, gpu time: 545.2204523086548
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.55419921875, gpu time: 2035.9666624069214
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.46484375, gpu time: 361.98770809173584
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.98974609375, gpu time: 1810.4922409057617
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1981.870849609375, gpu time: 2330.229679107666
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.6728515625, gpu time: 1724.1184883117676
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.459716796875, gpu time: 500.124737739563
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.301513671875, gpu time: 1756.8050556182861
2024-07-09 22:11:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.877197265625, gpu time: 492.3762617111206
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5392.311279296875, gpu time: 7356.989288330078
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.15283203125, gpu time: 484.77082347869873
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.822509765625, gpu time: 1670.9916162490845
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 12.16796875, gpu time: 574.3785467147827
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.903076171875, gpu time: 2068.8482694625854
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.9794921875, gpu time: 399.8181314468384
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.318115234375, gpu time: 1854.8517713546753
2024-07-09 22:11:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1983.128662109375, gpu time: 2354.953851699829
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.006103515625, gpu time: 1756.0628147125244
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.975830078125, gpu time: 537.4412384033203
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.6357421875, gpu time: 1805.5621871948242
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.2880859375, gpu time: 524.2455596923828
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5392.634521484375, gpu time: 7391.484655380249
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.656982421875, gpu time: 514.6893997192383
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.164306640625, gpu time: 1700.5989828109741
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.030029296875, gpu time: 605.7966442108154
2024-07-09 22:11:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.2373046875, gpu time: 2108.679320335388
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.33447265625, gpu time: 433.15190982818604
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.6611328125, gpu time: 1885.8807392120361
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1983.513916015625, gpu time: 2388.3154706954956
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.33203125, gpu time: 1804.250186920166
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.591064453125, gpu time: 562.5966119766235
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.951904296875, gpu time: 1842.9893970489502
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.908935546875, gpu time: 563.5563020706177
2024-07-09 22:11:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5392.9638671875, gpu time: 7418.320981025696
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.698486328125, gpu time: 545.3038177490234
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.58349609375, gpu time: 1739.2001104354858
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 13.76806640625, gpu time: 636.3400211334229
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.60302734375, gpu time: 2134.0850868225098
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.093994140625, gpu time: 576.2814302444458
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.981689453125, gpu time: 1916.790026664734
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1984.774658203125, gpu time: 2458.9699125289917
2024-07-09 22:11:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.671630859375, gpu time: 1836.2005939483643
2024-07-09 22:11:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.288818359375, gpu time: 1874.3868446350098
2024-07-09 22:11:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.574462890625, gpu time: 716.0983018875122
2024-07-09 22:11:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5393.349365234375, gpu time: 7449.381628036499
2024-07-09 22:11:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.921875, gpu time: 1764.9743556976318
2024-07-09 22:11:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.965576171875, gpu time: 744.2543230056763
2024-07-09 22:11:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.93798828125, gpu time: 2165.016613960266
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.3037109375, gpu time: 1948.150673866272
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.794189453125, gpu time: 805.8710174560547
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.5546875, gpu time: 1867.8422002792358
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.108642578125, gpu time: 806.0346775054932
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.40234375, gpu time: 1903.8903722763062
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5393.6962890625, gpu time: 7481.15203666687
2024-07-09 22:11:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.904052734375, gpu time: 698.07750415802
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.250244140625, gpu time: 1804.141565322876
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1986.044677734375, gpu time: 2491.9350509643555
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.277099609375, gpu time: 2196.802062034607
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.327880859375, gpu time: 757.2740030288696
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.6328125, gpu time: 1984.6492414474487
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.70849609375, gpu time: 768.6981754302979
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.88134765625, gpu time: 1893.8546867370605
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.14501953125, gpu time: 834.7335939407349
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.73095703125, gpu time: 1935.4146995544434
2024-07-09 22:11:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 14.43359375, gpu time: 843.3918209075928
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5394.05224609375, gpu time: 7513.845165252686
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.2333984375, gpu time: 730.4557609558105
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.609130859375, gpu time: 1837.0420532226562
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1987.26806640625, gpu time: 2521.4206676483154
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.620361328125, gpu time: 2231.796471595764
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.1220703125, gpu time: 786.6895408630371
2024-07-09 22:11:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.9541015625, gpu time: 2014.861888885498
2024-07-09 22:11:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.22509765625, gpu time: 1924.115816116333
2024-07-09 22:11:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.06103515625, gpu time: 792.9330701828003
2024-07-09 22:11:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.072021484375, gpu time: 1966.983829498291
2024-07-09 22:11:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.863037109375, gpu time: 859.0152082443237
2024-07-09 22:11:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5394.392333984375, gpu time: 7546.450294494629
2024-07-09 22:11:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.12744140625, gpu time: 1867.8703813552856
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 15.44384765625, gpu time: 871.1849575042725
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.938720703125, gpu time: 2264.1936016082764
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.522705078125, gpu time: 754.8082551956177
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.317626953125, gpu time: 2044.5802965164185
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.644775390625, gpu time: 1953.8646230697632
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1987.865478515625, gpu time: 2547.4747619628906
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.43505859375, gpu time: 1997.98335647583
2024-07-09 22:11:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.8095703125, gpu time: 810.8807544708252
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5394.857177734375, gpu time: 7576.6735010147095
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.451904296875, gpu time: 820.8374061584473
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.46240234375, gpu time: 1898.9943885803223
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.2216796875, gpu time: 889.8838663101196
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.276611328125, gpu time: 2293.500329017639
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 16.094482421875, gpu time: 896.1916923522949
2024-07-09 22:11:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.714111328125, gpu time: 2075.9819049835205
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.990966796875, gpu time: 1987.2894325256348
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.902099609375, gpu time: 787.8117952346802
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.767578125, gpu time: 2023.8563232421875
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1988.3349609375, gpu time: 2578.543420791626
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5395.2333984375, gpu time: 7610.876872062683
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.1513671875, gpu time: 920.2246685028076
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.803955078125, gpu time: 1930.4417562484741
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.731689453125, gpu time: 849.9190254211426
2024-07-09 22:11:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.680419921875, gpu time: 2322.810576438904
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.1328125, gpu time: 926.3387689590454
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.08056640625, gpu time: 2107.5542335510254
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.31298828125, gpu time: 2017.321762084961
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.267578125, gpu time: 926.7121925354004
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.1162109375, gpu time: 2062.287853240967
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.373046875, gpu time: 818.4706926345825
2024-07-09 22:11:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5395.580810546875, gpu time: 7642.282002449036
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1989.306884765625, gpu time: 2602.9039163589478
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.155517578125, gpu time: 1960.3121643066406
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.844482421875, gpu time: 944.4629230499268
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.029541015625, gpu time: 2354.3048248291016
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.663818359375, gpu time: 888.9992084503174
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.414306640625, gpu time: 2139.8209657669067
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.20654296875, gpu time: 957.3887071609497
2024-07-09 22:11:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.634033203125, gpu time: 2049.3486528396606
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.602783203125, gpu time: 1026.3677778244019
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.53564453125, gpu time: 2098.7382640838623
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 18.8515625, gpu time: 855.3588762283325
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5395.94921875, gpu time: 7677.684575080872
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.5068359375, gpu time: 1987.182412147522
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1989.715087890625, gpu time: 2627.293210029602
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.3466796875, gpu time: 2390.260995864868
2024-07-09 22:11:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.190673828125, gpu time: 970.0386190414429
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.746826171875, gpu time: 2164.195372581482
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.178466796875, gpu time: 913.4326639175415
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.988037109375, gpu time: 2086.9294652938843
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.611328125, gpu time: 981.7506418228149
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.0078125, gpu time: 2129.952995300293
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.847412109375, gpu time: 1050.6010732650757
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5396.313232421875, gpu time: 7709.756105422974
2024-07-09 22:11:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.20947265625, gpu time: 884.7428941726685
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.8984375, gpu time: 2018.007061958313
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1990.36279296875, gpu time: 2716.906392097473
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.693359375, gpu time: 2415.34676361084
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.2373046875, gpu time: 2193.0862607955933
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.361083984375, gpu time: 2112.481153488159
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.56787109375, gpu time: 1078.7662143707275
2024-07-09 22:11:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.347412109375, gpu time: 2160.9302864074707
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.7861328125, gpu time: 943.4024419784546
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5396.758544921875, gpu time: 7746.604917526245
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.897705078125, gpu time: 1011.223141670227
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.244384765625, gpu time: 2046.157470703125
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.30712890625, gpu time: 1087.870057106018
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.01806640625, gpu time: 2453.9290142059326
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 19.710205078125, gpu time: 919.3133153915405
2024-07-09 22:11:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.6484375, gpu time: 2218.128349304199
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.708251953125, gpu time: 2144.9520444869995
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1991.1083984375, gpu time: 2747.657130241394
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.70654296875, gpu time: 2189.651575088501
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.366455078125, gpu time: 1116.3414363861084
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5397.08740234375, gpu time: 7779.438848495483
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.10693359375, gpu time: 976.6543035507202
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.5751953125, gpu time: 2076.8571615219116
2024-07-09 22:11:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.609619140625, gpu time: 1041.1849212646484
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.3515625, gpu time: 2481.5901432037354
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.92431640625, gpu time: 1118.724796295166
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.989013671875, gpu time: 2249.8464403152466
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.452880859375, gpu time: 954.1925363540649
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.06298828125, gpu time: 2169.237332344055
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1991.969970703125, gpu time: 2780.6808319091797
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.046142578125, gpu time: 2220.505027770996
2024-07-09 22:11:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 20.858154296875, gpu time: 1148.0281763076782
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5397.43896484375, gpu time: 7804.7351770401
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.468017578125, gpu time: 1024.3456964492798
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.9013671875, gpu time: 2101.856209754944
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.39892578125, gpu time: 1071.8607816696167
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.7607421875, gpu time: 2506.3240718841553
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.278564453125, gpu time: 1149.3252964019775
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.3203125, gpu time: 2282.153172492981
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.51708984375, gpu time: 978.2922315597534
2024-07-09 22:11:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.45751953125, gpu time: 2198.8480615615845
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1992.74609375, gpu time: 2811.787410736084
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.375732421875, gpu time: 2245.9631156921387
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.49267578125, gpu time: 1172.8481922149658
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5397.784423828125, gpu time: 7830.694865226746
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.995361328125, gpu time: 1048.4525918960571
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.23193359375, gpu time: 2130.5411796569824
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.093017578125, gpu time: 2532.1420001983643
2024-07-09 22:11:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.1240234375, gpu time: 1096.0214366912842
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.650634765625, gpu time: 2306.393180847168
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.71875, gpu time: 1173.4984321594238
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.78515625, gpu time: 2223.663109779358
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.908203125, gpu time: 1003.4682474136353
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.71484375, gpu time: 2270.9442434310913
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1993.322509765625, gpu time: 2836.26486492157
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5398.137939453125, gpu time: 7855.747033119202
2024-07-09 22:11:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 21.8994140625, gpu time: 1196.9338073730469
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.81201171875, gpu time: 2155.3912677764893
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.016845703125, gpu time: 1072.5559663772583
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.463134765625, gpu time: 2557.5781688690186
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.525634765625, gpu time: 1120.1502523422241
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.020751953125, gpu time: 2331.3696699142456
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.11572265625, gpu time: 1197.734287261963
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.1162109375, gpu time: 2248.9323987960815
2024-07-09 22:11:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.050537109375, gpu time: 2296.8524131774902
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.24951171875, gpu time: 1027.787462234497
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5398.501953125, gpu time: 7880.6827211380005
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1994.44873046875, gpu time: 2860.6596002578735
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.14892578125, gpu time: 2183.9978380203247
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.68017578125, gpu time: 1221.2927026748657
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.78955078125, gpu time: 2585.4183387756348
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.603271484375, gpu time: 1096.5775814056396
2024-07-09 22:11:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.423583984375, gpu time: 2356.3051977157593
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.147216796875, gpu time: 1157.4416360855103
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.438232421875, gpu time: 2280.886011123657
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.39892578125, gpu time: 2322.0540227890015
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.9150390625, gpu time: 1229.1752672195435
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5398.84912109375, gpu time: 7912.263693809509
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 22.99951171875, gpu time: 1052.1588373184204
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.493408203125, gpu time: 2220.4095335006714
2024-07-09 22:12:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1995.3896484375, gpu time: 2888.141858100891
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.118408203125, gpu time: 2616.5948305130005
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.98876953125, gpu time: 1251.9447221755981
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.26318359375, gpu time: 2381.898166656494
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.538818359375, gpu time: 1127.1769609451294
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.776123046875, gpu time: 2306.0044202804565
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.80859375, gpu time: 1195.0997400283813
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.74365234375, gpu time: 2348.107792854309
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.65576171875, gpu time: 1260.12264919281
2024-07-09 22:12:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5399.177734375, gpu time: 7937.249623298645
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 23.990478515625, gpu time: 1084.5206184387207
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.82958984375, gpu time: 2256.40890789032
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1995.77587890625, gpu time: 2925.5498819351196
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.597412109375, gpu time: 2641.329560279846
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.55859375, gpu time: 1276.884578704834
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.58642578125, gpu time: 2413.2479391098022
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.4384765625, gpu time: 1157.2576217651367
2024-07-09 22:12:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.195556640625, gpu time: 2345.9393186569214
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.8671875, gpu time: 1221.2573585510254
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.072998046875, gpu time: 2379.943166732788
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.990234375, gpu time: 1285.1940259933472
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5399.52001953125, gpu time: 7967.621154785156
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.736572265625, gpu time: 1123.115683555603
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.1708984375, gpu time: 2286.601400375366
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1996.640869140625, gpu time: 2955.2382221221924
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.917236328125, gpu time: 2666.252770423889
2024-07-09 22:12:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 24.8994140625, gpu time: 1307.4810781478882
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.920166015625, gpu time: 2444.5500326156616
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.428466796875, gpu time: 1187.2298021316528
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.513916015625, gpu time: 2372.2158098220825
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.2666015625, gpu time: 1251.5533781051636
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.405517578125, gpu time: 2411.750539779663
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.797119140625, gpu time: 1317.934847831726
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5399.864013671875, gpu time: 8008.461812019348
2024-07-09 22:12:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.192626953125, gpu time: 1159.6157083511353
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.502685546875, gpu time: 2318.2628536224365
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1997.736328125, gpu time: 2989.5766439437866
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.239990234375, gpu time: 2702.3785429000854
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.28466796875, gpu time: 1339.542860031128
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.2861328125, gpu time: 2487.374690055847
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.78466796875, gpu time: 1219.4034242630005
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.845947265625, gpu time: 2398.0511798858643
2024-07-09 22:12:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.59716796875, gpu time: 1282.4111585617065
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.72900390625, gpu time: 2445.225914001465
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.857177734375, gpu time: 1344.1684656143188
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5400.25, gpu time: 8041.740863800049
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.542236328125, gpu time: 1189.026927947998
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.8232421875, gpu time: 2349.6742277145386
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1998.95849609375, gpu time: 3026.4201879501343
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.378662109375, gpu time: 2741.341279029846
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.84033203125, gpu time: 1370.0633602142334
2024-07-09 22:12:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.63671875, gpu time: 2513.6483011245728
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.14501953125, gpu time: 1251.578966140747
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.16943359375, gpu time: 2435.607036590576
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.547119140625, gpu time: 1313.9486179351807
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.160400390625, gpu time: 2475.752646446228
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.413330078125, gpu time: 1381.0228910446167
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5400.577392578125, gpu time: 8070.253355026245
2024-07-09 22:12:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.14404296875, gpu time: 2381.1449604034424
2024-07-09 22:12:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.759521484375, gpu time: 2776.320013999939
2024-07-09 22:12:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.192138671875, gpu time: 1213.3632640838623
2024-07-09 22:12:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.965087890625, gpu time: 2538.8204708099365
2024-07-09 22:12:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.5087890625, gpu time: 2474.767053604126
2024-07-09 22:12:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.503662109375, gpu time: 2507.527859687805
2024-07-09 22:12:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2000.603515625, gpu time: 3050.3859634399414
2024-07-09 22:12:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5400.939453125, gpu time: 8101.32984828949
2024-07-09 22:12:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.901123046875, gpu time: 1394.1147375106812
2024-07-09 22:12:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.481201171875, gpu time: 2406.4678506851196
2024-07-09 22:12:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.505126953125, gpu time: 1276.600263595581
2024-07-09 22:12:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.093017578125, gpu time: 2813.940670967102
2024-07-09 22:12:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.3251953125, gpu time: 2574.4707260131836
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.40283203125, gpu time: 2507.357147216797
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.16796875, gpu time: 1400.3890056610107
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.827392578125, gpu time: 2539.5817918777466
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.994140625, gpu time: 1405.2137880325317
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5401.26904296875, gpu time: 8133.8538608551025
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.09423828125, gpu time: 1237.7834405899048
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.83056640625, gpu time: 2443.7037057876587
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2001.662109375, gpu time: 3074.795100212097
2024-07-09 22:12:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.992431640625, gpu time: 2844.9093255996704
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.04541015625, gpu time: 1428.4941215515137
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.654541015625, gpu time: 2603.2844982147217
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.299560546875, gpu time: 1314.0330905914307
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.763427734375, gpu time: 2538.339719772339
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.912841796875, gpu time: 1434.7143096923828
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.197998046875, gpu time: 2569.7786045074463
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.749267578125, gpu time: 1434.201807975769
2024-07-09 22:12:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5401.6259765625, gpu time: 8160.379151344299
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.457763671875, gpu time: 1268.2217016220093
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.17578125, gpu time: 2478.585160255432
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2002.16455078125, gpu time: 3104.72935962677
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.33203125, gpu time: 2876.4323778152466
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.1376953125, gpu time: 1463.505184173584
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.713134765625, gpu time: 2633.4632329940796
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.502197265625, gpu time: 1348.4459133148193
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.11328125, gpu time: 2576.0230960845947
2024-07-09 22:12:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.248046875, gpu time: 1459.1188068389893
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.523193359375, gpu time: 2600.8101387023926
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.073974609375, gpu time: 1465.3165493011475
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5402.123291015625, gpu time: 8185.555962562561
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.83837890625, gpu time: 1299.3322830200195
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.51416015625, gpu time: 2516.877017021179
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2003.755615234375, gpu time: 3138.2511444091797
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.655029296875, gpu time: 2902.469988822937
2024-07-09 22:12:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.20947265625, gpu time: 1493.6218452453613
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.046630859375, gpu time: 2659.19540309906
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.58837890625, gpu time: 1386.523060798645
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.4404296875, gpu time: 2609.009828567505
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.003173828125, gpu time: 1497.1623554229736
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.85791015625, gpu time: 2626.5595893859863
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.415771484375, gpu time: 1494.9477701187134
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5402.4765625, gpu time: 8223.316779136658
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 28.69091796875, gpu time: 1329.5068645477295
2024-07-09 22:12:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.850341796875, gpu time: 2544.6328687667847
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2004.172607421875, gpu time: 3168.412925720215
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.08056640625, gpu time: 2931.677201271057
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.8369140625, gpu time: 1520.399624824524
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.431884765625, gpu time: 2690.264696121216
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.505615234375, gpu time: 1417.6914024353027
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.791259765625, gpu time: 2635.0445594787598
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.554443359375, gpu time: 1525.419337272644
2024-07-09 22:12:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.192138671875, gpu time: 2651.9407205581665
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.79296875, gpu time: 1521.6305084228516
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5402.842041015625, gpu time: 8267.354878425598
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.16015625, gpu time: 1354.0422410964966
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.179443359375, gpu time: 2569.554319381714
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2004.562744140625, gpu time: 3205.1081523895264
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.396484375, gpu time: 2963.407615661621
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.607177734375, gpu time: 1547.9658851623535
2024-07-09 22:12:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.7900390625, gpu time: 2718.9821491241455
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.01025390625, gpu time: 1442.000379562378
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.123779296875, gpu time: 2665.452572822571
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.5400390625, gpu time: 2682.557213783264
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.4111328125, gpu time: 1556.8252782821655
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5403.1962890625, gpu time: 8299.929773330688
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.45947265625, gpu time: 1546.044445991516
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.60205078125, gpu time: 2594.5844116210938
2024-07-09 22:12:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.491943359375, gpu time: 1378.1779384613037
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.72216796875, gpu time: 2993.282509803772
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2004.948974609375, gpu time: 3233.869772911072
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.284423828125, gpu time: 2746.798801422119
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.0888671875, gpu time: 1572.1201419830322
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.497802734375, gpu time: 2690.6652240753174
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.34912109375, gpu time: 1476.9882431030273
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.86669921875, gpu time: 2712.7207469940186
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.94580078125, gpu time: 1588.5928230285645
2024-07-09 22:12:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5403.565673828125, gpu time: 8325.183065414429
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.389404296875, gpu time: 1575.1820669174194
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.924560546875, gpu time: 2630.2135467529297
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 29.81591796875, gpu time: 1402.4232368469238
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.052978515625, gpu time: 3017.7932415008545
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2006.16796875, gpu time: 3258.8897914886475
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.6513671875, gpu time: 2778.014175415039
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.30224609375, gpu time: 1601.1710443496704
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.8369140625, gpu time: 2722.831479072571
2024-07-09 22:12:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.08740234375, gpu time: 1503.3889026641846
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.225341796875, gpu time: 2743.292441368103
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.424072265625, gpu time: 1615.3666038513184
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5403.980224609375, gpu time: 8350.010597229004
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.743408203125, gpu time: 1601.2918462753296
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.2705078125, gpu time: 2665.087802886963
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 30.58203125, gpu time: 1433.0989398956299
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.435791015625, gpu time: 3042.826533317566
2024-07-09 22:12:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2006.546630859375, gpu time: 3295.208540916443
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.009033203125, gpu time: 2809.0509901046753
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.54541015625, gpu time: 1632.7776279449463
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.18115234375, gpu time: 2747.5649309158325
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.818115234375, gpu time: 1534.0847663879395
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.57666015625, gpu time: 2780.9500589370728
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.877685546875, gpu time: 1645.6943044662476
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5404.328857421875, gpu time: 8382.041493415833
2024-07-09 22:12:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.0810546875, gpu time: 1625.571865081787
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.609130859375, gpu time: 2695.373257637024
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 31.3115234375, gpu time: 1460.3341608047485
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.755126953125, gpu time: 3074.4631872177124
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2006.952392578125, gpu time: 3325.8591270446777
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.358154296875, gpu time: 2837.719003677368
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.86767578125, gpu time: 1664.1066131591797
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.50537109375, gpu time: 2778.8854246139526
2024-07-09 22:12:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.156982421875, gpu time: 1561.161907196045
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.90234375, gpu time: 2811.9052734375
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.05322265625, gpu time: 1676.180088043213
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5404.6640625, gpu time: 8411.911427497864
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.794921875, gpu time: 1649.913324356079
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.939453125, gpu time: 2727.4351921081543
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.1337890625, gpu time: 1486.8997821807861
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.099365234375, gpu time: 3107.2652835845947
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2007.46533203125, gpu time: 3350.199625968933
2024-07-09 22:12:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.712890625, gpu time: 2868.11789894104
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.19091796875, gpu time: 1688.3611917495728
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.86474609375, gpu time: 2813.2782411575317
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.82373046875, gpu time: 1589.5688076019287
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.245849609375, gpu time: 2844.816809654236
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.25830078125, gpu time: 1703.4605884552002
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5405.02783203125, gpu time: 8442.882800102234
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.497802734375, gpu time: 1680.3043870925903
2024-07-09 22:12:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.260009765625, gpu time: 2763.1024074554443
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.508544921875, gpu time: 1602.4834022521973
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.43603515625, gpu time: 3132.037456512451
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2008.619384765625, gpu time: 3383.359972000122
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.155517578125, gpu time: 2893.047350883484
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.6484375, gpu time: 1719.0988159179688
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.2470703125, gpu time: 2851.619059562683
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.295654296875, gpu time: 1620.4038734436035
2024-07-09 22:12:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.600341796875, gpu time: 2869.9229021072388
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.579345703125, gpu time: 1742.9969387054443
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5405.4326171875, gpu time: 8475.162817955017
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.26953125, gpu time: 1712.821533203125
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.58251953125, gpu time: 2794.849464416504
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 32.826171875, gpu time: 1635.8240699768066
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.77685546875, gpu time: 3156.8870697021484
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2009.7880859375, gpu time: 3409.0558319091797
2024-07-09 22:12:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.609130859375, gpu time: 2929.912169456482
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.137451171875, gpu time: 1750.3391609191895
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.593994140625, gpu time: 2877.095711708069
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.618408203125, gpu time: 1653.0472602844238
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.030029296875, gpu time: 2895.1342735290527
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.687744140625, gpu time: 1775.8760051727295
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5405.796875, gpu time: 8506.966192245483
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.918701171875, gpu time: 2820.760678291321
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.600830078125, gpu time: 1743.810998916626
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.935791015625, gpu time: 3182.1216430664062
2024-07-09 22:12:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.352294921875, gpu time: 1669.9600973129272
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.965576171875, gpu time: 2963.64018535614
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2010.704833984375, gpu time: 3436.101773262024
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.922607421875, gpu time: 2908.9814891815186
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.453857421875, gpu time: 1781.1267051696777
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.353759765625, gpu time: 2927.6861305236816
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.48388671875, gpu time: 1683.7482461929321
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5406.14697265625, gpu time: 8538.710050582886
2024-07-09 22:12:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.23193359375, gpu time: 1814.065634727478
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.2939453125, gpu time: 2845.58500957489
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.40869140625, gpu time: 1775.9382257461548
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.25390625, gpu time: 3212.0315771102905
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.67333984375, gpu time: 1700.3009223937988
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.291015625, gpu time: 2994.924843788147
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2011.06689453125, gpu time: 3461.945954322815
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.262451171875, gpu time: 2934.406620979309
2024-07-09 22:12:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.85009765625, gpu time: 1805.3536043167114
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.67578125, gpu time: 2964.796230316162
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.2822265625, gpu time: 1714.9145107269287
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5406.495849609375, gpu time: 8562.843982696533
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.579833984375, gpu time: 1846.1551008224487
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.63720703125, gpu time: 2877.0258264541626
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.9736328125, gpu time: 1802.2974462509155
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.5732421875, gpu time: 3244.38423538208
2024-07-09 22:12:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 33.996337890625, gpu time: 1739.0539150238037
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.606201171875, gpu time: 3019.907416343689
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2011.626953125, gpu time: 3485.9901332855225
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.58935546875, gpu time: 2965.3104763031006
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.19921875, gpu time: 1845.347237586975
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.2685546875, gpu time: 2995.9661655426025
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.925048828125, gpu time: 1746.7998161315918
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5406.862060546875, gpu time: 8587.705114364624
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.423095703125, gpu time: 1874.7540035247803
2024-07-09 22:12:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.956787109375, gpu time: 2911.5756063461304
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.4384765625, gpu time: 1832.6429119110107
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.90576171875, gpu time: 3274.874493598938
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.643310546875, gpu time: 1775.8088245391846
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.930908203125, gpu time: 3046.068868637085
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2012.00830078125, gpu time: 3511.0365533828735
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 34.91064453125, gpu time: 3000.1220169067383
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.5126953125, gpu time: 1876.3962230682373
2024-07-09 22:12:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.6025390625, gpu time: 3021.078179359436
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.248779296875, gpu time: 1783.6851291656494
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5407.25390625, gpu time: 8619.015051841736
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.04248046875, gpu time: 1907.1837902069092
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.298828125, gpu time: 2939.751781463623
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.21142578125, gpu time: 1861.7214946746826
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.47021484375, gpu time: 3301.8453874588013
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.75439453125, gpu time: 1806.5738096237183
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.279296875, gpu time: 3076.3456830978394
2024-07-09 22:12:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2012.649658203125, gpu time: 3541.5300188064575
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.272705078125, gpu time: 3033.2719564437866
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.31591796875, gpu time: 1905.3925676345825
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.966796875, gpu time: 3046.1625118255615
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.821044921875, gpu time: 1807.9368286132812
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5408.20556640625, gpu time: 8651.565308570862
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.479736328125, gpu time: 1939.4566164016724
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.644287109375, gpu time: 2965.1874742507935
2024-07-09 22:12:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.523193359375, gpu time: 1892.662799835205
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.78515625, gpu time: 3333.15340423584
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.2822265625, gpu time: 1835.2160730361938
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.61865234375, gpu time: 3101.852897644043
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2013.02392578125, gpu time: 3573.9255657196045
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.607666015625, gpu time: 3062.780451774597
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.650390625, gpu time: 1932.6541900634766
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.308837890625, gpu time: 3079.1060485839844
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.230224609375, gpu time: 1834.314130783081
2024-07-09 22:12:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5408.549072265625, gpu time: 8676.41268157959
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.809326171875, gpu time: 1970.4899244308472
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.98388671875, gpu time: 2989.832607269287
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.869384765625, gpu time: 1917.9949808120728
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.122802734375, gpu time: 3364.6879806518555
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.640380859375, gpu time: 1872.821545600891
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.940185546875, gpu time: 3127.955951690674
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2013.40380859375, gpu time: 3599.302388191223
2024-07-09 22:12:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 35.938232421875, gpu time: 3094.296788215637
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.070556640625, gpu time: 1956.599970817566
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.654052734375, gpu time: 3107.372944831848
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.551025390625, gpu time: 1858.595591545105
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5408.896484375, gpu time: 8700.833974838257
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.323486328125, gpu time: 3021.40926361084
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.16748046875, gpu time: 1997.387866973877
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.44140625, gpu time: 3397.286720275879
2024-07-09 22:12:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.721923828125, gpu time: 1947.871488571167
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.29541015625, gpu time: 3152.9654054641724
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.5244140625, gpu time: 1905.9484539031982
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.2685546875, gpu time: 3131.711049079895
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2013.811279296875, gpu time: 3702.922797203064
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.97021484375, gpu time: 3132.382077217102
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.632080078125, gpu time: 2014.3784189224243
2024-07-09 22:12:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5409.213134765625, gpu time: 8734.728553771973
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.651611328125, gpu time: 3053.1275205612183
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.978271484375, gpu time: 1887.8004159927368
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.775146484375, gpu time: 3422.9580936431885
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.806640625, gpu time: 2037.3627824783325
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.621826171875, gpu time: 3183.4097414016724
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.124267578125, gpu time: 1972.666389465332
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.5927734375, gpu time: 3162.9112281799316
2024-07-09 22:12:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.330078125, gpu time: 3157.3673706054688
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.61328125, gpu time: 1992.7526893615723
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5409.67919921875, gpu time: 8760.707928657532
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2014.2119140625, gpu time: 3732.5652236938477
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.09130859375, gpu time: 3082.48353767395
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.176513671875, gpu time: 3447.9832277297974
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.8876953125, gpu time: 2178.6883277893066
2024-07-09 22:12:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.96240234375, gpu time: 3220.0449628829956
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.568359375, gpu time: 1912.838038444519
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 36.92236328125, gpu time: 3187.404360771179
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.648681640625, gpu time: 3184.8197050094604
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.790771484375, gpu time: 2140.529909133911
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5410.031005859375, gpu time: 8791.906348228455
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.9111328125, gpu time: 2001.898416519165
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.41259765625, gpu time: 3106.8313903808594
2024-07-09 22:12:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 39.169189453125, gpu time: 2125.9417724609375
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.511962890625, gpu time: 3474.5763626098633
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.31103515625, gpu time: 3251.929302215576
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2015.1591796875, gpu time: 3908.671618461609
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.262939453125, gpu time: 3212.2928562164307
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.545654296875, gpu time: 2209.92835521698
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.00048828125, gpu time: 3228.145651817322
2024-07-09 22:12:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.9287109375, gpu time: 2017.7203722000122
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5410.365966796875, gpu time: 8817.105563163757
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.741455078125, gpu time: 3134.693486213684
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.126953125, gpu time: 2171.501456260681
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.840087890625, gpu time: 3513.5021448135376
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.8349609375, gpu time: 2029.8550815582275
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.649169921875, gpu time: 3276.667395591736
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.222412109375, gpu time: 2149.94819355011
2024-07-09 22:12:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.709716796875, gpu time: 3238.7655115127563
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2016.154296875, gpu time: 3937.6985244750977
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.349609375, gpu time: 3262.852870941162
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 42.873046875, gpu time: 2240.4735021591187
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5410.72265625, gpu time: 8842.285097122192
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.25634765625, gpu time: 2049.7759218215942
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.089111328125, gpu time: 3161.5005416870117
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.159912109375, gpu time: 3549.6759271621704
2024-07-09 22:12:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.676513671875, gpu time: 2200.9306020736694
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.9892578125, gpu time: 3301.610770225525
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.638916015625, gpu time: 2059.7411890029907
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.039794921875, gpu time: 3270.463611602783
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.32373046875, gpu time: 2174.335253715515
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 40.6904296875, gpu time: 3302.4484119415283
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2016.646484375, gpu time: 3962.0771055221558
2024-07-09 22:12:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5411.171142578125, gpu time: 8867.19167137146
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.458251953125, gpu time: 3201.772087097168
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.220947265625, gpu time: 2272.355770111084
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.480224609375, gpu time: 3574.4695415496826
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.8642578125, gpu time: 2080.900270462036
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.372314453125, gpu time: 3326.4304637908936
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.410400390625, gpu time: 2299.2377319335938
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.40869140625, gpu time: 3306.799156188965
2024-07-09 22:12:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.168212890625, gpu time: 2084.238169670105
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.025390625, gpu time: 3327.4519472122192
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.639892578125, gpu time: 2212.695927619934
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 5411.52783203125, gpu time: 8897.66240978241
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2016.993896484375, gpu time: 4053.2103061676025
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.78125, gpu time: 3238.05611038208
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.54931640625, gpu time: 2298.098352432251
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.927978515625, gpu time: 3599.2922773361206
2024-07-09 22:12:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.693115234375, gpu time: 3357.391763687134
2024-07-09 22:12:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.656494140625, gpu time: 2181.452688217163
2024-07-09 22:12:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 38.747314453125, gpu time: 3338.456615447998
2024-07-09 22:12:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.795166015625, gpu time: 2323.691035270691
2024-07-09 22:12:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.3798828125, gpu time: 3353.0066804885864
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:12:48 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:12:48 | INFO | fairseq_cli.eval_lm | Evaluated 825,641 tokens in 181.3s (4554.16 tokens/s)
2024-07-09 22:12:48 | INFO | fairseq_cli.eval_lm | valid Loss (base 2): 2.9061, Perplexity: 7.50
2024-07-09 22:12:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.483154296875, gpu time: 2190.9353857040405
2024-07-09 22:12:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.004150390625, gpu time: 2245.813558578491
2024-07-09 22:12:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2017.370361328125, gpu time: 4082.8285732269287
2024-07-09 22:12:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.928466796875, gpu time: 2405.884532928467
2024-07-09 22:12:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.97607421875, gpu time: 2211.4279165267944
2024-07-09 22:12:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.687255859375, gpu time: 2421.1437644958496
2024-07-09 22:12:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.2568359375, gpu time: 2217.697650909424
2024-07-09 22:12:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.888671875, gpu time: 2355.4279079437256
2024-07-09 22:12:50 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2018.465576171875, gpu time: 4108.34027671814
2024-07-09 22:12:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.245361328125, gpu time: 2505.918867111206
2024-07-09 22:12:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.281005859375, gpu time: 2242.6778650283813
2024-07-09 22:12:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.233642578125, gpu time: 2452.9033126831055
2024-07-09 22:12:51 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.974609375, gpu time: 2321.556146621704
2024-07-09 22:12:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 44.541259765625, gpu time: 2387.9055376052856
2024-07-09 22:12:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2019.30810546875, gpu time: 4148.29231262207
2024-07-09 22:12:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.110595703125, gpu time: 2535.4745740890503
2024-07-09 22:12:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.6123046875, gpu time: 2273.769733428955
2024-07-09 22:12:52 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.5751953125, gpu time: 2484.8366231918335
2024-07-09 22:12:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.30859375, gpu time: 2353.0048151016235
2024-07-09 22:12:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.266357421875, gpu time: 2422.8311700820923
2024-07-09 22:12:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2019.68798828125, gpu time: 4180.945463180542
2024-07-09 22:12:53 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.428466796875, gpu time: 2573.4810094833374
2024-07-09 22:12:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.92431640625, gpu time: 2312.575689315796
2024-07-09 22:12:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.911865234375, gpu time: 2509.141125679016
2024-07-09 22:12:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.646728515625, gpu time: 2385.5867652893066
2024-07-09 22:12:54 | INFO | fairseq.modules.moe.moe_layer | cpu time: 45.899169921875, gpu time: 2459.587523460388
2024-07-09 22:12:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2020.4326171875, gpu time: 4211.689970970154
2024-07-09 22:12:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.069580078125, gpu time: 2608.3772020339966
2024-07-09 22:12:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.387939453125, gpu time: 2343.6973180770874
2024-07-09 22:12:55 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.239013671875, gpu time: 2539.3840341567993
2024-07-09 22:12:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.5439453125, gpu time: 2417.1871156692505
2024-07-09 22:12:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.226806640625, gpu time: 2488.505630493164
2024-07-09 22:12:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2020.8115234375, gpu time: 4244.490162849426
2024-07-09 22:12:56 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.50439453125, gpu time: 2640.183153152466
2024-07-09 22:12:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.879638671875, gpu time: 2385.5701570510864
2024-07-09 22:12:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.710693359375, gpu time: 2569.883741378784
2024-07-09 22:12:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.865478515625, gpu time: 2447.12602519989
2024-07-09 22:12:57 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.5498046875, gpu time: 2512.833333015442
2024-07-09 22:12:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2021.269775390625, gpu time: 4279.796118736267
2024-07-09 22:12:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 46.821533203125, gpu time: 2681.374713897705
2024-07-09 22:12:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.215087890625, gpu time: 2421.9757928848267
2024-07-09 22:12:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.028564453125, gpu time: 2600.57497215271
2024-07-09 22:12:58 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.727783203125, gpu time: 2477.402053833008
2024-07-09 22:12:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.319091796875, gpu time: 2537.2819957733154
2024-07-09 22:12:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2022.721923828125, gpu time: 4310.189106941223
2024-07-09 22:12:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.618408203125, gpu time: 2711.344982147217
2024-07-09 22:12:59 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.546875, gpu time: 2451.1092596054077
2024-07-09 22:13:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.345458984375, gpu time: 2631.983162879944
2024-07-09 22:13:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.0419921875, gpu time: 2506.066882133484
2024-07-09 22:13:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.181640625, gpu time: 2569.236587524414
2024-07-09 22:13:00 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2023.8544921875, gpu time: 4343.074098587036
2024-07-09 22:13:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 47.9306640625, gpu time: 2742.2947721481323
2024-07-09 22:13:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.873046875, gpu time: 2481.4372873306274
2024-07-09 22:13:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.66259765625, gpu time: 2661.8358306884766
2024-07-09 22:13:01 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.36669921875, gpu time: 2537.8649921417236
2024-07-09 22:13:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.143310546875, gpu time: 2601.089098930359
2024-07-09 22:13:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2024.22705078125, gpu time: 4373.623087882996
2024-07-09 22:13:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.2412109375, gpu time: 2772.423120498657
2024-07-09 22:13:02 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.194091796875, gpu time: 2509.9784355163574
2024-07-09 22:13:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.978271484375, gpu time: 2692.4328203201294
2024-07-09 22:13:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.69140625, gpu time: 2565.641499519348
2024-07-09 22:13:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.892578125, gpu time: 2626.3396825790405
2024-07-09 22:13:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2025.186279296875, gpu time: 4403.249995231628
2024-07-09 22:13:03 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.5556640625, gpu time: 2800.7049074172974
2024-07-09 22:13:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.51025390625, gpu time: 2545.2714309692383
2024-07-09 22:13:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.32763671875, gpu time: 2722.299250602722
2024-07-09 22:13:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.4716796875, gpu time: 2590.5615243911743
2024-07-09 22:13:04 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.3525390625, gpu time: 2657.1470737457275
2024-07-09 22:13:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2025.8408203125, gpu time: 4427.5956201553345
2024-07-09 22:13:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 48.90966796875, gpu time: 2839.8183851242065
2024-07-09 22:13:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.826171875, gpu time: 2572.3580179214478
2024-07-09 22:13:05 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.87744140625, gpu time: 2747.2200756073
2024-07-09 22:13:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.79443359375, gpu time: 2615.6359491348267
2024-07-09 22:13:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.6689453125, gpu time: 2681.9293384552
2024-07-09 22:13:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2026.221435546875, gpu time: 4451.772285461426
2024-07-09 22:13:06 | INFO | fairseq.modules.moe.moe_layer | cpu time: 49.760498046875, gpu time: 2868.8964948654175
2024-07-09 22:13:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.14599609375, gpu time: 2596.966522216797
2024-07-09 22:13:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.2021484375, gpu time: 2775.9220237731934
2024-07-09 22:13:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.106689453125, gpu time: 2639.889573097229
2024-07-09 22:13:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.307861328125, gpu time: 2710.9429683685303
2024-07-09 22:13:07 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2027.041259765625, gpu time: 4482.31919670105
2024-07-09 22:13:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.081298828125, gpu time: 2895.6531620025635
2024-07-09 22:13:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.4736328125, gpu time: 2628.7361555099487
2024-07-09 22:13:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.236572265625, gpu time: 2805.19837474823
2024-07-09 22:13:08 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.64208984375, gpu time: 2671.9913654327393
2024-07-09 22:13:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.625, gpu time: 2742.241400718689
2024-07-09 22:13:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2027.431884765625, gpu time: 4507.362421989441
2024-07-09 22:13:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.394775390625, gpu time: 2928.9827966690063
2024-07-09 22:13:09 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.7998046875, gpu time: 2659.6925077438354
2024-07-09 22:13:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.584716796875, gpu time: 2836.249768257141
2024-07-09 22:13:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.501953125, gpu time: 2703.3371591567993
2024-07-09 22:13:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.947509765625, gpu time: 2772.5417528152466
2024-07-09 22:13:10 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2028.673583984375, gpu time: 4532.996687889099
2024-07-09 22:13:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 50.750244140625, gpu time: 2961.440908432007
2024-07-09 22:13:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.674072265625, gpu time: 2685.553813934326
2024-07-09 22:13:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.968017578125, gpu time: 2868.2117223739624
2024-07-09 22:13:11 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.83935546875, gpu time: 2735.1418313980103
2024-07-09 22:13:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.480712890625, gpu time: 2797.025136947632
2024-07-09 22:13:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2029.052978515625, gpu time: 4564.940879821777
2024-07-09 22:13:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.0966796875, gpu time: 2993.435341835022
2024-07-09 22:13:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.139892578125, gpu time: 2709.8467988967896
2024-07-09 22:13:12 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.29541015625, gpu time: 2899.49223613739
2024-07-09 22:13:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.178466796875, gpu time: 2759.4178562164307
2024-07-09 22:13:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.799560546875, gpu time: 2831.702292442322
2024-07-09 22:13:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2029.441650390625, gpu time: 4591.880106925964
2024-07-09 22:13:13 | INFO | fairseq.modules.moe.moe_layer | cpu time: 51.9765625, gpu time: 3026.9649782180786
2024-07-09 22:13:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.88720703125, gpu time: 2739.7610692977905
2024-07-09 22:13:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.626708984375, gpu time: 2925.2631425857544
2024-07-09 22:13:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.513427734375, gpu time: 2790.375329017639
2024-07-09 22:13:14 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.127685546875, gpu time: 2857.0997591018677
2024-07-09 22:13:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2029.832763671875, gpu time: 4622.505739212036
2024-07-09 22:13:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 52.708740234375, gpu time: 3052.807243347168
2024-07-09 22:13:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.43896484375, gpu time: 2771.6921405792236
2024-07-09 22:13:15 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.95654296875, gpu time: 2950.2694091796875
2024-07-09 22:13:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.11962890625, gpu time: 2815.674234390259
2024-07-09 22:13:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.624755859375, gpu time: 2889.18235206604
2024-07-09 22:13:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2030.5556640625, gpu time: 4647.301285743713
2024-07-09 22:13:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.489013671875, gpu time: 3082.8251953125
2024-07-09 22:13:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.961181640625, gpu time: 2801.7436904907227
2024-07-09 22:13:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.798095703125, gpu time: 2976.8355169296265
2024-07-09 22:13:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.4560546875, gpu time: 2846.909468650818
2024-07-09 22:13:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.951171875, gpu time: 2913.2511768341064
2024-07-09 22:13:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2031.0078125, gpu time: 4678.622438430786
2024-07-09 22:13:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.8212890625, gpu time: 3110.1039447784424
2024-07-09 22:13:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.285888671875, gpu time: 2832.408363342285
2024-07-09 22:13:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.163330078125, gpu time: 3011.899552345276
2024-07-09 22:13:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.300048828125, gpu time: 2874.978138923645
2024-07-09 22:13:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.279052734375, gpu time: 2944.0536098480225
2024-07-09 22:13:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2031.939208984375, gpu time: 4702.988063812256
2024-07-09 22:13:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.152587890625, gpu time: 3140.8729372024536
2024-07-09 22:13:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.659423828125, gpu time: 2863.4301567077637
2024-07-09 22:13:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.49072265625, gpu time: 3037.097819328308
2024-07-09 22:13:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.638427734375, gpu time: 2899.934804916382
2024-07-09 22:13:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.8427734375, gpu time: 2971.348997116089
2024-07-09 22:13:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2032.31640625, gpu time: 4734.0516176223755
2024-07-09 22:13:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.657958984375, gpu time: 3170.850570678711
2024-07-09 22:13:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.995849609375, gpu time: 2891.1537075042725
2024-07-09 22:13:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.157470703125, gpu time: 3068.1109714508057
2024-07-09 22:13:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.958740234375, gpu time: 2924.0268297195435
2024-07-09 22:13:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.3701171875, gpu time: 3002.8095092773438
2024-07-09 22:13:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2032.71435546875, gpu time: 4767.191173553467
2024-07-09 22:13:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.072265625, gpu time: 3197.0144395828247
2024-07-09 22:13:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.349609375, gpu time: 2922.8713417053223
2024-07-09 22:13:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.896484375, gpu time: 3092.5333976745605
2024-07-09 22:13:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.71337890625, gpu time: 2955.020143508911
2024-07-09 22:13:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.114990234375, gpu time: 3038.6986684799194
2024-07-09 22:13:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2033.127197265625, gpu time: 4793.222882270813
2024-07-09 22:13:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.392333984375, gpu time: 3228.789993286133
2024-07-09 22:13:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.677001953125, gpu time: 2951.826253890991
2024-07-09 22:13:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.333984375, gpu time: 3126.119676589966
2024-07-09 22:13:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.05517578125, gpu time: 2979.377130508423
2024-07-09 22:13:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.44140625, gpu time: 3068.396622657776
2024-07-09 22:13:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2033.529296875, gpu time: 4818.536350250244
2024-07-09 22:13:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 55.71923828125, gpu time: 3268.494997024536
2024-07-09 22:13:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.09765625, gpu time: 2983.4576482772827
2024-07-09 22:13:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.665771484375, gpu time: 3150.7942638397217
2024-07-09 22:13:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.388916015625, gpu time: 3008.2262830734253
2024-07-09 22:13:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.86328125, gpu time: 3092.5976095199585
2024-07-09 22:13:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2033.927734375, gpu time: 4847.351101875305
2024-07-09 22:13:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.05224609375, gpu time: 3300.519991874695
2024-07-09 22:13:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.536865234375, gpu time: 3008.6837549209595
2024-07-09 22:13:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.007568359375, gpu time: 3182.2389392852783
2024-07-09 22:13:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.734375, gpu time: 3032.539270401001
2024-07-09 22:13:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.652099609375, gpu time: 3123.049322128296
2024-07-09 22:13:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2034.316650390625, gpu time: 4882.192902565002
2024-07-09 22:13:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.810546875, gpu time: 3327.571541786194
2024-07-09 22:13:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 56.863525390625, gpu time: 3040.71755027771
2024-07-09 22:13:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.333251953125, gpu time: 3213.3874530792236
2024-07-09 22:13:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.0703125, gpu time: 3063.2684240341187
2024-07-09 22:13:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.37158203125, gpu time: 3154.243437767029
2024-07-09 22:13:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2035.236083984375, gpu time: 4907.955170631409
2024-07-09 22:13:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.144775390625, gpu time: 3351.7330074310303
2024-07-09 22:13:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.188232421875, gpu time: 3072.238865852356
2024-07-09 22:13:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.112060546875, gpu time: 3243.096287727356
2024-07-09 22:13:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.404052734375, gpu time: 3093.833577156067
2024-07-09 22:13:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.726806640625, gpu time: 3183.0333890914917
2024-07-09 22:13:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2035.668701171875, gpu time: 4932.450238227844
2024-07-09 22:13:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.457275390625, gpu time: 3386.1253662109375
2024-07-09 22:13:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.02197265625, gpu time: 3097.978895187378
2024-07-09 22:13:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.452880859375, gpu time: 3276.6713647842407
2024-07-09 22:13:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.745849609375, gpu time: 3121.1670475006104
2024-07-09 22:13:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.059326171875, gpu time: 3213.8878211975098
2024-07-09 22:13:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2036.041015625, gpu time: 4964.979393959045
2024-07-09 22:13:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 57.782470703125, gpu time: 3416.391321182251
2024-07-09 22:13:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.339599609375, gpu time: 3123.521324157715
2024-07-09 22:13:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.77392578125, gpu time: 3310.712363243103
2024-07-09 22:13:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.29931640625, gpu time: 3145.992197036743
2024-07-09 22:13:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.378662109375, gpu time: 3243.229455947876
2024-07-09 22:13:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2036.405029296875, gpu time: 4992.675745010376
2024-07-09 22:13:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.101806640625, gpu time: 3441.516149520874
2024-07-09 22:13:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.65966796875, gpu time: 3159.890968322754
2024-07-09 22:13:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.099365234375, gpu time: 3337.0864725112915
2024-07-09 22:13:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.606201171875, gpu time: 3177.5357542037964
2024-07-09 22:13:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.699951171875, gpu time: 3274.1171731948853
2024-07-09 22:13:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2037.2685546875, gpu time: 5029.109868049622
2024-07-09 22:13:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 58.960693359375, gpu time: 3467.6049795150757
2024-07-09 22:13:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.311279296875, gpu time: 3189.18332195282
2024-07-09 22:13:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.765625, gpu time: 3364.8377056121826
2024-07-09 22:13:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.926513671875, gpu time: 3214.65371799469
2024-07-09 22:13:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.015869140625, gpu time: 3299.054322242737
2024-07-09 22:13:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2038.067626953125, gpu time: 5063.089907646179
2024-07-09 22:13:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.405517578125, gpu time: 3496.0582914352417
2024-07-09 22:13:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.632568359375, gpu time: 3213.785270690918
2024-07-09 22:13:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.05908203125, gpu time: 3389.191014289856
2024-07-09 22:13:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 61.715087890625, gpu time: 3244.0974321365356
2024-07-09 22:13:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.333740234375, gpu time: 3331.2084379196167
2024-07-09 22:13:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2038.531982421875, gpu time: 5093.804341316223
2024-07-09 22:13:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.738037109375, gpu time: 3520.6690397262573
2024-07-09 22:13:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 59.96630859375, gpu time: 3243.7843446731567
2024-07-09 22:13:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.40380859375, gpu time: 3419.643210411072
2024-07-09 22:13:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.463134765625, gpu time: 3275.1536293029785
2024-07-09 22:13:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.671142578125, gpu time: 3356.2740659713745
2024-07-09 22:13:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2038.9287109375, gpu time: 5126.09365940094
2024-07-09 22:13:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.30322265625, gpu time: 3550.886836051941
2024-07-09 22:13:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.30517578125, gpu time: 3273.9984588623047
2024-07-09 22:13:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.737548828125, gpu time: 3451.863567352295
2024-07-09 22:13:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.795166015625, gpu time: 3311.646632194519
2024-07-09 22:13:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 61.67431640625, gpu time: 3380.7044944763184
2024-07-09 22:13:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2039.32763671875, gpu time: 5158.432896614075
2024-07-09 22:13:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.674560546875, gpu time: 3586.413116455078
2024-07-09 22:13:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 60.76611328125, gpu time: 3298.5447273254395
2024-07-09 22:13:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 65.24560546875, gpu time: 3482.936406135559
2024-07-09 22:13:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 63.13134765625, gpu time: 3340.796905517578
2024-07-09 22:13:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.3505859375, gpu time: 3411.553650856018
2024-07-09 22:13:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2039.70068359375, gpu time: 5184.389086723328
2024-07-09 22:13:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 61.071533203125, gpu time: 3617.174913406372
2024-07-09 22:13:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 61.1015625, gpu time: 3329.2431631088257
2024-07-09 22:13:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 65.577392578125, gpu time: 3508.3365964889526
2024-07-09 22:13:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 63.736083984375, gpu time: 3376.4428691864014
2024-07-09 22:13:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.69580078125, gpu time: 3437.2980012893677
2024-07-09 22:13:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2040.08447265625, gpu time: 5216.154085159302
2024-07-09 22:13:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 61.642822265625, gpu time: 3646.392228126526
2024-07-09 22:13:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 61.43017578125, gpu time: 3359.884160041809
2024-07-09 22:13:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 66.367919921875, gpu time: 3537.6204719543457
2024-07-09 22:13:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.076171875, gpu time: 3407.756507873535
2024-07-09 22:13:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 63.0234375, gpu time: 3468.8191566467285
2024-07-09 22:13:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2040.446044921875, gpu time: 5246.553639411926
2024-07-09 22:13:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.00048828125, gpu time: 3671.8159379959106
2024-07-09 22:13:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.266357421875, gpu time: 3388.5185956954956
2024-07-09 22:13:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 66.715576171875, gpu time: 3568.7870693206787
2024-07-09 22:13:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.400634765625, gpu time: 3433.2005376815796
2024-07-09 22:13:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 63.35888671875, gpu time: 3506.1856002807617
2024-07-09 22:13:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2040.90869140625, gpu time: 5271.689827919006
2024-07-09 22:13:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.319580078125, gpu time: 3702.588613510132
2024-07-09 22:13:46 | INFO | fairseq.modules.moe.moe_layer | cpu time: 63.255126953125, gpu time: 3412.6811847686768
2024-07-09 22:13:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 67.066162109375, gpu time: 3601.287109375
2024-07-09 22:13:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.7392578125, gpu time: 3470.0146646499634
2024-07-09 22:13:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 64.35791015625, gpu time: 3530.394109725952
2024-07-09 22:13:47 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2041.3115234375, gpu time: 5301.005542755127
2024-07-09 22:13:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 62.644287109375, gpu time: 3733.0958490371704
2024-07-09 22:13:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 63.614990234375, gpu time: 3443.8317832946777
2024-07-09 22:13:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 67.382568359375, gpu time: 3632.029227256775
2024-07-09 22:13:48 | INFO | fairseq.modules.moe.moe_layer | cpu time: 65.073974609375, gpu time: 3501.0279817581177
2024-07-09 22:13:49 | INFO | fairseq.modules.moe.moe_layer | cpu time: 65.170166015625, gpu time: 3556.7189407348633
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:13:49 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-09 22:13:49 | INFO | fairseq_cli.eval_lm | Evaluated 825,641 tokens in 204.0s (4046.86 tokens/s)
2024-07-09 22:13:49 | INFO | fairseq_cli.eval_lm | valid Loss (base 2): 2.9061, Perplexity: 7.50
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 4 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
