2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:13260
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:13260
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:13260
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:13260
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 3
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 1
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 2
2024-07-11 01:33:51 | INFO | fairseq.distributed.utils | initialized host t008-001.hpcfund as rank 0
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
/work1/amd/hongmfei/moespace/SPEED-main/fairseq/fairseq/distributed/utils.py:279: UserWarning: expandable_segments not supported on this platform (Triggered internally at ../c10/hip/HIPAllocatorConfig.h:29.)
  dist.all_reduce(torch.zeros(1).cuda())
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | cfg:
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | _name	None
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | common	{'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 100, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | common_eval	{'_name': None, 'path': '/work1/amd/hongmfei/models/en_moe_lm_15b/model.pt', 'post_process': None, 'quiet': False, 'model_overrides': "{'world_size': 4, 'moe_eval_capacity_token_fraction': 0.05}", 'results_path': None, 'is_moe': True}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | distributed_training	{'_name': None, 'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:13260', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': False, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'distributed_num_procs': 4}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | dataset	{'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'valid', 'num_shards': 1, 'shard_id': 0}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | optimization	{'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | checkpoint	{'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | bmuf	{'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | generation	{'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | eval_lm	{'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 2048, 'stats_path': None, 'max_valid_steps': 100}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | interactive	{'_name': None, 'buffer_size': 0, 'input': '-'}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | model	None
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | task	{'_name': 'language_modeling', 'data': '/work1/amd/hongmfei/raw_data/data-bin/wiki/', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_source_positions': None, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 100, 'batch_size': 1, 'batch_size_valid': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | criterion	{'_name': 'cross_entropy', 'sentence_avg': True}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | optimizer	None
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | lr_scheduler	{'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | scoring	{'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | bpe	{'_name': 'gpt2', 'gpt2_encoder_json': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', 'gpt2_vocab_bpe': 'https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe'}
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | tokenizer	None
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | simul_type	None
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | ---------------------------
2024-07-11 01:33:51 | INFO | fairseq_cli.eval_lm | loading model(s) from /work1/amd/hongmfei/models/en_moe_lm_15b/model.pt
2024-07-11 01:33:51 | INFO | fairseq.tasks.language_modeling | dictionary: 51200 types
2024-07-11 01:33:51 | INFO | fairseq.checkpoint_utils | load_model_ensemble_and_task is_moe=True
2024-07-11 01:33:51 | INFO | fairseq.moe_checkpoint_utils | Found total 64 expert files and current distributed world size: 4, Stitching experts to able to load on current world size.
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=0
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=1
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=2
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=3
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=4
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=5
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=6
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=7
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=8
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=9
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=10
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=11
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=12
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=13
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=14
2024-07-11 01:33:53 | INFO | fairseq.moe_checkpoint_utils | found 8 local experts in expert_group_id=15
2024-07-11 01:33:56 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:33:59 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:34:02 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:34:04 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:34:07 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:34:10 | INFO | fairseq.modules.moe.moe_layer | Rank: 0
2024-07-11 01:34:12 | INFO | fairseq_cli.eval_lm | num. model params: 3,725,230,080
2024-07-11 01:34:20 | INFO | fairseq.data.data_utils | loaded 1,482,831,152 examples from: /work1/amd/hongmfei/raw_data/data-bin/wiki/valid
2024-07-11 01:34:28 | INFO | fairseq_cli.eval_lm | /work1/amd/hongmfei/raw_data/data-bin/wiki/ valid 17,792,645 examples
2024-07-11 01:34:48 | INFO | fairseq_cli.eval_lm | load time: 56.92 seconds
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
/work1/amd/hongmfei/moespace/.moefair/lib64/python3.9/site-packages/torch/nn/functional.py:5504: UserWarning: 1Torch was not compiled with memory efficient attention. (Triggered internally at ../aten/src/ATen/native/transformers/hip/sdp_utils.cpp:505.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
New cuda time: 2.4502511024475098
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6171319484710693
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 17.92333984375, gpu time: 5.067383050918579
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 80.46875
Expert2 overflow: 81.884765625
Expert1 unused count: 405
Expert2 unused count: 418
Expert1 balance top: 99.8046875
Expert2 balance top: 100.0

New cuda time: 2.620012044906616
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461611032485962
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 43.8671875, gpu time: 5.081623077392578
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 75.634765625
Expert2 overflow: 76.318359375
Expert1 unused count: 410
Expert2 unused count: 406
Expert1 balance top: 100.0
Expert2 balance top: 99.853515625

New cuda time: 2.4590508937835693
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.538412094116211
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 25.678466796875, gpu time: 4.99746298789978
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 80.46875
Expert2 overflow: 76.025390625
Expert1 unused count: 399
Expert2 unused count: 405
Expert1 balance top: 99.51171875
Expert2 balance top: 99.8046875

New cuda time: 2.4697721004486084
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6620919704437256
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 37.19970703125, gpu time: 5.1318628787994385
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 80.46875
Expert2 overflow: 76.953125
Expert1 unused count: 407
Expert2 unused count: 409
Expert1 balance top: 99.90234375
Expert2 balance top: 100.0

New cuda time: 2.462891101837158
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4524919986724854
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 27.127685546875, gpu time: 4.9153831005096436
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 71.044921875
Expert2 overflow: 79.736328125
Expert1 unused count: 402
Expert2 unused count: 393
Expert1 balance top: 99.658203125
Expert2 balance top: 99.21875

New cuda time: 2.4552109241485596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484812021255493
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 26.1708984375, gpu time: 4.940022945404053
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 70.361328125
Expert2 overflow: 76.220703125
Expert1 unused count: 415
Expert2 unused count: 396
Expert1 balance top: 100.0
Expert2 balance top: 99.365234375

New cuda time: 2.4684910774230957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812920093536377
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 41.464111328125, gpu time: 10.017166137695312
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.302734375
Expert1 unused count: 158
Expert2 unused count: 285
Expert1 balance top: 73.2421875
Expert2 balance top: 91.845703125

New cuda time: 2.4436910152435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4744110107421875
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 71.694091796875, gpu time: 9.999725103378296
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 3.41796875
Expert1 unused count: 179
Expert2 unused count: 303
Expert1 balance top: 77.294921875
Expert2 balance top: 92.96875

New cuda time: 2.4686520099639893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.543210983276367
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 53.607177734375, gpu time: 10.009325981140137
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.326171875
Expert1 unused count: 180
Expert2 unused count: 303
Expert1 balance top: 76.611328125
Expert2 balance top: 92.236328125

New cuda time: 2.4144110679626465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4795310497283936
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 65.0751953125, gpu time: 10.025804996490479
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.955078125
Expert2 overflow: 10.400390625
Expert1 unused count: 210
Expert2 unused count: 263
Expert1 balance top: 80.2734375
Expert2 balance top: 88.720703125

New cuda time: 2.4420909881591797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4849720001220703
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.881103515625, gpu time: 9.842446088790894
2024-07-11 01:35:16 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 9.912109375
Expert1 unused count: 236
Expert2 unused count: 265
Expert1 balance top: 83.740234375
Expert2 balance top: 89.501953125

New cuda time: 2.448331117630005
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5315310955047607
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 54.0947265625, gpu time: 9.919885158538818
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.076171875
Expert2 overflow: 6.884765625
Expert1 unused count: 230
Expert2 unused count: 246
Expert1 balance top: 84.375
Expert2 balance top: 85.302734375

New cuda time: 2.464811086654663
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5112109184265137
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 66.667724609375, gpu time: 14.99318814277649
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.791015625
Expert1 unused count: 154
Expert2 unused count: 273
Expert1 balance top: 74.267578125
Expert2 balance top: 89.697265625

New cuda time: 2.4528110027313232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475532054901123
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 99.515869140625, gpu time: 14.928068161010742
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.32421875
Expert1 unused count: 179
Expert2 unused count: 296
Expert1 balance top: 77.001953125
Expert2 balance top: 92.87109375

New cuda time: 2.433290958404541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.538252115249634
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 81.737548828125, gpu time: 14.980869054794312
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.83984375
Expert1 unused count: 186
Expert2 unused count: 270
Expert1 balance top: 77.05078125
Expert2 balance top: 91.064453125

New cuda time: 2.4489710330963135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.513292074203491
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 93.279052734375, gpu time: 14.988068103790283
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.712890625
Expert1 unused count: 202
Expert2 unused count: 260
Expert1 balance top: 79.736328125
Expert2 balance top: 88.427734375

New cuda time: 2.4675309658050537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.59249210357666
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 92.527587890625, gpu time: 14.902469158172607
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 19.970703125
Expert1 unused count: 222
Expert2 unused count: 256
Expert1 balance top: 81.298828125
Expert2 balance top: 88.427734375

New cuda time: 2.448331117630005
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4752120971679688
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 82.044189453125, gpu time: 14.843428373336792
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.83984375
Expert1 unused count: 261
Expert2 unused count: 274
Expert1 balance top: 84.47265625
Expert2 balance top: 87.451171875

New cuda time: 2.4531309604644775
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5043320655822754
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 93.078125, gpu time: 19.950651168823242
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.375
Expert1 unused count: 159
Expert2 unused count: 304
Expert1 balance top: 71.533203125
Expert2 balance top: 92.87109375

New cuda time: 2.4673709869384766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4873709678649902
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 127.710693359375, gpu time: 19.882811069488525
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.439453125
Expert1 unused count: 171
Expert2 unused count: 305
Expert1 balance top: 74.0234375
Expert2 balance top: 91.943359375

New cuda time: 2.446410894393921
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.529771089553833
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 109.900390625, gpu time: 19.957051038742065
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.716796875
Expert1 unused count: 179
Expert2 unused count: 309
Expert1 balance top: 74.462890625
Expert2 balance top: 92.626953125

New cuda time: 2.489931106567383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.628812074661255
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 131.2060546875, gpu time: 20.10681128501892
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 9.130859375
Expert1 unused count: 194
Expert2 unused count: 286
Expert1 balance top: 78.662109375
Expert2 balance top: 89.794921875

New cuda time: 2.4548909664154053
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4678521156311035
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 120.949951171875, gpu time: 19.825212240219116
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.568359375
Expert1 unused count: 226
Expert2 unused count: 259
Expert1 balance top: 82.080078125
Expert2 balance top: 89.16015625

New cuda time: 2.45569109916687
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4873709678649902
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 110.3193359375, gpu time: 19.786490440368652
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.22265625
Expert2 overflow: 8.10546875
Expert1 unused count: 258
Expert2 unused count: 255
Expert1 balance top: 85.107421875
Expert2 balance top: 85.546875

New cuda time: 2.4472110271453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4915308952331543
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 118.720947265625, gpu time: 24.889393091201782
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 8.203125
Expert1 unused count: 257
Expert2 unused count: 314
Expert1 balance top: 85.15625
Expert2 balance top: 93.798828125

New cuda time: 2.4564919471740723
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5121710300445557
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 155.7939453125, gpu time: 24.851474046707153
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.28125
Expert1 unused count: 298
Expert2 unused count: 344
Expert1 balance top: 90.33203125
Expert2 balance top: 96.484375

New cuda time: 2.4776110649108887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484330892562866
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 138.04248046875, gpu time: 24.91899299621582
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 14.111328125
Expert1 unused count: 298
Expert2 unused count: 328
Expert1 balance top: 89.6484375
Expert2 balance top: 94.53125

New cuda time: 2.4217710494995117
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485930919647217
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 160.2861328125, gpu time: 25.01451325416565
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.15625
Expert1 unused count: 296
Expert2 unused count: 317
Expert1 balance top: 88.96484375
Expert2 balance top: 92.724609375

New cuda time: 2.431051015853882
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4612910747528076
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 149.054443359375, gpu time: 24.717554330825806
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 22.900390625
Expert1 unused count: 311
Expert2 unused count: 339
Expert1 balance top: 88.96484375
Expert2 balance top: 94.140625

New cuda time: 2.447371006011963
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4774510860443115
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 138.749755859375, gpu time: 24.711312532424927
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.78125
Expert2 overflow: 18.75
Expert1 unused count: 333
Expert2 unused count: 323
Expert1 balance top: 93.603515625
Expert2 balance top: 93.212890625

New cuda time: 2.4337708950042725
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4832119941711426
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 146.01220703125, gpu time: 29.806375980377197
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.697265625
Expert1 unused count: 156
Expert2 unused count: 281
Expert1 balance top: 74.12109375
Expert2 balance top: 91.650390625

New cuda time: 2.431051015853882
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4963319301605225
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 184.065673828125, gpu time: 29.778856992721558
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 5.908203125
Expert1 unused count: 176
Expert2 unused count: 299
Expert1 balance top: 78.369140625
Expert2 balance top: 93.212890625

New cuda time: 2.4987308979034424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466571092605591
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | cpu time: 166.1611328125, gpu time: 29.88429617881775
2024-07-11 01:35:17 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 22.8515625
Expert1 unused count: 198
Expert2 unused count: 314
Expert1 balance top: 78.759765625
Expert2 balance top: 94.287109375

New cuda time: 2.4508910179138184
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5163309574127197
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 188.85498046875, gpu time: 29.981735229492188
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.861328125
Expert1 unused count: 206
Expert2 unused count: 286
Expert1 balance top: 80.56640625
Expert2 balance top: 90.72265625

New cuda time: 2.5150508880615234
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.603372097015381
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 186.8232421875, gpu time: 29.83597731590271
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 17.3828125
Expert1 unused count: 220
Expert2 unused count: 260
Expert1 balance top: 82.080078125
Expert2 balance top: 89.599609375

New cuda time: 2.455051898956299
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5393710136413574
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 167.135986328125, gpu time: 29.705735445022583
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 6.103515625
Expert1 unused count: 234
Expert2 unused count: 255
Expert1 balance top: 85.25390625
Expert2 balance top: 85.693359375

New cuda time: 2.4212911128997803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4886510372161865
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 171.439697265625, gpu time: 34.716318130493164
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.9296875
Expert2 overflow: 3.02734375
Expert1 unused count: 267
Expert2 unused count: 338
Expert1 balance top: 88.037109375
Expert2 balance top: 96.240234375

New cuda time: 2.464811086654663
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854509830474854
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 212.158447265625, gpu time: 34.729119062423706
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.0546875
Expert2 overflow: 8.984375
Expert1 unused count: 303
Expert2 unused count: 347
Expert1 balance top: 92.67578125
Expert2 balance top: 96.240234375

New cuda time: 2.5049710273742676
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5081710815429688
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 194.533203125, gpu time: 34.897438287734985
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.224609375
Expert2 overflow: 6.640625
Expert1 unused count: 314
Expert2 unused count: 339
Expert1 balance top: 92.7734375
Expert2 balance top: 95.21484375

New cuda time: 2.4478509426116943
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469611883163452
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 217.09619140625, gpu time: 34.899198055267334
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 6.787109375
Expert1 unused count: 346
Expert2 unused count: 343
Expert1 balance top: 95.166015625
Expert2 balance top: 94.140625

New cuda time: 2.6084909439086914
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812910556793213
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 224.65869140625, gpu time: 34.92575931549072
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 25.1953125
Expert1 unused count: 367
Expert2 unused count: 385
Expert1 balance top: 97.65625
Expert2 balance top: 98.73046875

New cuda time: 2.4812910556793213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.535051107406616
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 195.3076171875, gpu time: 34.72207760810852
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.318359375
Expert2 overflow: 32.12890625
Expert1 unused count: 382
Expert2 unused count: 374
Expert1 balance top: 98.681640625
Expert2 balance top: 98.14453125

New cuda time: 2.4244909286499023
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472011089324951
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 197.701171875, gpu time: 39.61282014846802
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.25
Expert2 overflow: 20.556640625
Expert1 unused count: 196
Expert2 unused count: 296
Expert1 balance top: 79.58984375
Expert2 balance top: 93.06640625

New cuda time: 2.4182510375976562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.542090892791748
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 240.4375, gpu time: 39.68946099281311
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.08203125
Expert2 overflow: 17.529296875
Expert1 unused count: 214
Expert2 unused count: 324
Expert1 balance top: 82.666015625
Expert2 balance top: 94.43359375

New cuda time: 2.4488120079040527
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.531851053237915
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 222.85546875, gpu time: 39.87810039520264
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 14.6484375
Expert1 unused count: 205
Expert2 unused count: 317
Expert1 balance top: 80.419921875
Expert2 balance top: 93.994140625

New cuda time: 2.4979310035705566
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.526092052459717
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 247.62255859375, gpu time: 39.92322111129761
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.029296875
Expert2 overflow: 17.1875
Expert1 unused count: 226
Expert2 unused count: 288
Expert1 balance top: 82.8125
Expert2 balance top: 91.89453125

New cuda time: 2.4632110595703125
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46993088722229
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 251.98486328125, gpu time: 39.858901262283325
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.953125
Expert2 overflow: 19.775390625
Expert1 unused count: 244
Expert2 unused count: 280
Expert1 balance top: 85.302734375
Expert2 balance top: 90.8203125

New cuda time: 2.4489710330963135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5728108882904053
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 222.78369140625, gpu time: 39.74385952949524
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.1015625
Expert2 overflow: 15.33203125
Expert1 unused count: 266
Expert2 unused count: 286
Expert1 balance top: 89.35546875
Expert2 balance top: 90.380859375

New cuda time: 2.4848110675811768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481131076812744
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 223.7958984375, gpu time: 44.57876229286194
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.8125
Expert2 overflow: 16.845703125
Expert1 unused count: 384
Expert2 unused count: 378
Expert1 balance top: 98.291015625
Expert2 balance top: 98.486328125

New cuda time: 2.4356911182403564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4612910747528076
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 267.998291015625, gpu time: 44.586443185806274
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.294921875
Expert2 overflow: 21.142578125
Expert1 unused count: 390
Expert2 unused count: 400
Expert1 balance top: 98.6328125
Expert2 balance top: 99.560546875

New cuda time: 2.4520111083984375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.541131019592285
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 250.371826171875, gpu time: 44.87124252319336
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.375
Expert2 overflow: 6.54296875
Expert1 unused count: 386
Expert2 unused count: 357
Expert1 balance top: 98.681640625
Expert2 balance top: 96.875

New cuda time: 2.484170913696289
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.520332098007202
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 275.032958984375, gpu time: 44.9277241230011
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.6015625
Expert1 unused count: 368
Expert2 unused count: 366
Expert1 balance top: 96.826171875
Expert2 balance top: 97.216796875

New cuda time: 2.442570924758911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4968109130859375
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 280.269775390625, gpu time: 44.798283100128174
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.8125
Expert2 overflow: 35.888671875
Expert1 unused count: 393
Expert2 unused count: 395
Expert1 balance top: 99.21875
Expert2 balance top: 99.31640625

New cuda time: 2.6056110858917236
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4748919010162354
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | cpu time: 259.8974609375, gpu time: 44.8243625164032
2024-07-11 01:35:18 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.443359375
Expert2 overflow: 27.490234375
Expert1 unused count: 408
Expert2 unused count: 396
Expert1 balance top: 99.951171875
Expert2 balance top: 99.365234375

New cuda time: 2.4246509075164795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.498732089996338
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 250.86376953125, gpu time: 49.502145290374756
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 10.25390625
Expert1 unused count: 154
Expert2 unused count: 271
Expert1 balance top: 73.681640625
Expert2 balance top: 91.015625

New cuda time: 2.419210910797119
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4846510887145996
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 296.45849609375, gpu time: 49.49030518531799
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.642578125
Expert1 unused count: 170
Expert2 unused count: 302
Expert1 balance top: 75.830078125
Expert2 balance top: 92.236328125

New cuda time: 2.4276909828186035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4995319843292236
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 278.574462890625, gpu time: 49.79846549034119
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.908203125
Expert1 unused count: 169
Expert2 unused count: 289
Expert1 balance top: 76.26953125
Expert2 balance top: 91.2109375

New cuda time: 2.4516921043395996
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495371103286743
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 303.416015625, gpu time: 49.874786138534546
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.24609375
Expert2 overflow: 8.3984375
Expert1 unused count: 189
Expert2 unused count: 258
Expert1 balance top: 77.294921875
Expert2 balance top: 88.96484375

New cuda time: 11.895733833312988
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4438509941101074
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 315.78759765625, gpu time: 59.13786792755127
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.71875
Expert1 unused count: 198
Expert2 unused count: 261
Expert1 balance top: 80.2734375
Expert2 balance top: 89.0625

New cuda time: 2.437290906906128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4936110973358154
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 286.9794921875, gpu time: 49.75526452064514
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 8.30078125
Expert1 unused count: 223
Expert2 unused count: 252
Expert1 balance top: 83.0078125
Expert2 balance top: 87.744140625

New cuda time: 2.4603309631347656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4971320629119873
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 275.38037109375, gpu time: 54.45960831642151
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.15234375
Expert2 overflow: 9.5703125
Expert1 unused count: 271
Expert2 unused count: 336
Expert1 balance top: 85.693359375
Expert2 balance top: 95.5078125

New cuda time: 2.4420909881591797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4827311038970947
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 323.55615234375, gpu time: 54.41512727737427
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.005859375
Expert2 overflow: 6.787109375
Expert1 unused count: 284
Expert2 unused count: 331
Expert1 balance top: 88.720703125
Expert2 balance top: 94.775390625

New cuda time: 2.442570924758911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.494410991668701
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 305.612548828125, gpu time: 54.7354474067688
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 3.564453125
Expert1 unused count: 292
Expert2 unused count: 340
Expert1 balance top: 86.181640625
Expert2 balance top: 95.556640625

New cuda time: 2.4489710330963135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.510571002960205
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 330.719970703125, gpu time: 54.834328174591064
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.224609375
Expert2 overflow: 11.279296875
Expert1 unused count: 301
Expert2 unused count: 324
Expert1 balance top: 88.8671875
Expert2 balance top: 94.3359375

New cuda time: 2.4491310119628906
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461930990219116
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 341.605224609375, gpu time: 64.04892992973328
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 10.7421875
Expert1 unused count: 314
Expert2 unused count: 328
Expert1 balance top: 91.943359375
Expert2 balance top: 94.53125

New cuda time: 2.448651075363159
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487051010131836
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 314.1240234375, gpu time: 54.69096660614014
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.587890625
Expert2 overflow: 13.18359375
Expert1 unused count: 331
Expert2 unused count: 337
Expert1 balance top: 93.45703125
Expert2 balance top: 95.1171875

New cuda time: 2.4649710655212402
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5376110076904297
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 299.738525390625, gpu time: 59.46219038963318
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 8.10546875
Expert1 unused count: 143
Expert2 unused count: 255
Expert1 balance top: 70.947265625
Expert2 balance top: 88.8671875

New cuda time: 2.4449710845947266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.49009108543396
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 350.892822265625, gpu time: 59.350189447402954
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.56640625
Expert1 unused count: 138
Expert2 unused count: 290
Expert1 balance top: 71.875
Expert2 balance top: 91.650390625

New cuda time: 2.4492909908294678
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470571994781494
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 332.834716796875, gpu time: 59.65531039237976
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 6.54296875
Expert1 unused count: 147
Expert2 unused count: 276
Expert1 balance top: 71.97265625
Expert2 balance top: 90.4296875

New cuda time: 2.4572908878326416
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462730884552002
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 358.282470703125, gpu time: 59.75434994697571
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.734375
Expert2 overflow: 9.130859375
Expert1 unused count: 157
Expert2 unused count: 250
Expert1 balance top: 75.146484375
Expert2 balance top: 87.353515625

New cuda time: 2.4388909339904785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5184121131896973
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 369.1826171875, gpu time: 69.00623297691345
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.150390625
Expert1 unused count: 170
Expert2 unused count: 229
Expert1 balance top: 75.634765625
Expert2 balance top: 84.5703125

New cuda time: 2.470571994781494
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6243319511413574
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 351.09423828125, gpu time: 59.78587055206299
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.515625
Expert2 overflow: 4.345703125
Expert1 unused count: 182
Expert2 unused count: 206
Expert1 balance top: 78.369140625
Expert2 balance top: 82.568359375

New cuda time: 2.4553709030151367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48865008354187
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 325.2587890625, gpu time: 64.40621137619019
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.197265625
Expert2 overflow: 15.72265625
Expert1 unused count: 112
Expert2 unused count: 245
Expert1 balance top: 69.091796875
Expert2 balance top: 87.646484375

New cuda time: 2.448309898376465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6212689876556396
New cuda time: 2.6044700145721436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470391035079956
New cuda time: 2.400151014328003
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.543989896774292
New cuda time: 2.408629894256592
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.636629104614258
New cuda time: 2.431830883026123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462869882583618
New cuda time: 2.4099109172821045
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5007901191711426
New cuda time: 2.4479899406433105
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477910041809082
New cuda time: 2.417591094970703
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5004711151123047
New cuda time: 2.4361510276794434
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5363099575042725
New cuda time: 2.4465510845184326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4745500087738037
New cuda time: 2.4700698852539062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4591898918151855
New cuda time: 2.415990114212036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5263900756835938
New cuda time: 2.429270029067993
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5302300453186035
New cuda time: 2.4483110904693604
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453911066055298
New cuda time: 2.444309949874878
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.523509979248047
New cuda time: 2.4287900924682617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5017499923706055
New cuda time: 2.4918301105499268
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6220688819885254
New cuda time: 2.4659109115600586
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463191032409668
New cuda time: 2.429590940475464
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4934310913085938
New cuda time: 2.4604709148406982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710309505462646
New cuda time: 2.455030918121338
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5319900512695312
New cuda time: 2.474709987640381
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6513490676879883
New cuda time: 2.454710006713867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4849510192871094
New cuda time: 2.460789918899536
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.508150100708008
New cuda time: 2.449589967727661
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479990005493164
New cuda time: 2.4527900218963623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4585509300231934
New cuda time: 2.432950973510742
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463351011276245
New cuda time: 2.4310309886932373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4795100688934326
New cuda time: 2.4302310943603516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488149881362915
New cuda time: 2.44638991355896
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4884700775146484
New cuda time: 2.4415900707244873
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4700710773468018
New cuda time: 2.435671091079712
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4967899322509766
New cuda time: 2.4878299236297607
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4873509407043457
New cuda time: 2.4316699504852295
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.51951003074646
New cuda time: 2.497910976409912
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.618230104446411
New cuda time: 2.4715099334716797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5534300804138184
New cuda time: 2.48511004447937
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478869915008545
New cuda time: 2.4467101097106934
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4617509841918945
New cuda time: 2.492150068283081
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.523829936981201
New cuda time: 2.4388699531555176
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453429937362671
New cuda time: 2.583669900894165
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457590103149414
New cuda time: 2.496309995651245
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5423901081085205
New cuda time: 2.4663898944854736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487030029296875
New cuda time: 2.427989959716797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.523829936981201
New cuda time: 2.4339098930358887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5179100036621094
New cuda time: 2.4999899864196777
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.456629991531372
New cuda time: 2.444951057434082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4764699935913086
New cuda time: 2.4468700885772705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.565429925918579
New cuda time: 2.4182300567626953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4831900596618652
New cuda time: 2.431989908218384
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649510383605957
New cuda time: 2.4355111122131348
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.511509895324707
New cuda time: 2.495189905166626
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5207901000976562
New cuda time: 2.4497499465942383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4599900245666504
New cuda time: 2.635668992996216
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4740710258483887
New cuda time: 2.4327900409698486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.507349967956543
New cuda time: 2.4961509704589844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468790054321289
New cuda time: 2.4343910217285156
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.497109889984131
New cuda time: 2.4337499141693115
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5030300617218018
New cuda time: 11.867473602294922
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732699394226074
New cuda time: 2.443190097808838
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5129499435424805
New cuda time: 2.4049510955810547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4865500926971436
New cuda time: 2.4531099796295166
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627110958099365
New cuda time: 2.446871042251587
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5137500762939453
New cuda time: 2.444149971008301
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.518389940261841
New cuda time: 2.4502298831939697
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5046310424804688
New cuda time: 2.4161500930786133
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.50750994682312
New cuda time: 2.455349922180176
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5291099548339844
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4804699420928955
New cuda time: 2.4395101070404053
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4791901111602783
New cuda time: 2.482870101928711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488149881362915
New cuda time: 2.43710994720459
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5059099197387695
New cuda time: 2.4507100582122803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.625269889831543
New cuda time: 2.4558300971984863
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5009500980377197
New cuda time: 2.4495999813079834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.636960029602051
New cuda time: 2.6222400665283203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4606399536132812
New cuda time: 2.427680015563965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4748799800872803
New cuda time: 2.4519999027252197
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6619200706481934
New cuda time: 2.4372799396514893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600000381469727
New cuda time: 2.41648006439209
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467519998550415
New cuda time: 2.446239948272705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.438080072402954
New cuda time: 2.4761600494384766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4761600494384766
New cuda time: 2.4457600116729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4953598976135254
New cuda time: 2.446079969406128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488000869750977
New cuda time: 2.4636800289154053
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460319995880127
New cuda time: 2.444960117340088
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472320079803467
New cuda time: 2.4184000492095947
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.430079936981201
New cuda time: 2.4550399780273438
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611198902130127
New cuda time: 2.4428799152374268
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4751999378204346
New cuda time: 2.4332809448242188
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753599166870117
New cuda time: 2.422719955444336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.626720905303955
New cuda time: 2.4284799098968506
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476639986038208
New cuda time: 2.398081064224243
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4862399101257324
New cuda time: 2.404639959335327
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4508800506591797
New cuda time: 2.4620800018310547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475680112838745
New cuda time: 2.459199905395508
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.646559953689575
New cuda time: 2.4484798908233643
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4447999000549316
New cuda time: 2.443039894104004
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458400011062622
New cuda time: 2.437920093536377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474720001220703
New cuda time: 2.446079969406128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441279888153076
New cuda time: 2.461280107498169
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44704008102417
New cuda time: 2.4567999839782715
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4851200580596924
New cuda time: 2.4363200664520264
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453439950942993
New cuda time: 2.428960084915161
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.442080020904541
New cuda time: 2.601759910583496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460479974746704
New cuda time: 2.4457600116729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4851200580596924
New cuda time: 2.3988800048828125
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710400104522705
New cuda time: 2.464319944381714
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689600467681885
New cuda time: 2.4550399780273438
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.637279987335205
New cuda time: 2.4495999813079834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4526400566101074
New cuda time: 2.4345600605010986
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4616000652313232
New cuda time: 2.4171199798583984
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4772799015045166
New cuda time: 2.4355199337005615
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.425920009613037
New cuda time: 2.444159984588623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569599628448486
New cuda time: 2.6121599674224854
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4844799041748047
New cuda time: 2.430079936981201
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4719998836517334
New cuda time: 2.4545600414276123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485919952392578
New cuda time: 2.4537599086761475
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4628798961639404
New cuda time: 2.455519914627075
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854400157928467
New cuda time: 2.4019200801849365
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5115199089050293
New cuda time: 2.468319892883301
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473759889602661
New cuda time: 2.4436800479888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870400428771973
New cuda time: 2.454400062561035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446239948272705
New cuda time: 2.460319995880127
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569599628448486
New cuda time: 2.4495999813079834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4719998836517334
New cuda time: 2.4569599628448486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4243199825286865
New cuda time: 2.4360010623931885
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488000869750977
New cuda time: 2.613759994506836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4516799449920654
New cuda time: 2.4598400592803955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.434720039367676
New cuda time: 2.4620800018310547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4535999298095703
New cuda time: 2.471679925918579
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4688000679016113
New cuda time: 2.435839891433716
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4638400077819824
New cuda time: 12.034079551696777
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4577600955963135
New cuda time: 2.4494400024414062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627199172973633
New cuda time: 2.4236810207366943
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4579200744628906
New cuda time: 2.440160036087036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566400051116943
New cuda time: 2.4507200717926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4728000164031982
New cuda time: 2.4524800777435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4793601036071777
New cuda time: 2.4091200828552246
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459199905395508
New cuda time: 2.471519947052002
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4607999324798584
New cuda time: 2.4558401107788086
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483839988708496
New cuda time: 2.4375998973846436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476639986038208
New cuda time: 2.452960968017578
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4542410373687744
New cuda time: 2.4505600929260254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462399959564209
New cuda time: 2.4356799125671387
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4316799640655518
New cuda time: 2.460479974746704
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6142399311065674
New cuda time: 2.4251201152801514
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470720052719116
New cuda time: 2.4379289150238037
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6427290439605713
New cuda time: 2.6028900146484375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598491191864014
New cuda time: 2.470889091491699
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4944090843200684
New cuda time: 2.4318490028381348
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.625770092010498
New cuda time: 2.4540889263153076
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4660890102386475
New cuda time: 2.468808889389038
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485610008239746
New cuda time: 2.432969093322754
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4470489025115967
New cuda time: 2.4574499130249023
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4568090438842773
New cuda time: 2.441128969192505
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.504328966140747
New cuda time: 2.46160888671875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4528090953826904
New cuda time: 2.4395289421081543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.450568914413452
New cuda time: 2.4152090549468994
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4558489322662354
New cuda time: 2.4739298820495605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439368963241577
New cuda time: 2.445449113845825
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478729009628296
New cuda time: 2.431209087371826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477768898010254
New cuda time: 2.4752089977264404
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.491848945617676
New cuda time: 2.4124889373779297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6387290954589844
New cuda time: 2.4448089599609375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4632089138031006
New cuda time: 2.477449893951416
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4516890048980713
New cuda time: 2.4171290397644043
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452169895172119
New cuda time: 2.4438490867614746
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476649045944214
New cuda time: 2.4456090927124023
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.60896897315979
New cuda time: 2.4689700603485107
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.436969041824341
New cuda time: 2.4396889209747314
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488089084625244
New cuda time: 2.423048973083496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4761691093444824
New cuda time: 2.416969060897827
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4499289989471436
New cuda time: 2.4550490379333496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471848964691162
New cuda time: 2.4384090900421143
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46160888671875
New cuda time: 2.4561688899993896
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.508168935775757
New cuda time: 2.4305689334869385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.445449113845825
New cuda time: 2.6028900146484375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465449094772339
New cuda time: 2.4374489784240723
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4489688873291016
New cuda time: 2.413769006729126
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457288980484009
New cuda time: 2.443528890609741
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4801700115203857
New cuda time: 2.4358489513397217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.667370080947876
New cuda time: 2.484808921813965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.432008981704712
New cuda time: 2.4598491191864014
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4508891105651855
New cuda time: 2.4428889751434326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47248911857605
New cuda time: 2.451529026031494
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4427289962768555
New cuda time: 2.432008981704712
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468488931655884
New cuda time: 2.610569953918457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47792911529541
New cuda time: 2.44736909866333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4843289852142334
New cuda time: 2.473928928375244
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4395289421081543
New cuda time: 2.441448926925659
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4568090438842773
New cuda time: 2.4496090412139893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4628889560699463
New cuda time: 2.4326488971710205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4772889614105225
New cuda time: 2.4448089599609375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4558489322662354
New cuda time: 2.4430489540100098
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480648994445801
New cuda time: 2.441448926925659
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4486489295959473
New cuda time: 2.44736909866333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451369047164917
New cuda time: 2.4224090576171875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464488983154297
New cuda time: 2.4254488945007324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4507288932800293
New cuda time: 2.4313690662384033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4633688926696777
New cuda time: 2.6123299598693848
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476008892059326
New cuda time: 2.4476890563964844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547290802001953
New cuda time: 2.4729690551757812
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464010000228882
New cuda time: 2.440169095993042
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4704089164733887
New cuda time: 2.468648910522461
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485929012298584
New cuda time: 11.89604377746582
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457448959350586
New cuda time: 2.449289083480835
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467689037322998
New cuda time: 2.4884889125823975
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471848964691162
New cuda time: 2.4364891052246094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4755289554595947
New cuda time: 2.4459290504455566
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4670488834381104
New cuda time: 2.446249008178711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4430489540100098
New cuda time: 2.4233689308166504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4651288986206055
New cuda time: 2.446249008178711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4729690551757812
New cuda time: 2.441288948059082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4844889640808105
New cuda time: 2.464808940887451
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4696099758148193
New cuda time: 2.452488899230957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611289501190186
New cuda time: 2.4478490352630615
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4633688926696777
New cuda time: 2.467050075531006
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451529026031494
New cuda time: 2.4286489486694336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.623689889907837
New cuda time: 2.4608089923858643
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675281047821045
New cuda time: New cuda time: 2.4368109703063965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5718510150909424
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 378.6162109375, gpu time: 64.3588514328003
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.15234375
Expert2 overflow: 16.064453125
Expert1 unused count: 106
Expert2 unused count: 296
Expert1 balance top: 69.43359375
Expert2 balance top: 93.017578125

New cuda time: 2.442570924758911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463531970977783
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | cpu time: 360.342041015625, gpu time: 64.56141328811646
2024-07-11 01:35:19 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.3671875
Expert2 overflow: 11.962890625
Expert1 unused count: 122
Expert2 unused count: 270
Expert1 balance top: 68.75
Expert2 balance top: 90.283203125

New cuda time: 2.442250967025757
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48625111579895
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 388.625244140625, gpu time: 64.68285202980042
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 13.8671875
Expert1 unused count: 110
Expert2 unused count: 236
Expert1 balance top: 67.529296875
Expert2 balance top: 87.5

New cuda time: 2.4355309009552
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6459319591522217
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 405.386962890625, gpu time: 74.08769583702087
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 14.013671875
Expert1 unused count: 113
Expert2 unused count: 199
Expert1 balance top: 69.384765625
Expert2 balance top: 84.66796875

New cuda time: 2.435210943222046
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4964919090270996
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 378.8056640625, gpu time: 64.71757340431213
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.9765625
Expert2 overflow: 1.953125
Expert1 unused count: 145
Expert2 unused count: 169
Expert1 balance top: 72.265625
Expert2 balance top: 78.61328125

New cuda time: 2.437450885772705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753708839416504
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 350.3359375, gpu time: 69.31903314590454
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.9296875
Expert2 overflow: 13.330078125
Expert1 unused count: 186
Expert2 unused count: 293
Expert1 balance top: 78.857421875
Expert2 balance top: 92.822265625

New cuda time: 2.4441709518432617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464651107788086
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 406.294677734375, gpu time: 69.26767349243164
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.587890625
Expert2 overflow: 4.736328125
Expert1 unused count: 198
Expert2 unused count: 295
Expert1 balance top: 80.419921875
Expert2 balance top: 91.69921875

New cuda time: 2.4400110244750977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4684910774230957
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 388.146484375, gpu time: 69.46991539001465
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.61328125
Expert1 unused count: 183
Expert2 unused count: 279
Expert1 balance top: 77.63671875
Expert2 balance top: 89.794921875

New cuda time: 2.475050926208496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5000109672546387
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 416.447021484375, gpu time: 69.65791392326355
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.39453125
Expert2 overflow: 7.080078125
Expert1 unused count: 176
Expert2 unused count: 260
Expert1 balance top: 78.759765625
Expert2 balance top: 88.57421875

New cuda time: 2.431370973587036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453450918197632
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 433.073486328125, gpu time: 78.97251772880554
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.5703125
Expert1 unused count: 200
Expert2 unused count: 258
Expert1 balance top: 82.32421875
Expert2 balance top: 89.74609375

New cuda time: 2.428330898284912
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5686519145965576
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 406.73583984375, gpu time: 69.7145562171936
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 10.400390625
Expert1 unused count: 226
Expert2 unused count: 259
Expert1 balance top: 85.888671875
Expert2 balance top: 88.57421875

New cuda time: 2.4369709491729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4467310905456543
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 375.4296875, gpu time: 74.20273518562317
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.005859375
Expert1 unused count: 117
Expert2 unused count: 259
Expert1 balance top: 66.40625
Expert2 balance top: 88.037109375

New cuda time: 2.4299309253692627
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475372076034546
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 433.875244140625, gpu time: 74.17297649383545
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 8.642578125
Expert1 unused count: 153
Expert2 unused count: 289
Expert1 balance top: 69.3359375
Expert2 balance top: 92.578125

New cuda time: 2.4356911182403564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5025711059570312
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 415.995849609375, gpu time: 74.40817761421204
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.42578125
Expert1 unused count: 152
Expert2 unused count: 274
Expert1 balance top: 71.240234375
Expert2 balance top: 89.208984375

New cuda time: 2.4726510047912598
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5969719886779785
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 473.65625, gpu time: 74.7275378704071
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.5703125
Expert1 unused count: 171
Expert2 unused count: 259
Expert1 balance top: 72.705078125
Expert2 balance top: 87.060546875

New cuda time: 2.4400110244750977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486090898513794
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 460.805419921875, gpu time: 83.89861965179443
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.181640625
Expert1 unused count: 184
Expert2 unused count: 216
Expert1 balance top: 75.244140625
Expert2 balance top: 82.32421875

New cuda time: 2.6113710403442383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5540919303894043
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 442.968017578125, gpu time: 74.88001918792725
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.85546875
Expert1 unused count: 217
Expert2 unused count: 236
Expert1 balance top: 77.34375
Expert2 balance top: 82.2265625

New cuda time: 2.4988911151885986
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.492811918258667
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 400.1552734375, gpu time: 79.19443821907043
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 20.01953125
Expert2 overflow: 6.005859375
Expert1 unused count: 281
Expert2 unused count: 352
Expert1 balance top: 90.4296875
Expert2 balance top: 96.875

New cuda time: 2.422091007232666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.443531036376953
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 461.335205078125, gpu time: 79.03859853744507
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.98046875
Expert2 overflow: 12.060546875
Expert1 unused count: 312
Expert2 unused count: 367
Expert1 balance top: 92.578125
Expert2 balance top: 97.705078125

New cuda time: 2.431370973587036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.536010980606079
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 443.949462890625, gpu time: 79.37555956840515
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.537109375
Expert2 overflow: 22.900390625
Expert1 unused count: 339
Expert2 unused count: 355
Expert1 balance top: 95.556640625
Expert2 balance top: 96.2890625

New cuda time: 2.427211046218872
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480010986328125
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 501.442626953125, gpu time: 79.6347599029541
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.08203125
Expert2 overflow: 12.40234375
Expert1 unused count: 359
Expert2 unused count: 344
Expert1 balance top: 96.728515625
Expert2 balance top: 96.19140625

New cuda time: 2.4390509128570557
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.650252103805542
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | cpu time: 497.327392578125, gpu time: 88.98792266845703
2024-07-11 01:35:20 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.0546875
Expert2 overflow: 26.220703125
Expert1 unused count: 385
Expert2 unused count: 381
Expert1 balance top: 98.828125
Expert2 balance top: 98.6328125

New cuda time: 2.4430510997772217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.501132011413574
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 470.839599609375, gpu time: 79.82420229911804
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 13.134765625
Expert2 overflow: 25.537109375
Expert1 unused count: 392
Expert2 unused count: 378
Expert1 balance top: 99.169921875
Expert2 balance top: 98.193359375

New cuda time: 2.480492115020752
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5299320220947266
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 424.86962890625, gpu time: 84.20486235618591
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 13.4765625
Expert1 unused count: 171
Expert2 unused count: 281
Expert1 balance top: 74.267578125
Expert2 balance top: 91.943359375

New cuda time: 2.455530881881714
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488110542297363
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 489.005126953125, gpu time: 83.94294047355652
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 4.052734375
Expert1 unused count: 200
Expert2 unused count: 311
Expert1 balance top: 78.80859375
Expert2 balance top: 93.359375

New cuda time: 2.4248108863830566
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6393721103668213
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 511.727783203125, gpu time: 84.43974256515503
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.98046875
Expert1 unused count: 186
Expert2 unused count: 305
Expert1 balance top: 75.29296875
Expert2 balance top: 91.9921875

New cuda time: 2.429131031036377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569709300994873
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 529.232421875, gpu time: 84.52086186408997
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.857421875
Expert2 overflow: 9.08203125
Expert1 unused count: 215
Expert2 unused count: 281
Expert1 balance top: 80.078125
Expert2 balance top: 89.697265625

New cuda time: 2.4726510047912598
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4561710357666016
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 525.01953125, gpu time: 93.91674470901489
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.49609375
Expert1 unused count: 243
Expert2 unused count: 273
Expert1 balance top: 82.8125
Expert2 balance top: 89.501953125

New cuda time: 2.4419310092926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4716908931732178
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 498.8056640625, gpu time: 84.73782420158386
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.197265625
Expert2 overflow: 8.544921875
Expert1 unused count: 253
Expert2 unused count: 279
Expert1 balance top: 85.3515625
Expert2 balance top: 88.57421875

New cuda time: 2.4244909286499023
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.57121205329895
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 450.072998046875, gpu time: 89.20056533813477
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.810546875
Expert1 unused count: 148
Expert2 unused count: 261
Expert1 balance top: 70.751953125
Expert2 balance top: 89.35546875

New cuda time: 2.46881103515625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4528119564056396
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 516.710205078125, gpu time: 88.86456346511841
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.248046875
Expert1 unused count: 169
Expert2 unused count: 290
Expert1 balance top: 74.90234375
Expert2 balance top: 91.2109375

New cuda time: 2.433130979537964
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5080111026763916
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 539.6630859375, gpu time: 89.38088464736938
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 9.619140625
Expert1 unused count: 175
Expert2 unused count: 292
Expert1 balance top: 74.51171875
Expert2 balance top: 91.30859375

New cuda time: 2.4449710845947266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5193710327148438
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 557.105224609375, gpu time: 89.48520398139954
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.685546875
Expert2 overflow: 10.888671875
Expert1 unused count: 176
Expert2 unused count: 266
Expert1 balance top: 76.025390625
Expert2 balance top: 88.525390625

New cuda time: 2.454730987548828
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.590251922607422
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 561.179931640625, gpu time: 98.96172761917114
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.9375
Expert1 unused count: 211
Expert2 unused count: 247
Expert1 balance top: 79.443359375
Expert2 balance top: 87.40234375

New cuda time: 2.4217710494995117
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.505450963973999
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 526.9287109375, gpu time: 89.66504621505737
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.3203125
Expert2 overflow: 5.56640625
Expert1 unused count: 229
Expert2 unused count: 243
Expert1 balance top: 83.447265625
Expert2 balance top: 83.447265625

New cuda time: 2.4451310634613037
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5088119506835938
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 475.374267578125, gpu time: 94.15450835227966
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 9.1796875
Expert1 unused count: 171
Expert2 unused count: 281
Expert1 balance top: 71.875
Expert2 balance top: 90.72265625

New cuda time: 2.615370035171509
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.498892068862915
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 589.6337890625, gpu time: 93.97882556915283
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 3.564453125
Expert1 unused count: 180
Expert2 unused count: 305
Expert1 balance top: 76.220703125
Expert2 balance top: 92.87109375

New cuda time: 2.431051015853882
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467690944671631
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 567.443603515625, gpu time: 94.2796266078949
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.810546875
Expert1 unused count: 180
Expert2 unused count: 297
Expert1 balance top: 75.146484375
Expert2 balance top: 91.162109375

New cuda time: 2.420011043548584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482090950012207
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 584.811767578125, gpu time: 94.38730597496033
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.001953125
Expert2 overflow: 10.107421875
Expert1 unused count: 202
Expert2 unused count: 268
Expert1 balance top: 77.197265625
Expert2 balance top: 88.525390625

New cuda time: 2.4203310012817383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472011089324951
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 589.11279296875, gpu time: 103.85406970977783
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.765625
Expert1 unused count: 220
Expert2 unused count: 264
Expert1 balance top: 80.615234375
Expert2 balance top: 88.525390625

New cuda time: 2.445451021194458
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5312108993530273
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 554.64794921875, gpu time: 94.64170813560486
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 5.2734375
Expert1 unused count: 227
Expert2 unused count: 246
Expert1 balance top: 82.568359375
Expert2 balance top: 85.9375

New cuda time: 2.4457709789276123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5270509719848633
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | cpu time: 500.656982421875, gpu time: 99.12733030319214
2024-07-11 01:35:21 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.9765625
Expert2 overflow: 9.423828125
Expert1 unused count: 159
Expert2 unused count: 282
Expert1 balance top: 71.58203125
Expert2 balance top: 90.966796875

New cuda time: 2.4305710792541504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5180909633636475
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 620.10400390625, gpu time: 98.92748761177063
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 2.880859375
Expert1 unused count: 152
Expert2 unused count: 286
Expert1 balance top: 72.65625
Expert2 balance top: 90.478515625

New cuda time: 2.4793710708618164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468010902404785
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 593.86181640625, gpu time: 99.2270085811615
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 5.46875
Expert1 unused count: 160
Expert2 unused count: 290
Expert1 balance top: 72.998046875
Expert2 balance top: 90.576171875

New cuda time: 2.4328110218048096
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4860920906066895
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 611.91015625, gpu time: 99.30621004104614
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.978515625
Expert2 overflow: 7.763671875
Expert1 unused count: 170
Expert2 unused count: 243
Expert1 balance top: 73.2421875
Expert2 balance top: 87.353515625

New cuda time: 2.438410997390747
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4774510860443115
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 616.048583984375, gpu time: 108.76993179321289
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.6640625
Expert1 unused count: 208
Expert2 unused count: 260
Expert1 balance top: 78.41796875
Expert2 balance top: 87.939453125

New cuda time: 2.4328110218048096
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6076910495758057
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 626.3994140625, gpu time: 99.68221020698547
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 6.73828125
Expert1 unused count: 225
Expert2 unused count: 245
Expert1 balance top: 80.6640625
Expert2 balance top: 84.130859375

New cuda time: 2.4329710006713867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471851110458374
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 526.17431640625, gpu time: 104.0321524143219
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.373046875
Expert2 overflow: 7.666015625
Expert1 unused count: 229
Expert2 unused count: 332
Expert1 balance top: 87.158203125
Expert2 balance top: 95.849609375

New cuda time: 2.4480109214782715
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.506251096725464
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 647.140380859375, gpu time: 103.88174962997437
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 13.18359375
Expert2 overflow: 8.30078125
Expert1 unused count: 235
Expert2 unused count: 326
Expert1 balance top: 88.57421875
Expert2 balance top: 95.458984375

New cuda time: 2.4561710357666016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516810894012451
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 621.533203125, gpu time: 104.19999051094055
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.326171875
Expert2 overflow: 8.984375
Expert1 unused count: 229
Expert2 unused count: 305
Expert1 balance top: 87.939453125
Expert2 balance top: 92.626953125

New cuda time: 2.6016108989715576
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4712119102478027
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 648.0830078125, gpu time: 104.3790328502655
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 11.1328125
Expert1 unused count: 229
Expert2 unused count: 301
Expert1 balance top: 86.572265625
Expert2 balance top: 92.529296875

New cuda time: 2.4328110218048096
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495371103286743
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 643.539306640625, gpu time: 113.69811391830444
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 18.359375
Expert1 unused count: 255
Expert2 unused count: 299
Expert1 balance top: 88.916015625
Expert2 balance top: 92.7734375

New cuda time: 2.4652910232543945
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.43825101852417
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 653.876220703125, gpu time: 104.58575224876404
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 17.08984375
Expert1 unused count: 283
Expert2 unused count: 269
Expert1 balance top: 89.94140625
Expert2 balance top: 90.673828125

New cuda time: 2.4366509914398193
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.532810926437378
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 551.61767578125, gpu time: 109.0016143321991
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.443359375
Expert1 unused count: 139
Expert2 unused count: 258
Expert1 balance top: 71.6796875
Expert2 balance top: 89.0625

New cuda time: 2.438410997390747
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4908909797668457
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 674.62451171875, gpu time: 108.81105160713196
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.8828125
Expert1 unused count: 151
Expert2 unused count: 304
Expert1 balance top: 73.779296875
Expert2 balance top: 93.115234375

New cuda time: 2.45953106880188
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4998509883880615
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 649.127197265625, gpu time: 109.1593725681305
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.15234375
Expert1 unused count: 152
Expert2 unused count: 270
Expert1 balance top: 72.998046875
Expert2 balance top: 90.72265625

New cuda time: 2.396811008453369
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488970994949341
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 675.401123046875, gpu time: 109.26481485366821
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 8.7890625
Expert1 unused count: 171
Expert2 unused count: 281
Expert1 balance top: 74.560546875
Expert2 balance top: 89.84375

New cuda time: 2.4398510456085205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.647372007369995
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 680.541259765625, gpu time: 118.78533697128296
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.59765625
Expert1 unused count: 191
Expert2 unused count: 271
Expert1 balance top: 77.44140625
Expert2 balance top: 89.111328125

New cuda time: 2.449610948562622
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.526252031326294
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 681.63818359375, gpu time: 109.56161522865295
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 3.564453125
Expert1 unused count: 210
Expert2 unused count: 234
Expert1 balance top: 79.1015625
Expert2 balance top: 83.447265625

New cuda time: 2.4308910369873047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470571994781494
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 576.787109375, gpu time: 113.9030773639679
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.95703125
Expert2 overflow: 7.6171875
Expert1 unused count: 275
Expert2 unused count: 332
Expert1 balance top: 84.521484375
Expert2 balance top: 94.921875

New cuda time: 2.4296109676361084
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488492012023926
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 702.117919921875, gpu time: 113.72915458679199
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.98046875
Expert2 overflow: 7.03125
Expert1 unused count: 277
Expert2 unused count: 339
Expert1 balance top: 85.107421875
Expert2 balance top: 95.166015625

New cuda time: 2.446571111679077
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5012919902801514
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | cpu time: 676.656494140625, gpu time: 114.10723567008972
2024-07-11 01:35:22 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 3.369140625
Expert1 unused count: 280
Expert2 unused count: 331
Expert1 balance top: 85.15625
Expert2 balance top: 93.75

New cuda time: 2.4638519287109375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460810899734497
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 703.07421875, gpu time: 114.18947768211365
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 8.251953125
Expert1 unused count: 297
Expert2 unused count: 325
Expert1 balance top: 87.3046875
Expert2 balance top: 92.48046875

New cuda time: 2.427211046218872
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4976110458374023
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 707.703857421875, gpu time: 123.71015906333923
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.953125
Expert2 overflow: 11.328125
Expert1 unused count: 310
Expert2 unused count: 322
Expert1 balance top: 90.72265625
Expert2 balance top: 94.482421875

New cuda time: 2.432171106338501
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812910556793213
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 709.075927734375, gpu time: 114.47507739067078
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 17.28515625
Expert1 unused count: 323
Expert2 unused count: 326
Expert1 balance top: 93.06640625
Expert2 balance top: 93.9453125

New cuda time: 2.4264109134674072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4304111003875732
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 601.552734375, gpu time: 118.75989937782288
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 10.302734375
Expert2 overflow: 9.619140625
Expert1 unused count: 320
Expert2 unused count: 344
Expert1 balance top: 94.482421875
Expert2 balance top: 96.533203125

New cuda time: 2.449610948562622
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488651990890503
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 729.564208984375, gpu time: 118.66741752624512
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 14.0625
Expert2 overflow: 3.80859375
Expert1 unused count: 325
Expert2 unused count: 359
Expert1 balance top: 94.287109375
Expert2 balance top: 97.265625

New cuda time: 2.422250986099243
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4771320819854736
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 704.086669921875, gpu time: 119.00661873817444
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 12.548828125
Expert2 overflow: 4.00390625
Expert1 unused count: 333
Expert2 unused count: 350
Expert1 balance top: 94.384765625
Expert2 balance top: 96.6796875

New cuda time: 2.4521710872650146
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 4.751381874084473
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 742.057861328125, gpu time: 121.39303064346313
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.443359375
Expert2 overflow: 13.037109375
Expert1 unused count: 325
Expert2 unused count: 334
Expert1 balance top: 92.96875
Expert2 balance top: 94.775390625

New cuda time: 2.4304111003875732
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4755311012268066
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 735.34814453125, gpu time: 128.6161012649536
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.78515625
Expert2 overflow: 30.810546875
Expert1 unused count: 334
Expert2 unused count: 355
Expert1 balance top: 94.43359375
Expert2 balance top: 97.021484375

New cuda time: 2.448651075363159
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5344109535217285
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 736.679443359375, gpu time: 119.45813941955566
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.2734375
Expert2 overflow: 22.314453125
Expert1 unused count: 376
Expert2 unused count: 368
Expert1 balance top: 97.998046875
Expert2 balance top: 97.65625

New cuda time: 2.424330949783325
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444330930709839
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 626.914794921875, gpu time: 123.62856125831604
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.71484375
Expert1 unused count: 238
Expert2 unused count: 319
Expert1 balance top: 84.033203125
Expert2 balance top: 94.62890625

New cuda time: 2.424170970916748
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462730884552002
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 757.0625, gpu time: 123.55431938171387
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.203125
Expert1 unused count: 249
Expert2 unused count: 351
Expert1 balance top: 84.86328125
Expert2 balance top: 96.923828125

New cuda time: 2.4303998947143555
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4662399291992188
New cuda time: 2.4404799938201904
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4436800479888916
New cuda time: 2.4558401107788086
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4651200771331787
New cuda time: 2.4230399131774902
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6508800983428955
New cuda time: 2.4351999759674072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453439950942993
New cuda time: 2.439039945602417
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627199172973633
New cuda time: 2.446079969406128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480639934539795
New cuda time: 2.4547200202941895
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4558401107788086
New cuda time: 2.463520050048828
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479840040206909
New cuda time: 2.4364800453186035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463360071182251
New cuda time: 2.4396800994873047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.434079885482788
New cuda time: 2.460479974746704
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.456480026245117
New cuda time: 2.4545600414276123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4902400970458984
New cuda time: 2.436000108718872
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452320098876953
New cuda time: 2.4446399211883545
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.601439952850342
New cuda time: 2.4447999000549316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481600046157837
New cuda time: 2.6459200382232666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4728000164031982
New cuda time: 2.4580800533294678
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672000408172607
New cuda time: 2.435839891433716
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.450079917907715
New cuda time: 2.4356799125671387
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4651200771331787
New cuda time: 2.419840097427368
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4800000190734863
New cuda time: 2.455199956893921
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6544010639190674
New cuda time: 2.461280107498169
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812800884246826
New cuda time: 2.4435200691223145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4576001167297363
New cuda time: 2.4492809772491455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460319995880127
New cuda time: 2.446079969406128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.579040050506592
New cuda time: 2.4372799396514893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4456000328063965
New cuda time: 2.4672000408172607
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455359935760498
New cuda time: 2.454400062561035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48688006401062
New cuda time: 2.4416000843048096
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587199687957764
New cuda time: 2.4291200637817383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547200202941895
New cuda time: 2.4382400512695312
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4580800533294678
New cuda time: 2.4423999786376953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4718399047851562
New cuda time: 2.4505600929260254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.611999988555908
New cuda time: 2.4475200176239014
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4729599952697754
New cuda time: 2.458400011062622
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484639883041382
New cuda time: 2.6105599403381348
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471359968185425
New cuda time: 2.4395198822021484
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4537599086761475
New cuda time: 2.47760009765625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468161106109619
New cuda time: 2.43887996673584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4284799098968506
New cuda time: 2.4804799556732178
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4481608867645264
New cuda time: 2.454400062561035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4708800315856934
New cuda time: 2.431520938873291
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4992001056671143
New cuda time: 2.502880096435547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4630401134490967
New cuda time: 2.4515199661254883
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4718399047851562
New cuda time: 2.4535999298095703
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710400104522705
New cuda time: 2.4081599712371826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6225600242614746
New cuda time: 2.4395198822021484
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471679925918579
New cuda time: 2.4611198902130127
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732799530029297
New cuda time: 2.4463999271392822
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461280107498169
New cuda time: 2.586400032043457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4728000164031982
New cuda time: 2.4916799068450928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4659199714660645
New cuda time: 2.492000102996826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4639999866485596
New cuda time: 2.418720006942749
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4700798988342285
New cuda time: 2.4719998836517334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4921600818634033
New cuda time: 2.467200994491577
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476639986038208
New cuda time: 2.489919900894165
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441119909286499
New cuda time: 2.47760009765625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6193599700927734
New cuda time: 2.4161601066589355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.434880018234253
New cuda time: 2.4174399375915527
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461280107498169
New cuda time: 2.4443199634552
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4924800395965576
New cuda time: 2.465440034866333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460479974746704
New cuda time: 2.4535999298095703
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4662399291992188
New cuda time: 2.4414401054382324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4825599193573
New cuda time: 2.455359935760498
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4849600791931152
New cuda time: 2.4763200283050537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547200202941895
New cuda time: 2.4689600467681885
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466399908065796
New cuda time: 2.471679925918579
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488960027694702
New cuda time: 2.434720039367676
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 3.883359909057617
New cuda time: 2.434079885482788
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4678399562835693
New cuda time: 2.4732799530029297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4944000244140625
New cuda time: 2.4689600467681885
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4519999027252197
New cuda time: 2.451359987258911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4679999351501465
New cuda time: 2.4491100311279297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5839900970458984
New cuda time: 2.449589967727661
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5083110332489014
New cuda time: 2.4505510330200195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870309829711914
New cuda time: 2.4628689289093018
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6737489700317383
New cuda time: 2.4535911083221436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474869966506958
New cuda time: 2.4139111042022705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482391119003296
New cuda time: 2.443510055541992
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4798309803009033
New cuda time: 2.4337499141693115
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484311103820801
New cuda time: 2.4143900871276855
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.512310028076172
New cuda time: 2.462230920791626
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4886300563812256
New cuda time: 2.4516708850860596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.573590040206909
New cuda time: 2.467510938644409
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4567909240722656
New cuda time: 2.451349973678589
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883100986480713
New cuda time: 2.450870990753174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.448470115661621
New cuda time: 2.444150924682617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6137499809265137
New cuda time: 2.4419100284576416
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.527190923690796
New cuda time: 2.5987091064453125
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.535670042037964
New cuda time: 2.4294309616088867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459351062774658
New cuda time: 2.4411098957061768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.450870990753174
New cuda time: 2.452310085296631
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5372700691223145
New cuda time: 2.4731099605560303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4822299480438232
New cuda time: 2.4119908809661865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.635190010070801
New cuda time: 2.4572699069976807
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.512310028076172
New cuda time: 2.4214301109313965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.510550022125244
New cuda time: 2.4179110527038574
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460469961166382
New cuda time: 2.4595110416412354
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.628628969192505
New cuda time: 2.4710299968719482
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.509589910507202
New cuda time: 2.4137508869171143
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4545509815216064
New cuda time: 2.444309949874878
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5131099224090576
New cuda time: 2.4502310752868652
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5270299911499023
New cuda time: 2.440951108932495
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4260709285736084
New cuda time: 2.4483110904693604
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.53262996673584
New cuda time: 2.472949981689453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.550869941711426
New cuda time: 2.4655909538269043
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6409499645233154
New cuda time: 2.444469928741455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4927899837493896
New cuda time: 2.4675099849700928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.526710033416748
New cuda time: 2.633270025253296
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486711025238037
New cuda time: 2.430389881134033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4772698879241943
New cuda time: 2.459350109100342
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.456629991531372
New cuda time: 2.4617509841918945
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480149984359741
New cuda time: 2.4180710315704346
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516309976577759
New cuda time: 2.4406299591064453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.547029972076416
New cuda time: 2.4475109577178955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452310085296631
New cuda time: 2.388150930404663
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4607911109924316
New cuda time: 2.4436709880828857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4995100498199463
New cuda time: 2.4395110607147217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471510887145996
New cuda time: 2.451669931411743
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.618549108505249
New cuda time: 2.444791078567505
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472151041030884
New cuda time: 2.438870906829834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475830078125
New cuda time: 2.420789957046509
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.508310079574585
New cuda time: 2.6036689281463623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474231004714966
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489109992980957
New cuda time: 2.4644699096679688
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4499099254608154
New cuda time: 2.456789970397949
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5169498920440674
New cuda time: 2.439030885696411
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4591898918151855
New cuda time: 2.431349992752075
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4831910133361816
New cuda time: 2.4110310077667236
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485590934753418
New cuda time: 2.4457509517669678
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6372690200805664
New cuda time: 2.4719910621643066
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.52095103263855
New cuda time: 2.4566309452056885
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464629888534546
New cuda time: 2.443510055541992
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.445910930633545
New cuda time: 2.45599102973938
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4895899295806885
New cuda time: 2.431989908218384
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4540700912475586
New cuda time: 2.4227099418640137
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482870101928711
New cuda time: 2.4382309913635254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485909938812256
New cuda time: 2.487190008163452
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4540700912475586
New cuda time: 2.4374310970306396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4635109901428223
New cuda time: 2.4495909214019775
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4863901138305664
New cuda time: 2.4507100582122803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4887900352478027
New cuda time: 2.417109966278076
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4804699420928955
New cuda time: 2.4446310997009277
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5334300994873047
New cuda time: 2.4959909915924072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4457509517669678
New cuda time: 2.437429904937744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4409499168395996
New cuda time: 2.490889072418213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710490703582764
New cuda time: 2.439368963241577
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4558489322662354
New cuda time: 2.4468889236450195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4956889152526855
New cuda time: 2.482089042663574
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.605289936065674
New cuda time: 2.4060890674591064
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4446489810943604
New cuda time: 2.4395289421081543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468488931655884
New cuda time: 2.4497690200805664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4822490215301514
New cuda time: 2.438088893890381
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471848964691162
New cuda time: 2.4704089164733887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46160888671875
New cuda time: 2.449449062347412
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473768949508667
New cuda time: 2.471529006958008
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4364891052246094
New cuda time: 2.418889045715332
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4516890048980713
New cuda time: 2.4483299255371094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472809076309204
New cuda time: 2.4785690307617188
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5017690658569336
New cuda time: 2.424808979034424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.633769989013672
New cuda time: 2.433928966522217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4558498859405518
New cuda time: 2.6323280334472656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484968900680542
New cuda time: 2.4353690147399902
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547290802001953
New cuda time: 2.4358489513397217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4520089626312256
New cuda time: 2.4601690769195557
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4440090656280518
New cuda time: 2.4305689334869385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4571290016174316
New cuda time: 2.460649013519287
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6366500854492188
New cuda time: 2.4465689659118652
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483689069747925
New cuda time: 2.4988889694213867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4385690689086914
New cuda time: 2.432008981704712
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4617691040039062
New cuda time: 2.4427289962768555
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6212899684906006
New cuda time: 2.47121000289917
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782490730285645
New cuda time: 2.4499289989471436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4609689712524414
New cuda time: 2.4548890590667725
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47792911529541
New cuda time: 2.453289031982422
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4886488914489746
New cuda time: 2.427849054336548
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457448959350586
New cuda time: 2.4398488998413086
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463529109954834
New cuda time: 2.4529690742492676
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46160888671875
New cuda time: 2.434730052947998
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.657289981842041
New cuda time: 2.4651288986206055
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4670488834381104
New cuda time: 2.4315290451049805
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4904088973999023
New cuda time: 2.5886499881744385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474569082260132
New cuda time: 2.408968925476074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449129104614258
New cuda time: 2.446089029312134
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782490730285645
New cuda time: 2.444489002227783
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4512100219726562
New cuda time: 2.455368995666504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4430489540100098
New cuda time: 2.441448926925659
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4750499725341797
New cuda time: 2.447208881378174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4964890480041504
New cuda time: 2.4704089164733887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4427289962768555
New cuda time: 2.421128988265991
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466568946838379
New cuda time: 2.42992901802063
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44848895072937
New cuda time: 2.4222490787506104
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5704081058502197
New cuda time: 2.4571290016174316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4608089923858643
New cuda time: 2.4395289421081543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4499289989471436
New cuda time: 2.4440090656280518
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.442409038543701
New cuda time: 2.6273701190948486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566490650177
New cuda time: 2.4742488861083984
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.434889078140259
New cuda time: 2.4560089111328125
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487049102783203
New cuda time: 2.4609689712524414
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462568998336792
New cuda time: 2.4232089519500732
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4772889614105225
New cuda time: 2.425128936767578
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.491848945617676
New cuda time: 2.4785690307617188
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.442089080810547
New cuda time: 2.4689691066741943
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6292901039123535
New cuda time: 2.4699299335479736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569690227508545
New cuda time: 2.445770025253296
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446408987045288
New cuda time: 2.4324889183044434
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463689088821411
New cuda time: 2.454408884048462
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5044898986816406
New cuda time: 2.448168992996216
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4409689903259277
New cuda time: 2.4476890563964844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469609022140503
New cuda time: 2.4275290966033936
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4641690254211426
New cuda time: 2.484009027481079
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46048903465271
New cuda time: 2.434889078140259
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455368995666504
New cuda time: 2.439368963241577
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457288980484009
New cuda time: 2.4304089546203613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.3968091011047363
New cuda time: 2.4286489486694336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4699289798736572
New cuda time: 2.4552090167999268
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4792089462280273
New cuda time: 2.433289051055908
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452009916305542
New cuda time: 2.427849054336548
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4475290775299072
New cuda time: New cuda time: 2.4499309062957764
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48193097114563
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 731.79736328125, gpu time: 123.93848061561584
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.05078125
Expert2 overflow: 18.408203125
Expert1 unused count: 259
Expert2 unused count: 337
Expert1 balance top: 86.71875
Expert2 balance top: 96.142578125

New cuda time: 2.4427309036254883
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486090898513794
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 769.7705078125, gpu time: 126.32185244560242
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 16.11328125
Expert1 unused count: 261
Expert2 unused count: 319
Expert1 balance top: 86.376953125
Expert2 balance top: 94.287109375

New cuda time: 2.4113709926605225
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465770959854126
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 762.83203125, gpu time: 133.49324321746826
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.58984375
Expert2 overflow: 24.072265625
Expert1 unused count: 296
Expert2 unused count: 308
Expert1 balance top: 89.794921875
Expert2 balance top: 93.701171875

New cuda time: 2.410090923309326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.551532030105591
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 764.75244140625, gpu time: 124.41976237297058
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 14.013671875
Expert2 overflow: 7.763671875
Expert1 unused count: 295
Expert2 unused count: 301
Expert1 balance top: 91.6015625
Expert2 balance top: 91.30859375

New cuda time: 2.4305710792541504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.504491090774536
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 652.0107421875, gpu time: 128.56362342834473
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 11.23046875
Expert1 unused count: 128
Expert2 unused count: 261
Expert1 balance top: 69.384765625
Expert2 balance top: 89.306640625

New cuda time: 2.4248108863830566
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4532909393310547
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 784.638427734375, gpu time: 128.43242120742798
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.83203125
Expert1 unused count: 141
Expert2 unused count: 286
Expert1 balance top: 71.2890625
Expert2 balance top: 91.455078125

New cuda time: 2.4224109649658203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471851110458374
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 759.328857421875, gpu time: 128.83274269104004
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.6640625
Expert1 unused count: 132
Expert2 unused count: 265
Expert1 balance top: 68.701171875
Expert2 balance top: 89.404296875

New cuda time: 2.420011043548584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6406519412994385
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 806.974365234375, gpu time: 131.38251543045044
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.783203125
Expert2 overflow: 6.787109375
Expert1 unused count: 164
Expert2 unused count: 247
Expert1 balance top: 73.53515625
Expert2 balance top: 86.42578125

New cuda time: 2.4540910720825195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4508910179138184
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 790.45068359375, gpu time: 138.3982253074646
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.810546875
Expert1 unused count: 195
Expert2 unused count: 232
Expert1 balance top: 76.5625
Expert2 balance top: 84.716796875

New cuda time: 2.433290958404541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5129709243774414
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | cpu time: 792.25830078125, gpu time: 129.36602425575256
2024-07-11 01:35:23 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.1484375
Expert2 overflow: 6.73828125
Expert1 unused count: 224
Expert2 unused count: 235
Expert1 balance top: 81.005859375
Expert2 balance top: 82.91015625

New cuda time: 2.449610948562622
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5267319679260254
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 677.353271484375, gpu time: 133.53996634483337
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.671875
Expert1 unused count: 198
Expert2 unused count: 277
Expert1 balance top: 77.294921875
Expert2 balance top: 90.72265625

New cuda time: 2.4710519313812256
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464651107788086
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 811.902099609375, gpu time: 133.3681242465973
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 9.5703125
Expert1 unused count: 207
Expert2 unused count: 317
Expert1 balance top: 80.76171875
Expert2 balance top: 93.896484375

New cuda time: 2.433450937271118
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480971097946167
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 786.74755859375, gpu time: 133.74716472625732
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 14.453125
Expert1 unused count: 216
Expert2 unused count: 312
Expert1 balance top: 78.662109375
Expert2 balance top: 92.919921875

New cuda time: 2.433290958404541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485291004180908
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 834.539306640625, gpu time: 136.3010973930359
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.697265625
Expert1 unused count: 252
Expert2 unused count: 287
Expert1 balance top: 84.66796875
Expert2 balance top: 90.52734375

New cuda time: 2.4675309658050537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472810983657837
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 818.00732421875, gpu time: 143.3385672569275
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 16.69921875
Expert1 unused count: 257
Expert2 unused count: 292
Expert1 balance top: 86.669921875
Expert2 balance top: 90.869140625

New cuda time: 2.4238510131835938
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5324909687042236
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 819.828857421875, gpu time: 134.32236623764038
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.58984375
Expert1 unused count: 272
Expert2 unused count: 276
Expert1 balance top: 87.744140625
Expert2 balance top: 87.939453125

New cuda time: 2.437290906906128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5268919467926025
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 702.824951171875, gpu time: 138.5041491985321
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 9.912109375
Expert1 unused count: 128
Expert2 unused count: 267
Expert1 balance top: 68.017578125
Expert2 balance top: 90.576171875

New cuda time: 2.439371109008789
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46753191947937
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 839.529052734375, gpu time: 138.27502727508545
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.298828125
Expert1 unused count: 133
Expert2 unused count: 290
Expert1 balance top: 71.826171875
Expert2 balance top: 91.2109375

New cuda time: 2.420171022415161
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6292920112609863
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 823.908203125, gpu time: 138.79662775993347
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.322265625
Expert1 unused count: 149
Expert2 unused count: 274
Expert1 balance top: 70.80078125
Expert2 balance top: 89.453125

New cuda time: 2.4249720573425293
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458570957183838
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 862.443115234375, gpu time: 141.18464040756226
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 6.982421875
Expert1 unused count: 161
Expert2 unused count: 234
Expert1 balance top: 73.974609375
Expert2 balance top: 85.64453125

New cuda time: 2.4472110271453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4985709190368652
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 845.615234375, gpu time: 148.28434920310974
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.958984375
Expert1 unused count: 178
Expert2 unused count: 224
Expert1 balance top: 75.5859375
Expert2 balance top: 85.595703125

New cuda time: 2.43441104888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4873709678649902
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 847.332275390625, gpu time: 139.24414825439453
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.5390625
Expert2 overflow: 9.9609375
Expert1 unused count: 215
Expert2 unused count: 236
Expert1 balance top: 81.396484375
Expert2 balance top: 85.7421875

New cuda time: 2.440171957015991
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458730936050415
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 727.307373046875, gpu time: 143.4030520915985
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 11.181640625
Expert1 unused count: 151
Expert2 unused count: 276
Expert1 balance top: 71.77734375
Expert2 balance top: 90.4296875

New cuda time: 2.4582509994506836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4731318950653076
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 867.309814453125, gpu time: 143.20641016960144
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.54296875
Expert1 unused count: 160
Expert2 unused count: 294
Expert1 balance top: 75.1953125
Expert2 balance top: 91.943359375

New cuda time: 2.461452007293701
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4328110218048096
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 851.3935546875, gpu time: 143.69089078903198
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.6875
Expert1 unused count: 183
Expert2 unused count: 292
Expert1 balance top: 74.51171875
Expert2 balance top: 90.869140625

New cuda time: 2.4347310066223145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460331916809082
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 890.1015625, gpu time: 146.07970333099365
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.44140625
Expert2 overflow: 8.7890625
Expert1 unused count: 187
Expert2 unused count: 259
Expert1 balance top: 75.48828125
Expert2 balance top: 88.18359375

New cuda time: 2.4264109134674072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.492971897125244
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 873.176513671875, gpu time: 153.2037320137024
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.107421875
Expert1 unused count: 211
Expert2 unused count: 253
Expert1 balance top: 79.052734375
Expert2 balance top: 87.6953125

New cuda time: 2.4704110622406006
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453610897064209
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 874.73095703125, gpu time: 144.16817021369934
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.953125
Expert2 overflow: 5.76171875
Expert1 unused count: 239
Expert2 unused count: 245
Expert1 balance top: 84.130859375
Expert2 balance top: 85.009765625

New cuda time: 2.439210891723633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.437290906906128
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 752.357666015625, gpu time: 148.27955389022827
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.517578125
Expert1 unused count: 215
Expert2 unused count: 328
Expert1 balance top: 79.8828125
Expert2 balance top: 94.580078125

New cuda time: 2.432331085205078
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48193097114563
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 894.818603515625, gpu time: 148.12067222595215
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.390625
Expert2 overflow: 6.4453125
Expert1 unused count: 248
Expert2 unused count: 313
Expert1 balance top: 85.64453125
Expert2 balance top: 93.359375

New cuda time: 2.4707319736480713
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.651211977005005
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 888.415771484375, gpu time: 148.81283378601074
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 4.19921875
Expert1 unused count: 250
Expert2 unused count: 301
Expert1 balance top: 83.88671875
Expert2 balance top: 90.478515625

New cuda time: 2.412170886993408
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4603309631347656
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | cpu time: 917.73681640625, gpu time: 150.95220518112183
2024-07-11 01:35:24 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.564453125
Expert2 overflow: 10.83984375
Expert1 unused count: 278
Expert2 unused count: 314
Expert1 balance top: 86.9140625
Expert2 balance top: 91.748046875

New cuda time: 2.420011043548584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4948909282684326
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 900.83740234375, gpu time: 158.1186339855194
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.3671875
Expert2 overflow: 17.626953125
Expert1 unused count: 299
Expert2 unused count: 321
Expert1 balance top: 89.599609375
Expert2 balance top: 93.310546875

New cuda time: 2.4508910179138184
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5177719593048096
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 902.18359375, gpu time: 149.13683319091797
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 8.984375
Expert1 unused count: 329
Expert2 unused count: 313
Expert1 balance top: 93.45703125
Expert2 balance top: 92.08984375

New cuda time: 2.4030508995056152
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675309658050537
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 777.287109375, gpu time: 153.15013575553894
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.599609375
Expert1 unused count: 195
Expert2 unused count: 290
Expert1 balance top: 77.685546875
Expert2 balance top: 91.796875

New cuda time: 2.446892023086548
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4529709815979004
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 922.365478515625, gpu time: 153.0205352306366
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.8359375
Expert2 overflow: 13.525390625
Expert1 unused count: 227
Expert2 unused count: 316
Expert1 balance top: 81.4453125
Expert2 balance top: 93.65234375

New cuda time: 2.4388909339904785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479851007461548
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 915.927490234375, gpu time: 153.73157572746277
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 17.822265625
Expert1 unused count: 233
Expert2 unused count: 304
Expert1 balance top: 83.349609375
Expert2 balance top: 93.06640625

New cuda time: 2.466731071472168
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4305710792541504
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 945.5068359375, gpu time: 155.84950733184814
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.736328125
Expert2 overflow: 14.84375
Expert1 unused count: 257
Expert2 unused count: 306
Expert1 balance top: 84.27734375
Expert2 balance top: 91.845703125

New cuda time: 2.4206509590148926
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4905710220336914
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 928.382568359375, gpu time: 163.029855966568
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.001953125
Expert2 overflow: 16.943359375
Expert1 unused count: 257
Expert2 unused count: 286
Expert1 balance top: 86.279296875
Expert2 balance top: 89.453125

New cuda time: 2.430891990661621
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4974520206451416
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 929.62353515625, gpu time: 154.06517720222473
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 10.546875
Expert1 unused count: 300
Expert2 unused count: 292
Expert1 balance top: 90.33203125
Expert2 balance top: 89.16015625

New cuda time: 2.427371025085449
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4467310905456543
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 802.46533203125, gpu time: 158.02423787117004
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 12.59765625
Expert1 unused count: 107
Expert2 unused count: 242
Expert1 balance top: 67.138671875
Expert2 balance top: 88.18359375

New cuda time: 2.4276909828186035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6332919597625732
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 959.476318359375, gpu time: 158.08151817321777
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 13.623046875
Expert1 unused count: 139
Expert2 unused count: 268
Expert1 balance top: 69.62890625
Expert2 balance top: 90.72265625

New cuda time: 2.4320108890533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4803309440612793
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 943.676513671875, gpu time: 158.6439175605774
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 11.81640625
Expert1 unused count: 136
Expert2 unused count: 276
Expert1 balance top: 69.677734375
Expert2 balance top: 90.087890625

New cuda time: 2.4596920013427734
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476011037826538
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 972.6474609375, gpu time: 160.78521037101746
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 14.35546875
Expert1 unused count: 147
Expert2 unused count: 248
Expert1 balance top: 72.36328125
Expert2 balance top: 88.37890625

New cuda time: 2.410090923309326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732909202575684
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 955.73974609375, gpu time: 167.9132378101349
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.892578125
Expert1 unused count: 162
Expert2 unused count: 240
Expert1 balance top: 75.0
Expert2 balance top: 85.888671875

New cuda time: 2.4326510429382324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4996910095214844
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 957.13671875, gpu time: 158.99751925468445
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.904296875
Expert2 overflow: 7.373046875
Expert1 unused count: 195
Expert2 unused count: 206
Expert1 balance top: 78.759765625
Expert2 balance top: 78.955078125

New cuda time: 2.4204909801483154
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5219318866729736
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 827.69873046875, gpu time: 162.96666073799133
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 11.767578125
Expert1 unused count: 155
Expert2 unused count: 277
Expert1 balance top: 73.095703125
Expert2 balance top: 91.064453125

New cuda time: 2.419050931930542
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459851026535034
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 986.78857421875, gpu time: 162.96042013168335
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 5.17578125
Expert1 unused count: 173
Expert2 unused count: 298
Expert1 balance top: 76.26953125
Expert2 balance top: 92.236328125

New cuda time: 2.4462509155273438
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4664111137390137
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 971.261474609375, gpu time: 163.55657958984375
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.39453125
Expert1 unused count: 154
Expert2 unused count: 281
Expert1 balance top: 73.583984375
Expert2 balance top: 90.234375

New cuda time: 2.445451021194458
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4940919876098633
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1000.15869140625, gpu time: 165.72475337982178
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 6.15234375
Expert1 unused count: 182
Expert2 unused count: 260
Expert1 balance top: 75.78125
Expert2 balance top: 88.916015625

New cuda time: 2.4166510105133057
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4704110622406006
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 983.046875, gpu time: 172.8002998828888
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.154296875
Expert1 unused count: 214
Expert2 unused count: 239
Expert1 balance top: 78.41796875
Expert2 balance top: 86.572265625

New cuda time: 2.442250967025757
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4632110595703125
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 984.734130859375, gpu time: 163.90298128128052
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.12890625
Expert1 unused count: 228
Expert2 unused count: 249
Expert1 balance top: 81.884765625
Expert2 balance top: 83.984375

New cuda time: 2.440171003341675
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486572027206421
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | cpu time: 853.05615234375, gpu time: 167.89340376853943
2024-07-11 01:35:25 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.88671875
Expert1 unused count: 126
Expert2 unused count: 287
Expert1 balance top: 71.240234375
Expert2 balance top: 92.3828125

New cuda time: 10.962289810180664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4440109729766846
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1022.91748046875, gpu time: 176.3667209148407
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 3.173828125
Expert1 unused count: 141
Expert2 unused count: 313
Expert1 balance top: 74.755859375
Expert2 balance top: 94.287109375

New cuda time: 2.4356911182403564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471851110458374
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 998.216796875, gpu time: 168.46412181854248
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.470703125
Expert1 unused count: 143
Expert2 unused count: 301
Expert1 balance top: 73.828125
Expert2 balance top: 92.724609375

New cuda time: 2.4419310092926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4492909908294678
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1027.57421875, gpu time: 170.61597537994385
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.24609375
Expert2 overflow: 4.8828125
Expert1 unused count: 148
Expert2 unused count: 261
Expert1 balance top: 75.634765625
Expert2 balance top: 88.916015625

New cuda time: 2.4350509643554688
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5057709217071533
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1010.75, gpu time: 177.74112176895142
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.349609375
Expert1 unused count: 159
Expert2 unused count: 246
Expert1 balance top: 76.220703125
Expert2 balance top: 87.59765625

New cuda time: 2.428330898284912
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5168120861053467
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1012.303466796875, gpu time: 168.84812426567078
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 6.201171875
Expert1 unused count: 190
Expert2 unused count: 234
Expert1 balance top: 80.37109375
Expert2 balance top: 87.255859375

New cuda time: 2.412971019744873
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.511212110519409
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 877.99755859375, gpu time: 172.8175868988037
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 13.037109375
Expert1 unused count: 178
Expert2 unused count: 305
Expert1 balance top: 78.564453125
Expert2 balance top: 93.65234375

New cuda time: 2.4753708839416504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4660909175872803
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1050.484130859375, gpu time: 181.30818390846252
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 2.197265625
Expert1 unused count: 179
Expert2 unused count: 312
Expert1 balance top: 79.1015625
Expert2 balance top: 93.115234375

New cuda time: 2.4164910316467285
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4793710708618164
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1025.59765625, gpu time: 173.35998392105103
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.39453125
Expert2 overflow: 8.642578125
Expert1 unused count: 185
Expert2 unused count: 304
Expert1 balance top: 80.322265625
Expert2 balance top: 93.603515625

New cuda time: 2.43441104888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689719676971436
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1055.21826171875, gpu time: 175.51935839653015
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 4.541015625
Expert1 unused count: 189
Expert2 unused count: 292
Expert1 balance top: 81.34765625
Expert2 balance top: 90.625

New cuda time: 2.458730936050415
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4696109294891357
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1038.328857421875, gpu time: 182.66946363449097
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.744140625
Expert1 unused count: 196
Expert2 unused count: 268
Expert1 balance top: 80.859375
Expert2 balance top: 91.11328125

New cuda time: 2.4347310066223145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495210886001587
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1039.804931640625, gpu time: 173.77806615829468
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.3984375
Expert1 unused count: 242
Expert2 unused count: 262
Expert1 balance top: 85.05859375
Expert2 balance top: 90.234375

New cuda time: 2.408971071243286
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6651320457458496
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 912.951171875, gpu time: 177.89169001579285
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.59375
Expert1 unused count: 165
Expert2 unused count: 285
Expert1 balance top: 74.21875
Expert2 balance top: 91.2109375

New cuda time: 2.4299309253692627
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484652042388916
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1078.364501953125, gpu time: 186.2227668762207
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.2734375
Expert1 unused count: 181
Expert2 unused count: 298
Expert1 balance top: 76.611328125
Expert2 balance top: 91.943359375

New cuda time: 2.442250967025757
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4329710006713867
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1053.093505859375, gpu time: 178.23520588874817
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.421875
Expert1 unused count: 190
Expert2 unused count: 295
Expert1 balance top: 77.001953125
Expert2 balance top: 91.552734375

New cuda time: 2.4320108890533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4620909690856934
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1083.066650390625, gpu time: 180.4134602546692
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 5.517578125
Expert1 unused count: 195
Expert2 unused count: 254
Expert1 balance top: 77.83203125
Expert2 balance top: 86.376953125

New cuda time: 2.4510509967803955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45569109916687
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1066.25244140625, gpu time: 187.57620668411255
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 8.447265625
Expert1 unused count: 208
Expert2 unused count: 245
Expert1 balance top: 81.298828125
Expert2 balance top: 86.1328125

New cuda time: 2.4246509075164795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4886510372161865
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1067.423828125, gpu time: 178.69136810302734
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 7.763671875
Expert1 unused count: 236
Expert2 unused count: 252
Expert1 balance top: 85.7421875
Expert2 balance top: 86.328125

New cuda time: 2.4054510593414307
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4774510860443115
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 938.074462890625, gpu time: 182.7745921611786
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.466796875
Expert2 overflow: 11.572265625
Expert1 unused count: 214
Expert2 unused count: 310
Expert1 balance top: 79.58984375
Expert2 balance top: 93.701171875

New cuda time: 2.4537711143493652
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4684910774230957
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1106.03515625, gpu time: 191.14502906799316
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 4.443359375
Expert1 unused count: 224
Expert2 unused count: 302
Expert1 balance top: 82.91015625
Expert2 balance top: 91.943359375

New cuda time: 2.421130895614624
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.504491090774536
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1080.65966796875, gpu time: 183.16082787513733
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 7.421875
Expert1 unused count: 237
Expert2 unused count: 313
Expert1 balance top: 83.0078125
Expert2 balance top: 93.5546875

New cuda time: 2.4681599140167236
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691200256347656
New cuda time: 2.436959981918335
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4404799938201904
New cuda time: 2.4780800342559814
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461280107498169
New cuda time: 2.451200008392334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4790399074554443
New cuda time: 2.4804799556732178
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473599910736084
New cuda time: 2.4270401000976562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4494400024414062
New cuda time: 2.443039894104004
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46016001701355
New cuda time: 2.463520050048828
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.576319932937622
New cuda time: 2.4342401027679443
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4515199661254883
New cuda time: 2.4641599655151367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473439931869507
New cuda time: 2.430079936981201
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4884800910949707
New cuda time: 2.453439950942993
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47760009765625
New cuda time: 2.439840078353882
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465440034866333
New cuda time: 2.4443199634552
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4814400672912598
New cuda time: 2.4444799423217773
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.437920093536377
New cuda time: 2.4366400241851807
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458400011062622
New cuda time: 2.4172799587249756
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472960948944092
New cuda time: 2.4465599060058594
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649600982666016
New cuda time: 2.425600051879883
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6073598861694336
New cuda time: 2.41648006439209
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4656009674072266
New cuda time: 2.4803199768066406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481760025024414
New cuda time: 2.451040029525757
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.420959949493408
New cuda time: 2.4140799045562744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4654409885406494
New cuda time: 2.449120044708252
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46016001701355
New cuda time: 2.4425599575042725
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4456000328063965
New cuda time: 2.4281599521636963
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689600467681885
New cuda time: 2.4537599086761475
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476799964904785
New cuda time: 2.4670400619506836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.454400062561035
New cuda time: 2.409600019454956
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4729599952697754
New cuda time: 2.483839988708496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812800884246826
New cuda time: 2.4447999000549316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.621920108795166
New cuda time: 2.4283199310302734
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45632004737854
New cuda time: 2.4667201042175293
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4641599655151367
New cuda time: 2.4560000896453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841599464416504
New cuda time: 2.5259199142456055
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458400011062622
New cuda time: 2.4639999866485596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472640037536621
New cuda time: 2.4526400566101074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4761600494384766
New cuda time: 2.4504001140594482
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.445919990539551
New cuda time: 2.479520082473755
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460319995880127
New cuda time: 2.4334399700164795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463360071182251
New cuda time: 2.480639934539795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452159881591797
New cuda time: 2.421760082244873
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.611680030822754
New cuda time: 2.4681599140167236
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4728000164031982
New cuda time: 2.4200000762939453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4478399753570557
New cuda time: 2.4291200637817383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451040029525757
New cuda time: 2.4447999000549316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475519895553589
New cuda time: 2.458240032196045
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486560106277466
New cuda time: 2.440959930419922
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4446399211883545
New cuda time: 2.4283199310302734
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4711999893188477
New cuda time: 2.4393599033355713
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4700798988342285
New cuda time: 2.4427199363708496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465440034866333
New cuda time: 2.4587199687957764
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566400051116943
New cuda time: 2.441920042037964
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482240915298462
New cuda time: 10.982080459594727
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4497599601745605
New cuda time: 2.4515209197998047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4609599113464355
New cuda time: 2.433120012283325
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4721601009368896
New cuda time: 2.4619200229644775
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.432960033416748
New cuda time: 2.4566400051116943
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4638400077819824
New cuda time: 2.457119941711426
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480959892272949
New cuda time: 2.4326400756835938
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4475200176239014
New cuda time: 2.4191999435424805
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474560022354126
New cuda time: 2.4700798988342285
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457279920578003
New cuda time: 2.4396800994873047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4783999919891357
New cuda time: 2.448319911956787
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4657599925994873
New cuda time: 2.4465599060058594
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.593600034713745
New cuda time: 2.4495999813079834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4760000705718994
New cuda time: 2.415839910507202
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4457600116729736
New cuda time: 2.4657599925994873
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649600982666016
New cuda time: 2.4636800289154053
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5318400859832764
New cuda time: 2.4627199172973633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4607999324798584
New cuda time: 2.429919958114624
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460319995880127
New cuda time: 2.4691200256347656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473759889602661
New cuda time: 2.4515199661254883
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441601037979126
2.446549892425537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4665510654449463
New cuda time: 2.4382309913635254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4727909564971924
New cuda time: 2.4239909648895264
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4479899406433105
New cuda time: 2.4527900218963623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.535670042037964
New cuda time: 2.4852700233459473
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478070020675659
New cuda time: 2.409271001815796
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449429988861084
New cuda time: 2.4431910514831543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4486300945281982
New cuda time: 2.463031053543091
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.648469924926758
New cuda time: 2.4583899974823
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4369499683380127
New cuda time: 2.4316699504852295
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4943900108337402
New cuda time: 2.465909957885742
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5051109790802
New cuda time: 2.441910982131958
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4375898838043213
New cuda time: 2.436310052871704
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4859108924865723
New cuda time: 2.4375898838043213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4815900325775146
New cuda time: 2.462869882583618
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4940710067749023
New cuda time: 2.399030923843384
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5129499435424805
New cuda time: 2.4609498977661133
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5158300399780273
New cuda time: 2.443190097808838
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4956700801849365
New cuda time: 2.4067111015319824
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6116690635681152
New cuda time: 2.430229902267456
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4796700477600098
New cuda time: 2.4463911056518555
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4820709228515625
New cuda time: 2.409590005874634
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4903900623321533
New cuda time: 2.456789970397949
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466710090637207
New cuda time: 2.443190097808838
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.497270107269287
New cuda time: 2.4404709339141846
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4638309478759766
New cuda time: 2.444150924682617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4577510356903076
New cuda time: 2.441270112991333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.509269952774048
New cuda time: 2.4326300621032715
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4559900760650635
New cuda time: 2.4532699584960938
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464790105819702
New cuda time: 2.457750082015991
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475029945373535
New cuda time: 2.4511899948120117
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.644469976425171
New cuda time: 2.421751022338867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466391086578369
New cuda time: 2.4367899894714355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5110299587249756
New cuda time: 2.4526309967041016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516150951385498
New cuda time: 2.4257500171661377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4703900814056396
New cuda time: 2.447350025177002
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.454390048980713
New cuda time: 2.469270944595337
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4887900352478027
New cuda time: 2.427030086517334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4652700424194336
New cuda time: 2.442229986190796
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4899110794067383
New cuda time: 2.4535911083221436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5185511112213135
New cuda time: 2.483030080795288
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4387099742889404
New cuda time: 2.4393510818481445
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6206300258636475
New cuda time: 2.4572699069976807
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4833500385284424
New cuda time: 2.4374310970306396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4743900299072266
New cuda time: 2.4334299564361572
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4979100227355957
New cuda time: 2.4427099227905273
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.518709897994995
New cuda time: 2.4967899322509766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4996700286865234
New cuda time: 2.426069974899292
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459350109100342
New cuda time: 2.432149887084961
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465111017227173
New cuda time: 2.436310052871704
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45711088180542
New cuda time: 2.4055910110473633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.518549919128418
New cuda time: 2.454231023788452
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466391086578369
New cuda time: 2.4934298992156982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479830026626587
New cuda time: 10.925558090209961
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4667110443115234
New cuda time: 2.4406299591064453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689509868621826
New cuda time: 2.4406299591064453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.509589910507202
New cuda time: 2.403510093688965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4947099685668945
New cuda time: 2.4286301136016846
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.494070053100586
New cuda time: 2.498070001602173
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4740700721740723
New cuda time: 2.4315099716186523
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46766996383667
New cuda time: 2.430389881134033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4633500576019287
New cuda time: 2.436150074005127
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469909906387329
New cuda time: 2.45327091217041
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484790086746216
New cuda time: 2.435671091079712
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495511054992676
New cuda time: 2.456470012664795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.669429063796997
New cuda time: 2.465590000152588
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.497270107269287
New cuda time: 2.43710994720459
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4905500411987305
New cuda time: 2.4318299293518066
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462549924850464
New cuda time: 2.448470115661621
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.521749973297119
New cuda time: 2.430389881134033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4862310886383057
New cuda time: 2.4343910217285156
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469749927520752
New cuda time: 2.4542300701141357
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4820709228515625
New cuda time: 2.3979110717773438
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.497109889984131
New cuda time: 2.4454309940338135
2.4337689876556396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467849016189575
New cuda time: 2.4297690391540527
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.445770025253296
New cuda time: 2.439368963241577
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4568090438842773
New cuda time: 2.467689037322998
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469449043273926
New cuda time: 2.4446489810943604
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493129014968872
New cuda time: 2.4196889400482178
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44848895072937
New cuda time: 2.418889045715332
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466568946838379
New cuda time: 2.4283289909362793
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6163299083709717
New cuda time: 2.4232089519500732
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4499289989471436
New cuda time: 2.4163289070129395
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649689197540283
New cuda time: 2.457288980484009
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479688882827759
New cuda time: 2.4628889560699463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459368944168091
New cuda time: 2.410568952560425
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45232892036438
New cuda time: 2.4428889751434326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4734489917755127
New cuda time: 2.453449010848999
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4520089626312256
New cuda time: 2.431209087371826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.437129020690918
New cuda time: 2.458889961242676
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465609073638916
New cuda time: 2.4486489295959473
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.494088888168335
New cuda time: 2.4449689388275146
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6297690868377686
New cuda time: 2.4793689250946045
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451529026031494
New cuda time: 2.4368090629577637
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48865008354187
New cuda time: 2.4374489784240723
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4404890537261963
New cuda time: 2.449289083480835
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4592089653015137
New cuda time: 2.4377689361572266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4731290340423584
New cuda time: 2.4614500999450684
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672091007232666
New cuda time: 2.4366490840911865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44736909866333
New cuda time: 2.4548890590667725
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4747300148010254
New cuda time: 2.452488899230957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4376089572906494
New cuda time: 2.428968906402588
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4499289989471436
New cuda time: 2.4377689361572266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47360897064209
New cuda time: 2.4617691040039062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6121699810028076
New cuda time: 2.441288948059082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4468889236450195
New cuda time: 2.431209087371826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4528090953826904
New cuda time: 2.440009117126465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587290287017822
New cuda time: 2.5259289741516113
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.424009084701538
New cuda time: 2.415688991546631
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4624099731445312
New cuda time: 2.4475290775299072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4851300716400146
New cuda time: 2.467689037322998
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467689037322998
New cuda time: 2.446249008178711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4510490894317627
New cuda time: 2.4707300662994385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464808940887451
New cuda time: 2.4313690662384033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4478490352630615
New cuda time: 2.4286489486694336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.629610061645508
New cuda time: 2.4408090114593506
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4772889614105225
New cuda time: 2.486569881439209
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455688953399658
New cuda time: 2.4316890239715576
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4456090927124023
New cuda time: 2.4131290912628174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4643290042877197
New cuda time: 2.446408987045288
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4529690742492676
New cuda time: 2.4353690147399902
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441128969192505
New cuda time: 2.4214489459991455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4532899856567383
New cuda time: 2.433129072189331
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478888988494873
New cuda time: 2.450568914413452
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4548890590667725
New cuda time: 2.433129072189331
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4616100788116455
New cuda time: 2.4598491191864014
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487049102783203
New cuda time: 11.053481101989746
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4465689659118652
New cuda time: 2.411849021911621
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473768949508667
New cuda time: 2.4475290775299072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4897689819335938
New cuda time: 2.464808940887451
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4398488998413086
New cuda time: 2.425769090652466
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4590489864349365
New cuda time: 2.4923300743103027
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474729061126709
New cuda time: 2.476008892059326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453289031982422
New cuda time: 2.4276890754699707
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4446489810943604
New cuda time: 2.4304089546203613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4862489700317383
New cuda time: 2.458249092102051
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569690227508545
New cuda time: 2.4328091144561768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.436328887939453
New cuda time: 2.461448907852173
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5948879718780518
New cuda time: 2.4849700927734375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4750499725341797
New cuda time: 2.4233689308166504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466568946838379
New cuda time: 2.4470489025115967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46304988861084
New cuda time: 2.4440090656280518
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4619290828704834
New cuda time: 2.4691290855407715
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4376089572906494
New cuda time: 2.4467289447784424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4446489810943604
New cuda time: 2.452488899230957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4740889072418213
New cuda time: 2.4659290313720703
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439208984375
New cuda time: New cuda time: 2.412170886993408
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449450969696045
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1110.459716796875, gpu time: 185.27508211135864
2024-07-11 01:35:26 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.46875
Expert2 overflow: 11.42578125
Expert1 unused count: 251
Expert2 unused count: 295
Expert1 balance top: 83.837890625
Expert2 balance top: 91.40625

New cuda time: 2.4406509399414062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4777719974517822
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1093.92236328125, gpu time: 192.49462962150574
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 10.009765625
Expert1 unused count: 277
Expert2 unused count: 305
Expert1 balance top: 87.109375
Expert2 balance top: 92.919921875

New cuda time: 2.469451904296875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.496170997619629
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1094.928466796875, gpu time: 183.65699100494385
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 9.033203125
Expert1 unused count: 294
Expert2 unused count: 284
Expert1 balance top: 90.966796875
Expert2 balance top: 89.599609375

New cuda time: 2.5888121128082275
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870519638061523
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 974.49267578125, gpu time: 187.85045504570007
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 12.353515625
Expert2 overflow: 20.654296875
Expert1 unused count: 331
Expert2 unused count: 341
Expert1 balance top: 94.091796875
Expert2 balance top: 95.751953125

New cuda time: 2.436171054840088
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486090898513794
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1133.573974609375, gpu time: 196.06729102134705
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.029296875
Expert2 overflow: 10.693359375
Expert1 unused count: 338
Expert2 unused count: 347
Expert1 balance top: 94.62890625
Expert2 balance top: 96.19140625

New cuda time: 2.445291042327881
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4916911125183105
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1108.4111328125, gpu time: 188.09781002998352
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 3.076171875
Expert1 unused count: 338
Expert2 unused count: 348
Expert1 balance top: 93.26171875
Expert2 balance top: 95.166015625

New cuda time: 2.4284911155700684
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.433290958404541
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1138.099609375, gpu time: 190.13686418533325
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 23.046875
Expert1 unused count: 343
Expert2 unused count: 344
Expert1 balance top: 95.5078125
Expert2 balance top: 95.80078125

New cuda time: 2.444330930709839
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488010883331299
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1121.775390625, gpu time: 197.42697143554688
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.349609375
Expert2 overflow: 31.8359375
Expert1 unused count: 349
Expert2 unused count: 349
Expert1 balance top: 95.361328125
Expert2 balance top: 96.630859375

New cuda time: 2.460810899734497
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5273709297180176
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1122.392333984375, gpu time: 188.64517283439636
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 18.310546875
Expert1 unused count: 354
Expert2 unused count: 346
Expert1 balance top: 96.337890625
Expert2 balance top: 96.337890625

New cuda time: 2.439531087875366
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4582509994506836
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 999.684814453125, gpu time: 192.74823713302612
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.24609375
Expert2 overflow: 24.70703125
Expert1 unused count: 312
Expert2 unused count: 360
Expert1 balance top: 93.994140625
Expert2 balance top: 97.607421875

New cuda time: 2.4288110733032227
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4936110973358154
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1161.13623046875, gpu time: 200.98971319198608
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.568359375
Expert2 overflow: 21.6796875
Expert1 unused count: 332
Expert2 unused count: 370
Expert1 balance top: 95.41015625
Expert2 balance top: 98.095703125

New cuda time: 2.4643309116363525
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4908909797668457
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1135.949951171875, gpu time: 193.05303192138672
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 0.732421875
Expert1 unused count: 327
Expert2 unused count: 347
Expert1 balance top: 94.775390625
Expert2 balance top: 96.533203125

New cuda time: 2.456331968307495
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4676918983459473
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1165.781494140625, gpu time: 195.06088709831238
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.640625
Expert2 overflow: 13.330078125
Expert1 unused count: 339
Expert2 unused count: 349
Expert1 balance top: 95.5078125
Expert2 balance top: 96.728515625

New cuda time: 2.412170886993408
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.454411029815674
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1149.24560546875, gpu time: 202.29355335235596
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.765625
Expert2 overflow: 24.560546875
Expert1 unused count: 367
Expert2 unused count: 354
Expert1 balance top: 97.94921875
Expert2 balance top: 97.0703125

New cuda time: 2.472970962524414
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6548919677734375
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1159.687255859375, gpu time: 193.7730357646942
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 22.216796875
Expert1 unused count: 380
Expert2 unused count: 371
Expert1 balance top: 98.4375
Expert2 balance top: 97.705078125

New cuda time: 2.457611083984375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.499850034713745
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1024.9267578125, gpu time: 197.70569825172424
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.3046875
Expert1 unused count: 178
Expert2 unused count: 292
Expert1 balance top: 76.46484375
Expert2 balance top: 92.138671875

New cuda time: 2.412010908126831
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475372076034546
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1188.673583984375, gpu time: 205.87709617614746
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.197265625
Expert2 overflow: 10.05859375
Expert1 unused count: 200
Expert2 unused count: 298
Expert1 balance top: 81.0546875
Expert2 balance top: 93.408203125

New cuda time: 2.4700920581817627
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474890947341919
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1163.615234375, gpu time: 197.9980149269104
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.5625
Expert2 overflow: 12.5
Expert1 unused count: 207
Expert2 unused count: 304
Expert1 balance top: 82.03125
Expert2 balance top: 92.724609375

New cuda time: 2.441771984100342
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691309928894043
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1193.36669921875, gpu time: 199.97179007530212
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 13.4765625
Expert1 unused count: 237
Expert2 unused count: 282
Expert1 balance top: 83.3984375
Expert2 balance top: 90.380859375

New cuda time: 2.420171022415161
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475532054901123
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1176.99853515625, gpu time: 207.18925642967224
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.451171875
Expert1 unused count: 239
Expert2 unused count: 268
Expert1 balance top: 84.375
Expert2 balance top: 89.013671875

New cuda time: 2.4518508911132812
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4856109619140625
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1187.35205078125, gpu time: 198.71049761772156
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.787109375
Expert1 unused count: 274
Expert2 unused count: 264
Expert1 balance top: 87.79296875
Expert2 balance top: 87.01171875

New cuda time: 2.431370973587036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4772911071777344
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1050.03466796875, gpu time: 202.614360332489
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.03125
Expert1 unused count: 181
Expert2 unused count: 295
Expert1 balance top: 73.4375
Expert2 balance top: 91.796875

New cuda time: 2.437450885772705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4552109241485596
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1216.344482421875, gpu time: 210.76975798606873
2024-07-11 01:35:27 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.517578125
Expert1 unused count: 188
Expert2 unused count: 325
Expert1 balance top: 75.68359375
Expert2 balance top: 94.82421875

New cuda time: 2.461292028427124
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4824109077453613
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1191.165283203125, gpu time: 202.94171786308289
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.203125
Expert1 unused count: 187
Expert2 unused count: 300
Expert1 balance top: 74.853515625
Expert2 balance top: 92.3828125

New cuda time: 2.46881103515625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4544119834899902
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1220.8212890625, gpu time: 204.89501309394836
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.0078125
Expert1 unused count: 204
Expert2 unused count: 284
Expert1 balance top: 79.052734375
Expert2 balance top: 89.74609375

New cuda time: 2.419210910797119
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.433450937271118
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1204.476318359375, gpu time: 212.04191827774048
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 20.3125
Expert1 unused count: 212
Expert2 unused count: 283
Expert1 balance top: 80.029296875
Expert2 balance top: 90.4296875

New cuda time: 2.5827300548553467
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.494891881942749
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1224.6708984375, gpu time: 203.78811955451965
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.390625
Expert2 overflow: 2.197265625
Expert1 unused count: 225
Expert2 unused count: 244
Expert1 balance top: 80.56640625
Expert2 balance top: 84.228515625

New cuda time: 2.429291009902954
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4638519287109375
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1075.470703125, gpu time: 207.5075032711029
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.03125
Expert1 unused count: 141
Expert2 unused count: 259
Expert1 balance top: 75.048828125
Expert2 balance top: 89.35546875

New cuda time: 2.424971103668213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472491979598999
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1243.824462890625, gpu time: 215.66722106933594
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 7.958984375
Expert1 unused count: 159
Expert2 unused count: 301
Expert1 balance top: 74.70703125
Expert2 balance top: 93.75

New cuda time: 2.4144110679626465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488171100616455
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1218.92578125, gpu time: 207.844300031662
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.201171875
Expert1 unused count: 166
Expert2 unused count: 300
Expert1 balance top: 76.123046875
Expert2 balance top: 93.505859375

New cuda time: 2.4686520099639893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487051010131836
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1248.491943359375, gpu time: 209.8507161140442
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.0625
Expert1 unused count: 179
Expert2 unused count: 274
Expert1 balance top: 79.00390625
Expert2 balance top: 91.2109375

New cuda time: 2.4449710845947266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4625720977783203
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1232.129150390625, gpu time: 216.94946146011353
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 15.673828125
Expert1 unused count: 190
Expert2 unused count: 263
Expert1 balance top: 78.369140625
Expert2 balance top: 89.16015625

New cuda time: 2.43441104888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4686520099639893
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1252.29443359375, gpu time: 208.6911826133728
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.7890625
Expert1 unused count: 218
Expert2 unused count: 235
Expert1 balance top: 79.833984375
Expert2 balance top: 85.25390625

New cuda time: 2.4163310527801514
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4972920417785645
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1100.79150390625, gpu time: 212.42112636566162
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 11.376953125
Expert1 unused count: 146
Expert2 unused count: 268
Expert1 balance top: 71.435546875
Expert2 balance top: 90.087890625

New cuda time: 2.433290958404541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4435319900512695
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1270.837646484375, gpu time: 220.54404401779175
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 2.5390625
Expert1 unused count: 165
Expert2 unused count: 295
Expert1 balance top: 74.21875
Expert2 balance top: 91.796875

New cuda time: 2.424010992050171
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.433290958404541
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1246.57958984375, gpu time: 212.7016019821167
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.470703125
Expert1 unused count: 164
Expert2 unused count: 281
Expert1 balance top: 73.681640625
Expert2 balance top: 91.162109375

New cuda time: 2.458251953125
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4793710708618164
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1276.04248046875, gpu time: 214.7883381843567
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 7.71484375
Expert1 unused count: 173
Expert2 unused count: 251
Expert1 balance top: 76.513671875
Expert2 balance top: 87.646484375

New cuda time: 2.4582509994506836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6041719913482666
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1269.01513671875, gpu time: 222.01188445091248
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.884765625
Expert1 unused count: 190
Expert2 unused count: 254
Expert1 balance top: 77.587890625
Expert2 balance top: 86.669921875

New cuda time: 2.4268910884857178
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841721057891846
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1279.832763671875, gpu time: 213.6022458076477
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 6.54296875
Expert1 unused count: 211
Expert2 unused count: 247
Expert1 balance top: 82.32421875
Expert2 balance top: 85.107421875

New cuda time: 2.424330949783325
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4684910774230957
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1126.135009765625, gpu time: 217.31394839286804
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.173828125
Expert2 overflow: 14.599609375
Expert1 unused count: 244
Expert2 unused count: 310
Expert1 balance top: 85.791015625
Expert2 balance top: 93.115234375

New cuda time: 2.4681708812713623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4614510536193848
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1298.354248046875, gpu time: 225.4736659526825
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.63671875
Expert2 overflow: 9.326171875
Expert1 unused count: 268
Expert2 unused count: 341
Expert1 balance top: 87.158203125
Expert2 balance top: 96.09375

New cuda time: 2.425771951675415
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4585719108581543
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1274.2919921875, gpu time: 217.58594489097595
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.732421875
Expert2 overflow: 7.8125
Expert1 unused count: 274
Expert2 unused count: 318
Expert1 balance top: 87.939453125
Expert2 balance top: 93.5546875

New cuda time: 2.418890953063965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462570905685425
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1303.58447265625, gpu time: 219.66980004310608
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.41796875
Expert2 overflow: 12.6953125
Expert1 unused count: 320
Expert2 unused count: 335
Expert1 balance top: 92.041015625
Expert2 balance top: 94.82421875

New cuda time: 2.4705710411071777
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4928109645843506
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1296.5751953125, gpu time: 226.975266456604
2024-07-11 01:35:28 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 18.603515625
Expert1 unused count: 345
Expert2 unused count: 340
Expert1 balance top: 93.408203125
Expert2 balance top: 95.166015625

New cuda time: 2.4369709491729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.546091079711914
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1307.52197265625, gpu time: 218.5853078365326
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.990234375
Expert1 unused count: 328
Expert2 unused count: 336
Expert1 balance top: 93.26171875
Expert2 balance top: 94.091796875

New cuda time: 2.4084908962249756
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5176119804382324
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1151.8984375, gpu time: 222.24005126953125
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.927734375
Expert2 overflow: 15.234375
Expert1 unused count: 275
Expert2 unused count: 314
Expert1 balance top: 87.79296875
Expert2 balance top: 94.091796875

New cuda time: 2.446410894393921
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489130973815918
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1325.941650390625, gpu time: 230.40920782089233
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.103515625
Expert2 overflow: 13.720703125
Expert1 unused count: 297
Expert2 unused count: 336
Expert1 balance top: 90.33203125
Expert2 balance top: 95.458984375

New cuda time: 2.4278509616851807
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495210886001587
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1301.861083984375, gpu time: 222.50900673866272
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 10.546875
Expert1 unused count: 292
Expert2 unused count: 338
Expert1 balance top: 89.892578125
Expert2 balance top: 95.556640625

New cuda time: 2.4310519695281982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.637131929397583
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1340.788330078125, gpu time: 224.73798298835754
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 18.212890625
Expert1 unused count: 305
Expert2 unused count: 316
Expert1 balance top: 91.357421875
Expert2 balance top: 92.67578125

New cuda time: 2.4380910396575928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4715309143066406
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1324.392578125, gpu time: 231.88488841056824
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 23.291015625
Expert1 unused count: 314
Expert2 unused count: 317
Expert1 balance top: 90.91796875
Expert2 balance top: 93.212890625

New cuda time: 2.442892074584961
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471532106399536
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1335.010009765625, gpu time: 223.4997320175171
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.40234375
Expert1 unused count: 326
Expert2 unused count: 334
Expert1 balance top: 93.115234375
Expert2 balance top: 93.896484375

New cuda time: 2.4520111083984375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.440330982208252
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1176.919189453125, gpu time: 227.13239336013794
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.689453125
Expert2 overflow: 17.7734375
Expert1 unused count: 327
Expert2 unused count: 351
Expert1 balance top: 92.1875
Expert2 balance top: 96.6796875

New cuda time: 2.4572908878326416
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5107319355010986
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1353.65771484375, gpu time: 235.37723064422607
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.537109375
Expert2 overflow: 16.89453125
Expert1 unused count: 339
Expert2 unused count: 367
Expert1 balance top: 92.7734375
Expert2 balance top: 97.8515625

New cuda time: 2.4430510997772217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.49265193939209
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1329.357666015625, gpu time: 227.44471073150635
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.12890625
Expert2 overflow: 11.1328125
Expert1 unused count: 327
Expert2 unused count: 359
Expert1 balance top: 93.45703125
Expert2 balance top: 97.314453125

New cuda time: 2.4164910316467285
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459851026535034
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1368.417236328125, gpu time: 229.6143250465393
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 20.3125
Expert1 unused count: 323
Expert2 unused count: 347
Expert1 balance top: 93.505859375
Expert2 balance top: 96.19140625

New cuda time: 2.454092025756836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4921720027923584
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1352.046630859375, gpu time: 236.83115148544312
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.103515625
Expert2 overflow: 31.005859375
Expert1 unused count: 342
Expert2 unused count: 360
Expert1 balance top: 95.947265625
Expert2 balance top: 97.607421875

New cuda time: 2.464651107788086
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477771043777466
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1362.611083984375, gpu time: 228.44215416908264
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 18.75
Expert1 unused count: 365
Expert2 unused count: 370
Expert1 balance top: 97.65625
Expert2 balance top: 98.095703125

New cuda time: 2.4488110542297363
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.512171983718872
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1202.87890625, gpu time: 232.09337639808655
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.57421875
Expert1 unused count: 164
Expert2 unused count: 278
Expert1 balance top: 73.2421875
Expert2 balance top: 90.869140625

New cuda time: 2.413770914077759
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482090950012207
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1381.110595703125, gpu time: 240.27309250831604
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 6.787109375
Expert1 unused count: 159
Expert2 unused count: 311
Expert1 balance top: 75.634765625
Expert2 balance top: 93.359375

New cuda time: 2.4552109241485596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439371109008789
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1356.841796875, gpu time: 232.3392927646637
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.748046875
Expert1 unused count: 161
Expert2 unused count: 299
Expert1 balance top: 75.0
Expert2 balance top: 91.943359375

New cuda time: 2.4308910369873047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6120119094848633
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1405.51318359375, gpu time: 234.65722799301147
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.27734375
Expert1 unused count: 188
Expert2 unused count: 287
Expert1 balance top: 76.806640625
Expert2 balance top: 90.478515625

New cuda time: 2.4296109676361084
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4734508991241455
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1379.65380859375, gpu time: 241.73421335220337
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 10.986328125
Expert1 unused count: 187
Expert2 unused count: 257
Expert1 balance top: 79.296875
Expert2 balance top: 88.37890625

New cuda time: 2.4782509803771973
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5036909580230713
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1390.076416015625, gpu time: 233.4240961074829
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.666015625
Expert1 unused count: 222
Expert2 unused count: 240
Expert1 balance top: 81.787109375
Expert2 balance top: 85.205078125

New cuda time: 2.470890998840332
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45137095451355
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1228.737060546875, gpu time: 237.01563835144043
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 12.109375
Expert1 unused count: 199
Expert2 unused count: 302
Expert1 balance top: 79.00390625
Expert2 balance top: 93.26171875

New cuda time: 2.416810989379883
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470731019973755
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1408.497314453125, gpu time: 245.16063451766968
2024-07-11 01:35:29 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.419921875
Expert2 overflow: 13.330078125
Expert1 unused count: 231
Expert2 unused count: 301
Expert1 balance top: 83.0078125
Expert2 balance top: 92.822265625

New cuda time: 2.4489710330963135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516972064971924
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1384.553466796875, gpu time: 237.30523586273193
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 16.357421875
Expert1 unused count: 243
Expert2 unused count: 305
Expert1 balance top: 84.27734375
Expert2 balance top: 92.87109375

New cuda time: 2.437450885772705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4723310470581055
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1433.037841796875, gpu time: 239.56700992584229
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.857421875
Expert2 overflow: 11.42578125
Expert1 unused count: 252
Expert2 unused count: 287
Expert1 balance top: 84.86328125
Expert2 balance top: 90.0390625

New cuda time: 2.4296109676361084
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4636919498443604
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1407.05810546875, gpu time: 246.62751626968384
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 18.603515625
Expert1 unused count: 280
Expert2 unused count: 290
Expert1 balance top: 87.939453125
Expert2 balance top: 89.794921875

New cuda time: 2.429932117462158
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468010902404785
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1422.2294921875, gpu time: 238.32203912734985
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.884765625
Expert2 overflow: 11.23046875
Expert1 unused count: 317
Expert2 unused count: 296
Expert1 balance top: 93.26171875
Expert2 balance top: 90.13671875

New cuda time: 2.4614510536193848
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475851058959961
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1253.84130859375, gpu time: 241.95294046401978
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.41796875
Expert2 overflow: 20.60546875
Expert1 unused count: 316
Expert2 unused count: 357
Expert1 balance top: 93.1640625
Expert2 balance top: 97.265625

New cuda time: 2.4406509399414062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4673709869384766
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1435.99462890625, gpu time: 250.06865644454956
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.1484375
Expert2 overflow: 12.255859375
Expert1 unused count: 317
Expert2 unused count: 365
Expert1 balance top: 93.603515625
Expert2 balance top: 97.412109375

New cuda time: 2.4409708976745605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6560120582580566
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1422.2392578125, gpu time: 242.40221881866455
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 5.95703125
Expert1 unused count: 327
Expert2 unused count: 345
Expert1 balance top: 93.115234375
Expert2 balance top: 95.263671875

New cuda time: 2.46993088722229
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460810899734497
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1461.197265625, gpu time: 244.49775171279907
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.734375
Expert2 overflow: 10.83984375
Expert1 unused count: 337
Expert2 unused count: 340
Expert1 balance top: 94.873046875
Expert2 balance top: 94.873046875

New cuda time: 2.4303998947143555
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4535999298095703
New cuda time: 2.4363200664520264
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472640037536621
New cuda time: 2.4588799476623535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4915199279785156
New cuda time: 2.613759994506836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4334399700164795
New cuda time: 2.481920003890991
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483361005783081
New cuda time: 2.463520050048828
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4839999675750732
New cuda time: 2.4201600551605225
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4494409561157227
New cuda time: 2.4596800804138184
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4992001056671143
New cuda time: 2.480799913406372
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468961000442505
New cuda time: 2.467360019683838
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4558401107788086
New cuda time: 2.449120044708252
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4932799339294434
New cuda time: 2.451359987258911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854400157928467
New cuda time: 2.4214398860931396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4407999515533447
New cuda time: 2.4108800888061523
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4595210552215576
New cuda time: 2.4729599952697754
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6404800415039062
New cuda time: 2.451200008392334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4272000789642334
New cuda time: 2.4275200366973877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4656009674072266
New cuda time: 2.4630401134490967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481920003890991
New cuda time: 2.456160068511963
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47760009765625
New cuda time: 2.457279920578003
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4528000354766846
New cuda time: 2.4423999786376953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457279920578003
New cuda time: 2.4478399753570557
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4700798988342285
New cuda time: 2.4060800075531006
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4535999298095703
New cuda time: 2.467360019683838
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4560000896453857
New cuda time: 2.4569599628448486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4966399669647217
New cuda time: 2.44320011138916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4790399074554443
New cuda time: 2.620959997177124
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.445919990539551
New cuda time: 2.464639902114868
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4560000896453857
New cuda time: 2.4609599113464355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4499199390411377
New cuda time: 2.423520088195801
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452159881591797
New cuda time: 2.4852800369262695
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4662399291992188
New cuda time: 2.4803199768066406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489919900894165
New cuda time: 2.4447999000549316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.440160036087036
New cuda time: 2.4607999324798584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611198902130127
New cuda time: 2.4763200283050537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4668800830841064
New cuda time: 2.4335999488830566
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4366400241851807
New cuda time: 2.4636809825897217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5027201175689697
New cuda time: 2.4825599193573
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.618079900741577
New cuda time: 2.4260799884796143
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4270401000976562
New cuda time: 2.4176011085510254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.447200059890747
New cuda time: 2.4688000679016113
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4596800804138184
New cuda time: 2.433919906616211
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4576001167297363
New cuda time: 2.428800106048584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4801599979400635
New cuda time: 2.4518399238586426
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516160011291504
New cuda time: 2.468319892883301
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485919952392578
New cuda time: 2.4556798934936523
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.448960065841675
New cuda time: 2.445280075073242
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4628798961639404
New cuda time: 2.452159881591797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495039939880371
New cuda time: 2.4240000247955322
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6196799278259277
New cuda time: 2.4351999759674072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4579200744628906
New cuda time: 2.4769599437713623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4780800342559814
New cuda time: 2.4340810775756836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4446399211883545
New cuda time: 2.4721601009368896
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4860799312591553
New cuda time: 2.485919952392578
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472320079803467
New cuda time: 2.4465599060058594
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672000408172607
New cuda time: 2.46016001701355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.492959976196289
New cuda time: 2.5174400806427
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478879928588867
New cuda time: 2.466559886932373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4302399158477783
New cuda time: 2.4265599250793457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4427199363708496
New cuda time: 2.4763200283050537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4617600440979004
New cuda time: 2.5003199577331543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5675199031829834
New cuda time: 2.4377601146698
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479520082473755
New cuda time: 2.456480026245117
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4928009510040283
New cuda time: 2.4163200855255127
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.491039991378784
New cuda time: 2.429440975189209
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4577600955963135
New cuda time: 2.4620800018310547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4660799503326416
New cuda time: 2.488481044769287
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474400043487549
New cuda time: 2.480639934539795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464319944381714
New cuda time: 2.4223999977111816
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841599464416504
New cuda time: 2.46560001373291
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483839988708496
New cuda time: 2.4796810150146484
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.454080104827881
New cuda time: 2.447680950164795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.615999937057495
New cuda time: 2.4387199878692627
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.494719982147217
2.4470489025115967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4588890075683594
New cuda time: 2.432328939437866
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611289501190186
New cuda time: 2.4364891052246094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4673690795898438
New cuda time: 2.594409942626953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4409689903259277
New cuda time: 2.4182488918304443
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4852890968322754
New cuda time: 2.4537689685821533
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476649045944214
New cuda time: 2.4172890186309814
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459688901901245
New cuda time: 2.4304089546203613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476330041885376
New cuda time: 2.4502499103546143
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475369930267334
New cuda time: 2.4206490516662598
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4475290775299072
New cuda time: 2.435209035873413
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4510490894317627
New cuda time: 2.4534499645233154
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477768898010254
New cuda time: 2.4876890182495117
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547290802001953
New cuda time: 2.4326488971710205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4590489864349365
New cuda time: 2.457608938217163
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6344099044799805
New cuda time: 2.440169095993042
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.42720890045166
New cuda time: 2.4579288959503174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441448926925659
New cuda time: 2.4273691177368164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4664089679718018
New cuda time: 2.4468889236450195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4809699058532715
New cuda time: 2.4430489540100098
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4368090629577637
New cuda time: 2.4244890213012695
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4619300365448
New cuda time: 2.479849100112915
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470568895339966
New cuda time: 2.436008930206299
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439208984375
New cuda time: 2.4328091144561768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.450568914413452
New cuda time: 2.437129020690918
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471369981765747
New cuda time: 2.4540889263153076
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649689197540283
New cuda time: 2.5822501182556152
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4793689250946045
New cuda time: 2.466568946838379
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4784090518951416
New cuda time: 2.452810049057007
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44064998626709
New cuda time: 2.434088945388794
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4702489376068115
New cuda time: 2.4296090602874756
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472809076309204
New cuda time: 2.428169012069702
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489928960800171
New cuda time: 2.4417688846588135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4344089031219482
New cuda time: 2.491209030151367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4590489864349365
New cuda time: 2.453608989715576
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480648994445801
New cuda time: 2.4376089572906494
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4622490406036377
New cuda time: 2.4256091117858887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459688901901245
New cuda time: 2.4643290042877197
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.639050006866455
New cuda time: 2.5000100135803223
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4321699142456055
New cuda time: 2.449129104614258
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446249008178711
New cuda time: 2.442409038543701
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468329906463623
New cuda time: 2.475529909133911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446089029312134
New cuda time: 2.434890031814575
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4528090953826904
New cuda time: 2.4262490272521973
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516170024871826
New cuda time: 2.4419291019439697
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478888988494873
New cuda time: 2.4476890563964844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4516899585723877
New cuda time: 2.4368090629577637
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4721689224243164
New cuda time: 2.441448926925659
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489928960800171
New cuda time: 2.4284889698028564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.54544997215271
New cuda time: 2.47248911857605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469449043273926
New cuda time: 2.4336090087890625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4752089977264404
New cuda time: 2.4110488891601562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.448328971862793
New cuda time: 2.423048973083496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569690227508545
New cuda time: 2.4619290828704834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812889099121094
New cuda time: 2.4731290340423584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441770076751709
New cuda time: 2.430569887161255
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4832100868225098
New cuda time: 2.514090061187744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672091007232666
New cuda time: 2.4328091144561768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.436168909072876
New cuda time: 2.431049108505249
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4467289447784424
New cuda time: 2.4334490299224854
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4676899909973145
New cuda time: 2.473449945449829
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5776100158691406
New cuda time: 2.4310500621795654
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4592089653015137
New cuda time: 2.4326488971710205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4702489376068115
New cuda time: 2.4720089435577393
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.448168992996216
New cuda time: 2.436008930206299
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472649097442627
New cuda time: 2.433769941329956
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470729112625122
New cuda time: 2.458569049835205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4763290882110596
New cuda time: 2.4547290802001953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446408987045288
New cuda time: 2.4440090656280518
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4904088973999023
New cuda time: 2.49216890335083
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691290855407715
New cuda time: 2.4131290912628174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488089084625244
New cuda time: 2.416008949279785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6268889904022217
New cuda time: 2.465609073638916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4579288959503174
New cuda time: 2.442249059677124torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464310884475708
New cuda time: 2.4297499656677246
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46655011177063
New cuda time: 2.419990062713623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.516469955444336
New cuda time: 2.591348886489868
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474231004714966
New cuda time: 2.451349973678589
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474231004714966
New cuda time: 2.419990062713623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.504309892654419
New cuda time: 2.4291110038757324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4931108951568604
New cuda time: 2.441751003265381
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470870018005371
New cuda time: 2.437269926071167
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.558389902114868
New cuda time: 2.4465510845184326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475830078125
New cuda time: 2.430229902267456
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4751899242401123
New cuda time: 2.4420700073242188
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4451100826263428
New cuda time: 2.4548699855804443
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883100986480713
New cuda time: 2.425110101699829
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4614310264587402
New cuda time: 2.4291110038757324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6523098945617676
New cuda time: 2.4583899974823
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4940690994262695
New cuda time: 2.4539101123809814
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457429885864258
New cuda time: 2.427510976791382
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854300022125244
New cuda time: 2.4230310916900635
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.501110076904297
New cuda time: 2.4395110607147217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4559900760650635
New cuda time: 2.438230037689209
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4852709770202637
New cuda time: 2.4943900108337402
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4831910133361816
New cuda time: 2.4463911056518555
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462709903717041
New cuda time: 2.4353508949279785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4651100635528564
New cuda time: 2.4507100582122803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4555110931396484
New cuda time: 2.437911033630371
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4895899295806885
New cuda time: 2.5875089168548584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4571099281311035
New cuda time: 2.483510971069336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452630043029785
New cuda time: 2.4548709392547607
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4723100662231445
New cuda time: 2.4588708877563477
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4692699909210205
New cuda time: 2.4423909187316895
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4654300212860107
New cuda time: 2.446229934692383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4687910079956055
New cuda time: 2.4447898864746094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675099849700928
New cuda time: 2.487190008163452
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4636709690093994
New cuda time: 2.414551019668579
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469430923461914
New cuda time: 2.4403109550476074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487030029296875
New cuda time: 2.4407899379730225
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4897499084472656
New cuda time: 2.4299099445343018
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.610069990158081
New cuda time: 2.4635109901428223
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479830026626587
New cuda time: 2.4729509353637695
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4729509353637695
New cuda time: 2.4527909755706787
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4735898971557617
New cuda time: 2.453589916229248
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.52095103263855
New cuda time: 2.4411110877990723
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468950033187866
New cuda time: 2.457750082015991
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461590051651001
New cuda time: 2.446230888366699
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5555100440979004
New cuda time: 2.4503910541534424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5177509784698486
New cuda time: 2.436950922012329
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4907100200653076
New cuda time: 2.402390956878662
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.515510082244873
New cuda time: 2.447190046310425
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6319899559020996
New cuda time: 2.4529500007629395
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4628710746765137
New cuda time: 2.416949987411499
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4863901138305664
New cuda time: 2.4425508975982666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486069917678833
New cuda time: 2.4398300647735596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4755098819732666
New cuda time: 2.42271089553833
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5009500980377197
New cuda time: 2.438070058822632
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4739110469818115
New cuda time: 2.4300711154937744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4860711097717285
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4681499004364014
New cuda time: 2.4569509029388428
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4987099170684814
New cuda time: 2.4439899921417236
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4719910621643066
New cuda time: 2.4491100311279297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4505510330200195
New cuda time: 2.440951108932495
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.62431001663208
New cuda time: 2.44143009185791
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569499492645264
New cuda time: 2.456470012664795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4599900245666504
New cuda time: 2.4831910133361816
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627110958099365
New cuda time: 2.4212710857391357
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691109657287598
New cuda time: 2.4377501010894775
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.448791027069092
New cuda time: 2.4201509952545166
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483510971069336
New cuda time: 2.435991048812866
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467829942703247
New cuda time: 2.4865500926971436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5028700828552246
New cuda time: 2.4297499656677246
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467989921569824
New cuda time: 2.429270029067993
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451030969619751
New cuda time: 2.4399900436401367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6422290802001953
New cuda time: 2.430229902267456
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462230920791626
New cuda time: 2.4508700370788574
New cuda time: 2.433290958404541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4940919876098633
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1434.767578125, gpu time: 251.55489921569824
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.345703125
Expert2 overflow: 29.833984375
Expert1 unused count: 343
Expert2 unused count: 356
Expert1 balance top: 95.1171875
Expert2 balance top: 97.0703125

New cuda time: 2.439210891723633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4592111110687256
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1449.818359375, gpu time: 243.2204611301422
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.515625
Expert2 overflow: 22.265625
Expert1 unused count: 363
Expert2 unused count: 345
Expert1 balance top: 97.412109375
Expert2 balance top: 95.8984375

New cuda time: 2.449450969696045
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4369709491729736
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1279.46533203125, gpu time: 246.8393623828888
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.8828125
Expert1 unused count: 198
Expert2 unused count: 299
Expert1 balance top: 80.615234375
Expert2 balance top: 92.578125

New cuda time: 2.446410894393921
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4409708976745605
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1463.805908203125, gpu time: 254.95603942871094
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.73828125
Expert1 unused count: 216
Expert2 unused count: 315
Expert1 balance top: 81.54296875
Expert2 balance top: 94.677734375

New cuda time: 2.408010959625244
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4766509532928467
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1449.88330078125, gpu time: 247.28688073158264
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 15.234375
Expert1 unused count: 233
Expert2 unused count: 313
Expert1 balance top: 82.8125
Expert2 balance top: 94.287109375

New cuda time: 2.4638519287109375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.521291971206665
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1488.74560546875, gpu time: 249.48289465904236
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.9375
Expert1 unused count: 231
Expert2 unused count: 282
Expert1 balance top: 81.103515625
Expert2 balance top: 91.015625

New cuda time: 2.4352118968963623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468332052230835
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1462.403076171875, gpu time: 256.45844316482544
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 19.140625
Expert1 unused count: 271
Expert2 unused count: 305
Expert1 balance top: 86.81640625
Expert2 balance top: 92.7734375

New cuda time: 2.4244909286499023
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4593710899353027
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1477.425048828125, gpu time: 248.10432314872742
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.935546875
Expert1 unused count: 265
Expert2 unused count: 284
Expert1 balance top: 87.5
Expert2 balance top: 88.76953125

New cuda time: 2.412170886993408
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.49937105178833
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1304.70263671875, gpu time: 251.75090432167053
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.125
Expert1 unused count: 81
Expert2 unused count: 220
Expert1 balance top: 53.759765625
Expert2 balance top: 83.642578125

New cuda time: 2.4256110191345215
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4697721004486084
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1491.4521484375, gpu time: 259.85142254829407
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.748046875
Expert1 unused count: 97
Expert2 unused count: 280
Expert1 balance top: 54.296875
Expert2 balance top: 91.357421875

New cuda time: 2.5880119800567627
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4792120456695557
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1487.01025390625, gpu time: 252.35410475730896
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.71875
Expert1 unused count: 120
Expert2 unused count: 250
Expert1 balance top: 58.88671875
Expert2 balance top: 89.013671875

New cuda time: 2.4488110542297363
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.501291036605835
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1516.462158203125, gpu time: 254.43299674987793
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.572265625
Expert1 unused count: 112
Expert2 unused count: 224
Expert1 balance top: 62.109375
Expert2 balance top: 84.765625

New cuda time: 2.4398510456085205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477771043777466
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1490.024658203125, gpu time: 261.3760652542114
2024-07-11 01:35:30 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.833984375
Expert1 unused count: 145
Expert2 unused count: 196
Expert1 balance top: 63.916015625
Expert2 balance top: 77.734375

New cuda time: 2.644653081893921
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472970962524414
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1508.96533203125, gpu time: 253.22194719314575
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.7578125
Expert1 unused count: 174
Expert2 unused count: 190
Expert1 balance top: 69.3359375
Expert2 balance top: 76.025390625

New cuda time: 2.410090923309326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479851007461548
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1330.8984375, gpu time: 256.6408462524414
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.220703125
Expert1 unused count: 141
Expert2 unused count: 273
Expert1 balance top: 59.765625
Expert2 balance top: 88.818359375

New cuda time: 2.436171054840088
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452012062072754
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1518.974609375, gpu time: 264.7396066188812
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.056640625
Expert1 unused count: 148
Expert2 unused count: 292
Expert1 balance top: 61.962890625
Expert2 balance top: 90.91796875

New cuda time: 2.446571111679077
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4532909393310547
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1514.7451171875, gpu time: 257.2539668083191
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.005859375
Expert1 unused count: 169
Expert2 unused count: 265
Expert1 balance top: 63.28125
Expert2 balance top: 88.720703125

New cuda time: 2.4320108890533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.514570951461792
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1544.067626953125, gpu time: 259.37957859039307
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.544921875
Expert1 unused count: 151
Expert2 unused count: 248
Expert1 balance top: 62.5
Expert2 balance top: 85.83984375

New cuda time: 2.4446520805358887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449291944503784
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1517.550537109375, gpu time: 266.2700092792511
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.0859375
Expert1 unused count: 182
Expert2 unused count: 223
Expert1 balance top: 71.533203125
Expert2 balance top: 84.5703125

New cuda time: 2.4387309551239014
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.427371025085449
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1539.43798828125, gpu time: 258.0880491733551
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.453125
Expert1 unused count: 203
Expert2 unused count: 223
Expert1 balance top: 74.462890625
Expert2 balance top: 83.447265625

New cuda time: 2.4224109649658203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4756920337677
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1355.933837890625, gpu time: 261.5389492511749
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.056640625
Expert1 unused count: 158
Expert2 unused count: 268
Expert1 balance top: 71.6796875
Expert2 balance top: 89.6484375

New cuda time: 2.4553709030151367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.598252058029175
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1556.08154296875, gpu time: 269.79322957992554
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.37109375
Expert1 unused count: 175
Expert2 unused count: 291
Expert1 balance top: 76.806640625
Expert2 balance top: 91.30859375

New cuda time: 2.4355309009552
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.447371006011963
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1542.473876953125, gpu time: 262.13686871528625
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 6.982421875
Expert1 unused count: 186
Expert2 unused count: 285
Expert1 balance top: 76.7578125
Expert2 balance top: 90.91796875

New cuda time: 2.432171106338501
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466092109680176
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1571.660888671875, gpu time: 264.27784180641174
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 7.8125
Expert1 unused count: 215
Expert2 unused count: 282
Expert1 balance top: 80.2734375
Expert2 balance top: 89.697265625

New cuda time: 2.467850923538208
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4947309494018555
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1545.27294921875, gpu time: 271.23259234428406
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.357421875
Expert1 unused count: 222
Expert2 unused count: 277
Expert1 balance top: 83.740234375
Expert2 balance top: 90.673828125

New cuda time: 2.425291061401367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598519802093506
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1567.11767578125, gpu time: 262.9731922149658
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.296875
Expert2 overflow: 3.759765625
Expert1 unused count: 259
Expert2 unused count: 264
Expert1 balance top: 87.451171875
Expert2 balance top: 86.376953125

New cuda time: 2.4345719814300537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.436331033706665
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1381.345458984375, gpu time: 266.40985226631165
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.791015625
Expert1 unused count: 115
Expert2 unused count: 265
Expert1 balance top: 67.041015625
Expert2 balance top: 89.794921875

New cuda time: 2.442410945892334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782519340515137
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1583.63525390625, gpu time: 274.7138924598694
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.32421875
Expert1 unused count: 108
Expert2 unused count: 297
Expert1 balance top: 66.69921875
Expert2 balance top: 93.26171875

New cuda time: 2.402570962905884
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483051061630249
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1570.223388671875, gpu time: 267.0224907398224
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.623046875
Expert1 unused count: 122
Expert2 unused count: 282
Expert1 balance top: 68.45703125
Expert2 balance top: 91.455078125

New cuda time: 2.448331117630005
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4696109294891357
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1599.370361328125, gpu time: 269.1957848072052
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.4453125
Expert1 unused count: 122
Expert2 unused count: 240
Expert1 balance top: 68.115234375
Expert2 balance top: 86.767578125

New cuda time: 2.4369709491729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4974520206451416
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1572.895263671875, gpu time: 276.1670153141022
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 9.47265625
Expert1 unused count: 152
Expert2 unused count: 218
Expert1 balance top: 72.16796875
Expert2 balance top: 85.546875

New cuda time: 2.4825708866119385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4489710330963135
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1594.91015625, gpu time: 267.90473532676697
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.490234375
Expert2 overflow: 5.615234375
Expert1 unused count: 147
Expert2 unused count: 194
Expert1 balance top: 72.36328125
Expert2 balance top: 79.8828125

New cuda time: 2.4508910179138184
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.640491008758545
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1416.824951171875, gpu time: 271.5012352466583
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 8.984375
Expert1 unused count: 222
Expert2 unused count: 319
Expert1 balance top: 78.3203125
Expert2 balance top: 93.9453125

New cuda time: 2.454252004623413
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4716908931732178
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1611.40478515625, gpu time: 279.639835357666
2024-07-11 01:35:31 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 3.80859375
Expert1 unused count: 240
Expert2 unused count: 309
Expert1 balance top: 81.591796875
Expert2 balance top: 92.48046875

New cuda time: 2.3984110355377197
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5328121185302734
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1597.99267578125, gpu time: 271.95371294021606
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 6.494140625
Expert1 unused count: 252
Expert2 unused count: 309
Expert1 balance top: 80.908203125
Expert2 balance top: 93.212890625

New cuda time: 2.447371006011963
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46065092086792
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1627.004638671875, gpu time: 274.1038067340851
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.736328125
Expert2 overflow: 8.544921875
Expert1 unused count: 261
Expert2 unused count: 293
Expert1 balance top: 84.716796875
Expert2 balance top: 90.771484375

New cuda time: 2.440330982208252
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489290952682495
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1600.704345703125, gpu time: 281.0966372489929
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 7.861328125
Expert1 unused count: 283
Expert2 unused count: 305
Expert1 balance top: 87.548828125
Expert2 balance top: 91.455078125

New cuda time: 2.4673709869384766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 5.132503986358643
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1625.14453125, gpu time: 275.5046103000641
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.318359375
Expert2 overflow: 9.27734375
Expert1 unused count: 303
Expert2 unused count: 298
Expert1 balance top: 90.576171875
Expert2 balance top: 90.087890625

New cuda time: 2.412010908126831
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5374510288238525
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1442.56201171875, gpu time: 276.450697183609
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.7890625
Expert2 overflow: 9.765625
Expert1 unused count: 292
Expert2 unused count: 337
Expert1 balance top: 87.98828125
Expert2 balance top: 95.751953125

New cuda time: 2.448491096496582
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483531951904297
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1639.1884765625, gpu time: 284.5718584060669
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.4453125
Expert2 overflow: 4.6875
Expert1 unused count: 307
Expert2 unused count: 343
Expert1 balance top: 89.794921875
Expert2 balance top: 95.41015625

New cuda time: 2.3891310691833496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4624109268188477
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1625.63525390625, gpu time: 276.80525493621826
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.1484375
Expert2 overflow: 5.078125
Expert1 unused count: 297
Expert2 unused count: 337
Expert1 balance top: 87.841796875
Expert2 balance top: 93.994140625

New cuda time: 2.4481709003448486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4808120727539062
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1654.807373046875, gpu time: 279.03278970718384
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.296875
Expert2 overflow: 8.056640625
Expert1 unused count: 299
Expert2 unused count: 324
Expert1 balance top: 88.57421875
Expert2 balance top: 92.96875

New cuda time: 2.446571111679077
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46881103515625
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1628.44873046875, gpu time: 286.01201939582825
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 16.40625
Expert1 unused count: 322
Expert2 unused count: 344
Expert1 balance top: 92.041015625
Expert2 balance top: 95.80078125

New cuda time: 2.4496119022369385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47953200340271
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1652.770263671875, gpu time: 280.43375420570374
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 16.2109375
Expert1 unused count: 332
Expert2 unused count: 344
Expert1 balance top: 93.798828125
Expert2 balance top: 95.3125

New cuda time: 2.431051015853882
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.615370988845825
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1478.361572265625, gpu time: 281.4971191883087
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.6875
Expert1 unused count: 130
Expert2 unused count: 234
Expert1 balance top: 67.529296875
Expert2 balance top: 85.9375

New cuda time: 2.4308910369873047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4355309009552
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1666.827880859375, gpu time: 289.4382803440094
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.9296875
Expert1 unused count: 151
Expert2 unused count: 291
Expert1 balance top: 73.779296875
Expert2 balance top: 91.89453125

New cuda time: 2.445291042327881
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4315309524536133
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1653.346435546875, gpu time: 281.68207693099976
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.275390625
Expert1 unused count: 154
Expert2 unused count: 264
Expert1 balance top: 73.681640625
Expert2 balance top: 88.623046875

New cuda time: 2.450731039047241
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.52321195602417
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1682.630126953125, gpu time: 284.00673270225525
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.958984375
Expert1 unused count: 177
Expert2 unused count: 258
Expert1 balance top: 74.609375
Expert2 balance top: 88.57421875

New cuda time: 2.438091993331909
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481131076812744
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1656.090576171875, gpu time: 290.9312424659729
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.396484375
Expert1 unused count: 222
Expert2 unused count: 252
Expert1 balance top: 80.46875
Expert2 balance top: 86.62109375

New cuda time: 2.456650972366333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5003321170806885
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1680.402587890625, gpu time: 285.39073729515076
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 2.44140625
Expert1 unused count: 214
Expert2 unused count: 221
Expert1 balance top: 81.25
Expert2 balance top: 80.810546875

New cuda time: 2.4275310039520264
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4620909690856934
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1503.64453125, gpu time: 286.38674116134644
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.912109375
Expert2 overflow: 9.814453125
Expert1 unused count: 294
Expert2 unused count: 344
Expert1 balance top: 88.4765625
Expert2 balance top: 96.044921875

New cuda time: 2.432331085205078
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5262510776519775
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1694.561767578125, gpu time: 294.39686346054077
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.982421875
Expert2 overflow: 7.177734375
Expert1 unused count: 306
Expert2 unused count: 341
Expert1 balance top: 89.453125
Expert2 balance top: 94.580078125

New cuda time: 2.4584109783172607
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4708919525146484
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1681.060302734375, gpu time: 286.61137986183167
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.294921875
Expert2 overflow: 2.34375
Expert1 unused count: 298
Expert2 unused count: 338
Expert1 balance top: 87.59765625
Expert2 balance top: 94.43359375

New cuda time: 2.3972909450531006
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.533452033996582
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1710.270751953125, gpu time: 288.93747568130493
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.052734375
Expert2 overflow: 8.349609375
Expert1 unused count: 313
Expert2 unused count: 318
Expert1 balance top: 89.990234375
Expert2 balance top: 93.1640625

New cuda time: 2.450731039047241
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5443310737609863
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1683.767822265625, gpu time: 295.9263045787811
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.318359375
Expert2 overflow: 12.744140625
Expert1 unused count: 327
Expert2 unused count: 342
Expert1 balance top: 92.626953125
Expert2 balance top: 95.41015625

New cuda time: 2.4339311122894287
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487210988998413
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1707.970458984375, gpu time: 290.3118793964386
2024-07-11 01:35:32 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.708984375
Expert2 overflow: 11.279296875
Expert1 unused count: 336
Expert2 unused count: 333
Expert1 balance top: 93.701171875
Expert2 balance top: 93.994140625

New cuda time: 2.620651960372925
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473931074142456
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1542.574462890625, gpu time: 291.4813241958618
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 6.787109375
Expert1 unused count: 188
Expert2 unused count: 286
Expert1 balance top: 72.705078125
Expert2 balance top: 91.015625

New cuda time: 2.451371908187866
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482250928878784
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1722.28125, gpu time: 299.3304862976074
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.66015625
Expert1 unused count: 226
Expert2 unused count: 309
Expert1 balance top: 77.294921875
Expert2 balance top: 92.578125

New cuda time: 2.427051067352295
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458570957183838
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1708.732666015625, gpu time: 291.4970018863678
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.6875
Expert1 unused count: 218
Expert2 unused count: 305
Expert1 balance top: 75.537109375
Expert2 balance top: 90.576171875

New cuda time: 2.4451310634613037
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691319465637207
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1737.891357421875, gpu time: 293.85173869132996
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 8.203125
Expert1 unused count: 249
Expert2 unused count: 297
Expert1 balance top: 79.8828125
Expert2 balance top: 91.015625

New cuda time: 2.4492909908294678
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4761710166931152
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1711.581787109375, gpu time: 300.8517665863037
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.76953125
Expert1 unused count: 273
Expert2 unused count: 307
Expert1 balance top: 83.59375
Expert2 balance top: 90.91796875

New cuda time: 2.4467310905456543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4937710762023926
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1735.79443359375, gpu time: 295.25238156318665
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.837890625
Expert1 unused count: 288
Expert2 unused count: 297
Expert1 balance top: 87.548828125
Expert2 balance top: 88.671875

New cuda time: 2.442250967025757
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4785709381103516
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1568.108642578125, gpu time: 296.4021461009979
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.25
Expert2 overflow: 4.6875
Expert1 unused count: 267
Expert2 unused count: 341
Expert1 balance top: 83.7890625
Expert2 balance top: 95.947265625

New cuda time: 2.4456119537353516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4804909229278564
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1749.6083984375, gpu time: 304.25658917427063
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.126953125
Expert2 overflow: 4.4921875
Expert1 unused count: 288
Expert2 unused count: 341
Expert1 balance top: 85.546875
Expert2 balance top: 95.1171875

New cuda time: 2.43441104888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4800119400024414
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1736.388671875, gpu time: 296.4114248752594
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.513671875
Expert2 overflow: 2.24609375
Expert1 unused count: 294
Expert2 unused count: 338
Expert1 balance top: 84.521484375
Expert2 balance top: 94.775390625

New cuda time: 2.444011926651001
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502091884613037
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1765.57421875, gpu time: 298.797842502594
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.345703125
Expert2 overflow: 8.69140625
Expert1 unused count: 289
Expert2 unused count: 321
Expert1 balance top: 85.9375
Expert2 balance top: 93.26171875

New cuda time: 2.412971019744873
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.51009202003479
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1739.115234375, gpu time: 305.7748296260834
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 13.671875
Expert1 unused count: 313
Expert2 unused count: 330
Expert1 balance top: 90.625
Expert2 balance top: 94.62890625

New cuda time: 2.4584109783172607
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6224119663238525
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1773.786376953125, gpu time: 300.3332054615021
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.83203125
Expert2 overflow: 17.96875
Expert1 unused count: 339
Expert2 unused count: 326
Expert1 balance top: 93.9453125
Expert2 balance top: 93.84765625

New cuda time: 2.469451904296875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4736111164093018
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1592.22802734375, gpu time: 301.3452091217041
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.953125
Expert2 overflow: 11.572265625
Expert1 unused count: 162
Expert2 unused count: 277
Expert1 balance top: 75.146484375
Expert2 balance top: 91.9921875

New cuda time: 2.4784109592437744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470731019973755
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1776.654296875, gpu time: 309.20573115348816
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.955078125
Expert2 overflow: 12.79296875
Expert1 unused count: 182
Expert2 unused count: 292
Expert1 balance top: 77.587890625
Expert2 balance top: 92.333984375

New cuda time: 2.437772035598755
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5008111000061035
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1763.3896484375, gpu time: 301.35000801086426
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 16.357421875
Expert1 unused count: 196
Expert2 unused count: 301
Expert1 balance top: 79.345703125
Expert2 balance top: 92.3828125

New cuda time: 2.4294509887695312
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472011089324951
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1792.745849609375, gpu time: 303.6993045806885
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.78515625
Expert2 overflow: 12.353515625
Expert1 unused count: 224
Expert2 unused count: 288
Expert1 balance top: 81.884765625
Expert2 balance top: 90.72265625

New cuda time: 2.4419310092926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449770927429199
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1765.782958984375, gpu time: 310.6665325164795
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 18.84765625
Expert1 unused count: 229
Expert2 unused count: 274
Expert1 balance top: 82.8125
Expert2 balance top: 89.94140625

New cuda time: 2.463840961456299
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4476799964904785
New cuda time: 2.4576010704040527
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4544010162353516
New cuda time: 2.4526400566101074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475519895553589
New cuda time: 2.469759941101074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471359968185425
New cuda time: 2.437441110610962
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4779200553894043
New cuda time: 2.4577600955963135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5139200687408447
New cuda time: 2.4585609436035156
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4736011028289795
New cuda time: 2.4316799640655518
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4617600440979004
New cuda time: 2.437920093536377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5033600330352783
New cuda time: 2.4953598976135254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4721601009368896
New cuda time: 2.5992000102996826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.430880069732666
New cuda time: 2.425601005554199
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5012800693511963
New cuda time: 2.4827210903167725
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4800000190734863
New cuda time: 2.6631999015808105
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4577600955963135
New cuda time: 2.4516799449920654
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4711999893188477
New cuda time: 2.484800100326538
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485919952392578
New cuda time: 2.4542410373687744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458559989929199
New cuda time: 2.4318408966064453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502880096435547
New cuda time: 2.4675209522247314
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469759941101074
New cuda time: 2.4990410804748535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710400104522705
New cuda time: 2.4211199283599854
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453439950942993
New cuda time: 2.473439931869507
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.605600118637085
New cuda time: 2.4667210578918457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488000869750977
New cuda time: 2.439199924468994
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611198902130127
New cuda time: 2.4750399589538574
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4771199226379395
New cuda time: 2.475519895553589
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.503200054168701
New cuda time: 2.4678399562835693
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611198902130127
New cuda time: 2.4407999515533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600000381469727
New cuda time: 2.478559970855713
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461280107498169
New cuda time: 2.4556798934936523
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4385600090026855
New cuda time: 2.4560000896453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4456000328063965
New cuda time: 2.486720085144043
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4719998836517334
New cuda time: 2.479680061340332
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5433599948883057
New cuda time: 2.448000907897949
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4636800289154053
New cuda time: 2.4803199768066406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47871994972229
New cuda time: 2.465440034866333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489759922027588
New cuda time: 2.463520050048828
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4505600929260254
New cuda time: 2.467519998550415
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 5.209440231323242
New cuda time: 2.4468801021575928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468640089035034
New cuda time: 2.4598400592803955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4550399780273438
New cuda time: 2.5158400535583496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4537599086761475
New cuda time: 2.470720052719116
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4478399753570557
New cuda time: 2.4505600929260254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841599464416504
New cuda time: 2.497760057449341
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4763200283050537
New cuda time: 2.448960065841675
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5897600650787354
New cuda time: 2.464160919189453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569599628448486
New cuda time: 2.4588799476623535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462399959564209
New cuda time: 2.458400011062622
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477760076522827
New cuda time: 2.407520055770874
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46016001701355
New cuda time: 2.5311999320983887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672000408172607
New cuda time: 2.427680015563965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472960948944092
New cuda time: 2.460000991821289
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4779200553894043
New cuda time: 2.437920093536377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460000991821289
New cuda time: 2.4737610816955566
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461440086364746
New cuda time: 2.4507200717926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461760997772217
New cuda time: 2.4200010299682617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4688000679016113
New cuda time: 2.5931200981140137
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484800100326538
New cuda time: 2.442080020904541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480799913406372
New cuda time: 2.4507200717926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451200008392334
New cuda time: 2.4382410049438477
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627199172973633
New cuda time: 2.4548799991607666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4774410724639893
New cuda time: 2.423840045928955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4515199661254883
New cuda time: 2.4412810802459717
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463520050048828
New cuda time: 2.481600046157837
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4745609760284424
New cuda time: 2.466559886932373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489759922027588
New cuda time: 2.4315199851989746
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547200202941895
New cuda time: 2.4860799312591553
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461280107498169
New cuda time: 2.4312000274658203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6332809925079346
New cuda time: 2.405440092086792
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4580800533294678
New cuda time: 2.466559886932373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841599464416504
New cuda time: 2.4524800777435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812800884246826
New cuda time: 2.448319911956787
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467519998550415
New cuda time: 2.433919906616211
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4548799991607666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502549886703491
New cuda time: 2.4508700370788574
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480950117111206
New cuda time: 2.492790937423706
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.448470115661621
New cuda time: 2.440951108932495
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649500846862793
New cuda time: 2.44638991355896
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469589948654175
New cuda time: 2.427190065383911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451991081237793
New cuda time: 2.4115099906921387
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.500469923019409
New cuda time: 2.436310052871704
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467989921569824
New cuda time: 2.493109941482544
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4814300537109375
New cuda time: 2.435029983520508
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44638991355896
New cuda time: 2.61503005027771
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449270009994507
New cuda time: 2.4732699394226074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468151092529297
New cuda time: 2.409430980682373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458709955215454
New cuda time: 2.385111093521118
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4727909564971924
New cuda time: 2.476789951324463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487190008163452
New cuda time: 2.4172708988189697
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587109088897705
New cuda time: 2.444791078567505
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4756710529327393
New cuda time: 2.453911066055298
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4646310806274414
New cuda time: 2.440310001373291
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459350109100342
New cuda time: 2.442389965057373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4734299182891846
New cuda time: 2.464150905609131
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4791910648345947
New cuda time: 2.4495909214019775
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6031899452209473
New cuda time: 2.43471097946167
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483989953994751
New cuda time: 2.4409499168395996
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479029893875122
New cuda time: 2.450071096420288
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753499031066895
New cuda time: 2.433751106262207
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4825499057769775
New cuda time: 2.455190896987915
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.506071090698242
New cuda time: 2.4580700397491455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4862310886383057
New cuda time: 2.4174299240112305
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4899098873138428
New cuda time: 2.4406309127807617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488471031188965
New cuda time: 2.4385509490966797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4723100662231445
New cuda time: 2.4044699668884277
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4958300590515137
New cuda time: 2.459670066833496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6463890075683594
New cuda time: 2.455030918121338
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4767909049987793
New cuda time: 2.4247899055480957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5206298828125
New cuda time: 2.4478299617767334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5007901191711426
New cuda time: 2.447350025177002
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753499031066895
New cuda time: 2.425590991973877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 5.123341083526611
New cuda time: 2.444951057434082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5038299560546875
New cuda time: 2.4452710151672363
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486870050430298
New cuda time: 2.4271910190582275
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4550299644470215
New cuda time: 2.424149990081787
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4935901165008545
New cuda time: 2.437751054763794
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482551097869873
New cuda time: 2.4401509761810303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4852709770202637
New cuda time: 2.453429937362671
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6313490867614746
New cuda time: 2.427190065383911
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5179100036621094
New cuda time: 2.4758310317993164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.450390100479126
New cuda time: 2.430229902267456
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.51567006111145
New cuda time: 2.460951089859009
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4711899757385254
New cuda time: 2.455349922180176
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.500469923019409
New cuda time: 2.43710994720459
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4719910621643066
New cuda time: 2.4449501037597656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5100700855255127
New cuda time: 2.438070058822632
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4867100715637207
New cuda time: 2.4177510738372803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.54079008102417
New cuda time: 2.4151909351348877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.519351005554199
New cuda time: 2.452950954437256
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4699110984802246
New cuda time: 2.60575008392334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474390983581543
New cuda time: 2.4580700397491455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495990037918091
New cuda time: 2.442229986190796
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4775900840759277
New cuda time: 2.4492709636688232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461750030517578
New cuda time: 2.429590940475464
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463191032409668
New cuda time: 2.4449501037597656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5084710121154785
New cuda time: 2.46655011177063
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4879910945892334
New cuda time: 2.4486300945281982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.504791021347046
New cuda time: 2.423830986022949
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5035109519958496
New cuda time: 2.446230888366699
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4827098846435547
New cuda time: 2.419351100921631
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4897499084472656
New cuda time: 2.452310085296631
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.628469944000244
New cuda time: 2.4494309425354004
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482391119003296
New cuda time: 2.4131100177764893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4639909267425537
New cuda time: 2.435349941253662
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5055909156799316
New cuda time: 2.439990997314453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466870069503784
New cuda time: 2.4153499603271484
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569509029388428
New cuda time: 2.431349992752075
torch.Size([4, 128, 103, 768]) 
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4915289878845215
New cuda time: 2.4275290966033936
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479849100112915
New cuda time: 2.4585700035095215
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4844889640808105
New cuda time: 2.420008897781372
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883289337158203
New cuda time: 2.433129072189331
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4945690631866455
New cuda time: 2.4315290451049805
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4721689224243164
New cuda time: 2.4336090087890625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.490730047225952
New cuda time: 2.4404890537261963
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489928960800171
New cuda time: 2.47121000289917
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4804890155792236
New cuda time: 2.4467289447784424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611289501190186
New cuda time: 2.6076900959014893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476809024810791
New cuda time: 2.438570022583008
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4774489402770996
New cuda time: 2.4665699005126953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478888988494873
New cuda time: 2.6209700107574463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439368963241577
New cuda time: 2.4736099243164062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4704089164733887
New cuda time: 2.4470489025115967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4744091033935547
New cuda time: 2.449289083480835
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4766499996185303
New cuda time: 2.435689926147461
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444489002227783
New cuda time: 2.4662489891052246
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477449893951416
New cuda time: 2.4292891025543213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4643290042877197
New cuda time: 2.4070489406585693
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4537689685821533
New cuda time: 2.4649689197540283
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.621289014816284
New cuda time: 2.449129104614258
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4508891105651855
New cuda time: 2.45120906829834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444329023361206
New cuda time: 2.444329023361206
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598491191864014
New cuda time: 2.4358489513397217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470089912414551
New cuda time: 2.4262490272521973
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455688953399658
New cuda time: 2.446089029312134
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4680099487304688
New cuda time: 2.4747300148010254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598491191864014
New cuda time: 2.436328887939453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.436969041824341
New cuda time: 2.4337689876556396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675300121307373
New cuda time: 2.4528090953826904
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467689037322998
New cuda time: 2.447050094604492
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.549288034439087
New cuda time: 2.4384090900421143
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4616100788116455
New cuda time: 2.46048903465271
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4875290393829346
New cuda time: 2.4425690174102783
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4795289039611816
New cuda time: 2.4660890102386475
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4440090656280518
New cuda time: 2.433289051055908
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 5.101778984069824
New cuda time: 2.4867289066314697
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47792911529541
New cuda time: 2.434889078140259
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459049940109253
New cuda time: 2.508810043334961
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470889091491699
New cuda time: 2.440169095993042
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732890129089355
New cuda time: 2.4408090114593506
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4700889587402344
New cuda time: 2.508650064468384
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465449094772339
New cuda time: 2.4740889072418213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5753700733184814
New cuda time: 2.420969009399414
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467529058456421
New cuda time: 2.448168992996216
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471848964691162
New cuda time: 2.433129072189331
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481610059738159
New cuda time: 2.4590489864349365
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4523301124572754
New cuda time: 2.522568941116333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4784090518951416
New cuda time: 2.47248911857605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470249891281128
New cuda time: 2.443368911743164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464808940887451
New cuda time: 2.421928882598877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753689765930176
New cuda time: 2.4489688873291016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474569082260132
New cuda time: 2.4646499156951904
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4667301177978516
New cuda time: 2.4489688873291016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691290855407715
New cuda time: 2.6260900497436523
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.445288896560669
New cuda time: 2.435209035873413
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483048915863037
New cuda time: 2.4480080604553223
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45120906829834
New cuda time: 2.443208932876587
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.443368911743164
New cuda time: 2.4356889724731445
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484968900680542
New cuda time: 2.4403300285339355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4267289638519287
New cuda time: 2.4548890590667725
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468488931655884
New cuda time: 2.415688991546631
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4617691040039062
New cuda time: 2.435049057006836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476649045944214
New cuda time: 2.437288999557495
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481929063796997
New cuda time: 2.4804890155792236
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468648910522461
New cuda time: 2.46048903465271
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6288089752197266
New cuda time: 2.440329074859619
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4670488834381104
New cuda time: 2.431849956512451
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466728925704956
New cuda time: 2.4449689388275146
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.490730047225952
New cuda time: 2.4388890266418457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459688901901245
New cuda time: 2.4387290477752686
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4526491165161133
New cuda time: 2.4345688819885254
New cuda time: 2.4459309577941895
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.515052080154419
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1800.893310546875, gpu time: 305.2941884994507
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.564453125
Expert2 overflow: 5.126953125
Expert1 unused count: 261
Expert2 unused count: 273
Expert1 balance top: 86.9140625
Expert2 balance top: 87.40234375

New cuda time: 2.4104108810424805
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4996910095214844
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1616.935302734375, gpu time: 306.25531101226807
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 10.302734375
Expert1 unused count: 190
Expert2 unused count: 287
Expert1 balance top: 75.09765625
Expert2 balance top: 91.796875

New cuda time: 2.4564919471740723
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4788920879364014
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1804.30517578125, gpu time: 314.14111518859863
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.98046875
Expert1 unused count: 202
Expert2 unused count: 303
Expert1 balance top: 79.39453125
Expert2 balance top: 92.529296875

New cuda time: 2.4155309200286865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566519260406494
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1790.869384765625, gpu time: 306.2221908569336
2024-07-11 01:35:33 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 6.396484375
Expert1 unused count: 211
Expert2 unused count: 300
Expert1 balance top: 79.052734375
Expert2 balance top: 91.845703125

New cuda time: 2.4324910640716553
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611310958862305
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1820.1923828125, gpu time: 308.59292674064636
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.052734375
Expert2 overflow: 11.328125
Expert1 unused count: 227
Expert2 unused count: 291
Expert1 balance top: 80.37109375
Expert2 balance top: 91.015625

New cuda time: 2.451530933380127
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.624811887741089
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1803.5, gpu time: 315.7428753376007
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.5234375
Expert1 unused count: 225
Expert2 unused count: 272
Expert1 balance top: 82.71484375
Expert2 balance top: 90.13671875

New cuda time: 2.4144110679626465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.496330976486206
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1828.720458984375, gpu time: 310.20493054389954
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 5.6640625
Expert1 unused count: 248
Expert2 unused count: 270
Expert1 balance top: 85.400390625
Expert2 balance top: 87.353515625

New cuda time: 2.440490961074829
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5027310848236084
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1642.146240234375, gpu time: 311.1985330581665
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.958984375
Expert1 unused count: 139
Expert2 unused count: 272
Expert1 balance top: 70.80078125
Expert2 balance top: 90.380859375

New cuda time: 2.459691047668457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4739320278167725
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1832.065185546875, gpu time: 319.07473826408386
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.587890625
Expert2 overflow: 4.78515625
Expert1 unused count: 158
Expert2 unused count: 301
Expert1 balance top: 73.53515625
Expert2 balance top: 92.431640625

New cuda time: 2.454411029815674
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4916911125183105
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1818.6640625, gpu time: 311.1682929992676
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.814453125
Expert1 unused count: 168
Expert2 unused count: 280
Expert1 balance top: 76.07421875
Expert2 balance top: 90.576171875

New cuda time: 2.4345710277557373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4793710708618164
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1847.80908203125, gpu time: 313.5068688392639
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 6.15234375
Expert1 unused count: 193
Expert2 unused count: 279
Expert1 balance top: 78.857421875
Expert2 balance top: 88.720703125

New cuda time: 2.4561710357666016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.442250967025757
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1831.148681640625, gpu time: 320.64129734039307
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.033203125
Expert1 unused count: 218
Expert2 unused count: 239
Expert1 balance top: 80.517578125
Expert2 balance top: 85.498046875

New cuda time: 2.420811891555786
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476331949234009
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1856.405029296875, gpu time: 315.10207438468933
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 6.982421875
Expert1 unused count: 246
Expert2 unused count: 248
Expert1 balance top: 86.083984375
Expert2 balance top: 85.595703125

New cuda time: 2.433612108230591
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.535531997680664
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1667.144287109375, gpu time: 316.16767716407776
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.369140625
Expert1 unused count: 165
Expert2 unused count: 269
Expert1 balance top: 70.654296875
Expert2 balance top: 90.13671875

New cuda time: 2.435370922088623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782509803771973
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1859.702880859375, gpu time: 323.9883601665497
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 6.201171875
Expert1 unused count: 169
Expert2 unused count: 295
Expert1 balance top: 74.70703125
Expert2 balance top: 91.30859375

New cuda time: 2.4516921043395996
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486572027206421
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1846.443359375, gpu time: 316.1065571308136
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 7.177734375
Expert1 unused count: 192
Expert2 unused count: 282
Expert1 balance top: 76.513671875
Expert2 balance top: 90.576171875

New cuda time: 2.437130928039551
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.627052068710327
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1885.045166015625, gpu time: 318.5710527896881
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.759765625
Expert2 overflow: 6.396484375
Expert1 unused count: 220
Expert2 unused count: 279
Expert1 balance top: 80.126953125
Expert2 balance top: 89.94140625

New cuda time: 2.585771083831787
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466092109680176
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1868.247802734375, gpu time: 325.69316053390503
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 12.646484375
Expert1 unused count: 245
Expert2 unused count: 270
Expert1 balance top: 85.15625
Expert2 balance top: 87.6953125

New cuda time: 2.44753098487854
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4553709030151367
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1884.188720703125, gpu time: 320.004976272583
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.591796875
Expert2 overflow: 8.203125
Expert1 unused count: 265
Expert2 unused count: 264
Expert1 balance top: 88.720703125
Expert2 balance top: 86.81640625

New cuda time: 2.4336109161376953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4907310009002686
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1692.93310546875, gpu time: 321.0920202732086
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.95703125
Expert1 unused count: 184
Expert2 unused count: 279
Expert1 balance top: 73.046875
Expert2 balance top: 90.869140625

New cuda time: 2.437290906906128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4998509883880615
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1887.315673828125, gpu time: 328.9255020618439
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.833984375
Expert1 unused count: 209
Expert2 unused count: 308
Expert1 balance top: 78.564453125
Expert2 balance top: 91.6015625

New cuda time: 2.4329710006713867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4736111164093018
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1874.244384765625, gpu time: 321.0131392478943
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 10.595703125
Expert1 unused count: 222
Expert2 unused count: 313
Expert1 balance top: 81.689453125
Expert2 balance top: 92.822265625

New cuda time: 2.4380910396575928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5180909633636475
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1912.68798828125, gpu time: 323.52723479270935
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 10.205078125
Expert1 unused count: 240
Expert2 unused count: 287
Expert1 balance top: 82.91015625
Expert2 balance top: 90.966796875

New cuda time: 2.4427309036254883
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482250928878784
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1896.01123046875, gpu time: 330.6181423664093
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.83984375
Expert1 unused count: 268
Expert2 unused count: 298
Expert1 balance top: 88.28125
Expert2 balance top: 91.748046875

New cuda time: 2.4267311096191406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463531017303467
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1911.775390625, gpu time: 324.8952383995056
2024-07-11 01:35:34 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.37109375
Expert2 overflow: 9.765625
Expert1 unused count: 289
Expert2 unused count: 290
Expert1 balance top: 91.11328125
Expert2 balance top: 89.306640625

New cuda time: 2.431370973587036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4878509044647217
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1718.074462890625, gpu time: 326.0112421512604
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 6.103515625
Expert1 unused count: 205
Expert2 unused count: 318
Expert1 balance top: 79.1015625
Expert2 balance top: 93.994140625

New cuda time: 2.4377710819244385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4752120971679688
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1915.095947265625, gpu time: 333.8384861946106
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.685546875
Expert2 overflow: 4.833984375
Expert1 unused count: 213
Expert2 unused count: 318
Expert1 balance top: 81.640625
Expert2 balance top: 93.45703125

New cuda time: 11.815895080566406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4713709354400635
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1911.39794921875, gpu time: 335.30040526390076
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.58984375
Expert1 unused count: 232
Expert2 unused count: 318
Expert1 balance top: 80.76171875
Expert2 balance top: 92.87109375

New cuda time: 2.4176108837127686
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6630520820617676
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1950.1630859375, gpu time: 328.6078977584839
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.296875
Expert2 overflow: 11.181640625
Expert1 unused count: 243
Expert2 unused count: 294
Expert1 balance top: 83.642578125
Expert2 balance top: 90.4296875

New cuda time: 2.449450969696045
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4588921070098877
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1923.835693359375, gpu time: 335.52648544311523
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 9.5703125
Expert1 unused count: 264
Expert2 unused count: 288
Expert1 balance top: 86.474609375
Expert2 balance top: 90.380859375

New cuda time: 2.4665720462799072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4488120079040527
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1939.62158203125, gpu time: 329.8106224536896
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.46484375
Expert2 overflow: 10.791015625
Expert1 unused count: 293
Expert2 unused count: 307
Expert1 balance top: 89.697265625
Expert2 balance top: 91.40625

New cuda time: 2.4662508964538574
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672110080718994
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1743.48095703125, gpu time: 330.94470405578613
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.71484375
Expert1 unused count: 72
Expert2 unused count: 255
Expert1 balance top: 60.44921875
Expert2 balance top: 88.818359375

New cuda time: 2.436171054840088
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854509830474854
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1942.869873046875, gpu time: 338.76010823249817
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.107421875
Expert1 unused count: 81
Expert2 unused count: 263
Expert1 balance top: 63.037109375
Expert2 balance top: 90.0390625

New cuda time: 2.4348909854888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46641206741333
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1939.31298828125, gpu time: 340.201708316803
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.818359375
Expert1 unused count: 90
Expert2 unused count: 242
Expert1 balance top: 62.939453125
Expert2 balance top: 87.744140625

New cuda time: 2.439210891723633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485930919647217
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1977.985595703125, gpu time: 333.53303956985474
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.224609375
Expert1 unused count: 98
Expert2 unused count: 213
Expert1 balance top: 62.060546875
Expert2 balance top: 84.86328125

New cuda time: 2.450731039047241
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4937710762023926
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1951.43896484375, gpu time: 340.47098755836487
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.66015625
Expert2 overflow: 6.689453125
Expert1 unused count: 128
Expert2 unused count: 183
Expert1 balance top: 65.72265625
Expert2 balance top: 80.126953125

New cuda time: 2.45137095451355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6304121017456055
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1974.234375, gpu time: 334.89240550994873
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 2.490234375
Expert1 unused count: 148
Expert2 unused count: 161
Expert1 balance top: 68.603515625
Expert2 balance top: 74.462890625

New cuda time: 2.463371992111206
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.63617205619812
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1778.551513671875, gpu time: 336.04424810409546
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.759765625
Expert2 overflow: 15.625
Expert1 unused count: 278
Expert2 unused count: 339
Expert1 balance top: 90.13671875
Expert2 balance top: 95.21484375

New cuda time: 2.4321720600128174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4982519149780273
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1970.49267578125, gpu time: 343.690532207489
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.666015625
Expert1 unused count: 297
Expert2 unused count: 338
Expert1 balance top: 91.015625
Expert2 balance top: 95.654296875

New cuda time: 2.451051950454712
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.59633207321167
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1976.572265625, gpu time: 345.24909138679504
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 11.328125
Expert1 unused count: 303
Expert2 unused count: 346
Expert1 balance top: 91.845703125
Expert2 balance top: 95.751953125

New cuda time: 2.4457709789276123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457292079925537
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2006.1875, gpu time: 338.4361026287079
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.39453125
Expert2 overflow: 23.583984375
Expert1 unused count: 332
Expert2 unused count: 336
Expert1 balance top: 94.775390625
Expert2 balance top: 95.556640625

New cuda time: 2.4468910694122314
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493932008743286
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1979.179931640625, gpu time: 345.4118106365204
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.271484375
Expert2 overflow: 22.314453125
Expert1 unused count: 342
Expert2 unused count: 358
Expert1 balance top: 95.166015625
Expert2 balance top: 96.728515625

New cuda time: 2.437290906906128
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5331320762634277
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2002.129150390625, gpu time: 339.8628284931183
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.392578125
Expert2 overflow: 21.77734375
Expert1 unused count: 350
Expert2 unused count: 352
Expert1 balance top: 95.8984375
Expert2 balance top: 96.09375

New cuda time: 2.4256110191345215
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4724910259246826
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1803.989501953125, gpu time: 340.94235014915466
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.865234375
Expert1 unused count: 115
Expert2 unused count: 264
Expert1 balance top: 66.2109375
Expert2 balance top: 90.283203125

New cuda time: 2.4313719272613525
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465291976928711
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1998.218017578125, gpu time: 348.5871961116791
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 5.95703125
Expert1 unused count: 107
Expert2 unused count: 278
Expert1 balance top: 69.287109375
Expert2 balance top: 91.50390625

New cuda time: 2.4446520805358887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462251901626587
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2004.31494140625, gpu time: 350.1559941768646
2024-07-11 01:35:35 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.251953125
Expert1 unused count: 121
Expert2 unused count: 262
Expert1 balance top: 68.359375
Expert2 balance top: 90.13671875

New cuda time: 2.4174509048461914
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474571943283081
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2034.4052734375, gpu time: 343.32812547683716
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.474609375
Expert1 unused count: 137
Expert2 unused count: 244
Expert1 balance top: 70.5078125
Expert2 balance top: 87.98828125

New cuda time: 2.4785709381103516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5107319355010986
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2007.01025390625, gpu time: 350.40111446380615
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.01171875
Expert1 unused count: 140
Expert2 unused count: 221
Expert1 balance top: 70.3125
Expert2 balance top: 85.498046875

New cuda time: 2.4256110191345215
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.657291889190674
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2034.077392578125, gpu time: 344.9457314014435
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.5625
Expert1 unused count: 163
Expert2 unused count: 208
Expert1 balance top: 73.6328125
Expert2 balance top: 80.517578125

New cuda time: 2.493130922317505
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.449291944503784
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1828.3857421875, gpu time: 345.88477301597595
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.712890625
Expert1 unused count: 124
Expert2 unused count: 244
Expert1 balance top: 64.84375
Expert2 balance top: 87.744140625

New cuda time: 2.432651996612549
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.630251884460449
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2035.107666015625, gpu time: 353.65009903907776
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 7.6171875
Expert1 unused count: 133
Expert2 unused count: 280
Expert1 balance top: 69.384765625
Expert2 balance top: 91.552734375

New cuda time: 2.440171003341675
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481611967086792
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2031.791015625, gpu time: 355.0777771472931
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.033203125
Expert1 unused count: 137
Expert2 unused count: 268
Expert1 balance top: 68.994140625
Expert2 balance top: 89.599609375

New cuda time: 2.469451904296875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4409708976745605
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2061.6748046875, gpu time: 348.2385482788086
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.421875
Expert1 unused count: 141
Expert2 unused count: 238
Expert1 balance top: 69.43359375
Expert2 balance top: 86.1328125

New cuda time: 2.440171003341675
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444812059402466
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2033.862060546875, gpu time: 355.2860975265503
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.66796875
Expert1 unused count: 191
Expert2 unused count: 190
Expert1 balance top: 74.658203125
Expert2 balance top: 80.224609375

New cuda time: 2.4467320442199707
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4776110649108887
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2061.33349609375, gpu time: 349.87007451057434
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.201171875
Expert1 unused count: 179
Expert2 unused count: 208
Expert1 balance top: 75.341796875
Expert2 balance top: 80.029296875

New cuda time: 2.4347310066223145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4966518878936768
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1853.455322265625, gpu time: 350.81615591049194
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 10.3515625
Expert1 unused count: 129
Expert2 unused count: 274
Expert1 balance top: 72.607421875
Expert2 balance top: 90.91796875

New cuda time: 2.4539310932159424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481611967086792
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2062.689453125, gpu time: 358.5856420993805
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.294921875
Expert2 overflow: 5.419921875
Expert1 unused count: 148
Expert2 unused count: 305
Expert1 balance top: 73.876953125
Expert2 balance top: 93.65234375

New cuda time: 2.422571897506714
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502732038497925
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2059.22119140625, gpu time: 360.00308108329773
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.84375
Expert1 unused count: 152
Expert2 unused count: 275
Expert1 balance top: 73.92578125
Expert2 balance top: 90.966796875

New cuda time: 2.449770927429199
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462570905685425
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2089.23193359375, gpu time: 353.1508901119232
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.009765625
Expert1 unused count: 159
Expert2 unused count: 262
Expert1 balance top: 74.267578125
Expert2 balance top: 88.76953125

New cuda time: 2.6028919219970703
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493130922317505
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2070.1796875, gpu time: 360.38212037086487
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.390625
Expert2 overflow: 12.841796875
Expert1 unused count: 187
Expert2 unused count: 238
Expert1 balance top: 77.24609375
Expert2 balance top: 86.865234375

New cuda time: 2.4275310039520264
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.505932092666626
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2088.634033203125, gpu time: 354.803537607193
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.634765625
Expert1 unused count: 195
Expert2 unused count: 213
Expert1 balance top: 79.248046875
Expert2 balance top: 83.3984375

New cuda time: 2.427051067352295
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463212013244629
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1878.167236328125, gpu time: 355.70641899108887
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.02734375
Expert2 overflow: 10.205078125
Expert1 unused count: 163
Expert2 unused count: 264
Expert1 balance top: 72.265625
Expert2 balance top: 88.4765625

New cuda time: 2.608812093734741
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4604909420013428
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2099.797119140625, gpu time: 363.6549451351166
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.078125
Expert2 overflow: 14.74609375
Expert1 unused count: 173
Expert2 unused count: 276
Expert1 balance top: 77.34375
Expert2 balance top: 90.91796875

New cuda time: 2.420011043548584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452332019805908
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2086.5107421875, gpu time: 364.8754241466522
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 16.796875
Expert1 unused count: 181
Expert2 unused count: 281
Expert1 balance top: 76.904296875
Expert2 balance top: 90.625

New cuda time: 2.443052053451538
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472970962524414
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2116.621826171875, gpu time: 358.06691217422485
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.76171875
Expert2 overflow: 12.01171875
Expert1 unused count: 205
Expert2 unused count: 270
Expert1 balance top: 79.296875
Expert2 balance top: 89.0625

New cuda time: 2.4355309009552
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4668920040130615
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2097.644775390625, gpu time: 365.28454327583313
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 21.044921875
Expert1 unused count: 224
Expert2 unused count: 262
Expert1 balance top: 81.640625
Expert2 balance top: 87.548828125

New cuda time: 2.46641206741333
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461930990219116
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2115.9423828125, gpu time: 359.7318797111511
2024-07-11 01:35:36 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.490234375
Expert2 overflow: 7.568359375
Expert1 unused count: 246
Expert2 unused count: 254
Expert1 balance top: 83.88671875
Expert2 balance top: 86.23046875

New cuda time: 2.4518520832061768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.497131109237671
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1903.15625, gpu time: 360.6554021835327
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.005859375
Expert1 unused count: 128
Expert2 unused count: 271
Expert1 balance top: 68.798828125
Expert2 balance top: 89.35546875

New cuda time: 2.441291093826294
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468010902404785
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2127.2822265625, gpu time: 368.56424713134766
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.685546875
Expert2 overflow: 4.98046875
Expert1 unused count: 149
Expert2 unused count: 294
Expert1 balance top: 70.3125
Expert2 balance top: 92.67578125

New cuda time: 2.450571060180664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6009719371795654
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2122.140380859375, gpu time: 369.92696714401245
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 16.2109375
Expert1 unused count: 146
Expert2 unused count: 277
Expert1 balance top: 71.240234375
Expert2 balance top: 90.8203125

New cuda time: 2.458890914916992
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479372024536133
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2143.25537109375, gpu time: 363.005175113678
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.322265625
Expert1 unused count: 161
Expert2 unused count: 254
Expert1 balance top: 72.607421875
Expert2 balance top: 87.353515625

New cuda time: 2.4561710357666016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4660909175872803
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2124.750732421875, gpu time: 370.206805229187
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.3984375
Expert1 unused count: 178
Expert2 unused count: 237
Expert1 balance top: 74.267578125
Expert2 balance top: 85.546875

New cuda time: 2.4376111030578613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47953200340271
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2143.017333984375, gpu time: 364.6490228176117
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.26953125
Expert1 unused count: 207
Expert2 unused count: 234
Expert1 balance top: 79.19921875
Expert2 balance top: 82.421875

New cuda time: 2.449280023574829
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464479923248291
New cuda time: 2.43887996673584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587209224700928
New cuda time: 2.439199924468994
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493920087814331
New cuda time: 2.4689600467681885
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472320079803467
New cuda time: 2.432800054550171
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480959892272949
New cuda time: 2.4387199878692627
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.638079881668091
New cuda time: 2.439039945602417
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587199687957764
New cuda time: 2.4647998809814453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4628798961639404
New cuda time: 2.461440086364746
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463360071182251
New cuda time: 2.472640037536621
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4833600521087646
New cuda time: 2.452159881591797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4519999027252197
New cuda time: 2.416800022125244
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569599628448486
New cuda time: 2.444159984588623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473759889602661
New cuda time: 2.4363200664520264
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710400104522705
New cuda time: 2.4505600929260254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470560073852539
New cuda time: 2.4609599113464355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464479923248291
New cuda time: 2.4374399185180664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.636159896850586
New cuda time: 2.5867199897766113
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444960117340088
New cuda time: 2.4488000869750977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487839937210083
New cuda time: 2.4550399780273438
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473759889602661
New cuda time: 2.422879934310913
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4515199661254883
New cuda time: 2.432800054550171
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566400051116943
New cuda time: 2.4822399616241455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4438400268554688
New cuda time: 2.4656009674072266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4790399074554443
New cuda time: 2.4384000301361084
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455519914627075
New cuda time: 2.4609599113464355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4932799339294434
New cuda time: 2.42832088470459
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566400051116943
New cuda time: 11.8043212890625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460479974746704
New cuda time: 2.483680009841919
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6273601055145264
New cuda time: 2.480959892272949
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.496959924697876
New cuda time: 2.4641599655151367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457120895385742
New cuda time: 2.4476799964904785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4681599140167236
New cuda time: 2.4348809719085693
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4681599140167236
New cuda time: 2.473439931869507
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870409965515137
New cuda time: 2.446239948272705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4619200229644775
New cuda time: 2.4128000736236572
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487200975418091
New cuda time: 2.486560106277466
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6499199867248535
New cuda time: 2.4504001140594482
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6550400257110596
New cuda time: 2.420639991760254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479201078414917
New cuda time: 2.4649600982666016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.625119924545288
New cuda time: 2.4302399158477783
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4678409099578857
New cuda time: 2.4507200717926025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4630401134490967
New cuda time: 2.4620800018310547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854400157928467
New cuda time: 2.4494400024414062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4484810829162598
New cuda time: 2.4508800506591797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4507200717926025
New cuda time: 2.450079917907715
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468480110168457
New cuda time: 2.4647998809814453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689600467681885
New cuda time: 2.4291200637817383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469759941101074
New cuda time: 2.427999973297119
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.644160032272339
New cuda time: 2.4649600982666016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.456960916519165
New cuda time: 2.4478399753570557
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.625920057296753
New cuda time: 2.467519998550415
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4638400077819824
New cuda time: 2.4545600414276123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4604809284210205
New cuda time: 2.4364800453186035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477760076522827
New cuda time: 2.4780800342559814
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4692800045013428
New cuda time: 2.4344000816345215
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473439931869507
New cuda time: 2.4407999515533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4547200202941895
New cuda time: 2.4447999000549316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.440959930419922
New cuda time: 2.4800009727478027
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4750399589538574
New cuda time: 2.600321054458618
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46943998336792
New cuda time: 2.4518399238586426
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4344000816345215
New cuda time: 2.442239999771118
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4913599491119385
New cuda time: 2.5876810550689697
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4467198848724365
New cuda time: 2.4385600090026855
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4793601036071777
New cuda time: 2.416640043258667
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782400131225586
New cuda time: 2.4595210552215576
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451040029525757
New cuda time: 2.4435200691223145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457279920578003
New cuda time: 2.437601089477539
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458400011062622
New cuda time: 2.4692800045013428
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4620800018310547
New cuda time: 2.4468801021575928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6335999965667725
New cuda time: 2.4464008808135986
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4636809825897217
New cuda time: 2.477440118789673
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587199687957764
New cuda time: 2.4603209495544434
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600000381469727
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4892890453338623
New cuda time: 2.4409689903259277
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4353690147399902
New cuda time: 2.4388890266418457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4985690116882324
New cuda time: 2.4600090980529785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598491191864014
New cuda time: 2.440329074859619
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4747300148010254
New cuda time: 2.4217689037323
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6392099857330322
New cuda time: 2.4592089653015137
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689691066741943
New cuda time: 2.471848964691162
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4780900478363037
New cuda time: 2.4627299308776855
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4470489025115967
New cuda time: 2.433928966522217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4796900749206543
New cuda time: 2.436328887939453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710490703582764
New cuda time: 2.4668900966644287
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4548890590667725
New cuda time: 2.442089080810547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468648910522461
New cuda time: 2.4744091033935547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470089912414551
New cuda time: 2.4488089084625244
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461289882659912
New cuda time: 2.437288999557495
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854490756988525
New cuda time: 2.440009117126465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6120100021362305
New cuda time: 2.551529884338379
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467210054397583
New cuda time: 2.4153690338134766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4872100353240967
New cuda time: 2.4611289501190186
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464808940887451
New cuda time: 2.443850040435791
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473928928375244
New cuda time: 2.4321699142456055
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4539289474487305
New cuda time: 2.4228899478912354
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4630489349365234
New cuda time: 2.440809965133667
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4872100353240967
New cuda time: 2.425128936767578
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466888904571533
New cuda time: 2.4643290042877197
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4942500591278076
New cuda time: 2.439049005508423
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4884889125823975
New cuda time: 11.785004615783691
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4777700901031494
New cuda time: 2.4497690200805664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.625610113143921
New cuda time: 2.4488089084625244
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4987289905548096
New cuda time: 2.476649045944214
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466568946838379
New cuda time: 2.4704089164733887
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4769699573516846
New cuda time: 2.424009084701538
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465449094772339
New cuda time: 2.4468889236450195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4537699222564697
New cuda time: 2.4377689361572266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4704089164733887
New cuda time: 2.4436891078948975
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476969003677368
New cuda time: 2.4468889236450195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.627690076828003
New cuda time: 2.3979289531707764
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6881699562072754
New cuda time: 2.4387290477752686
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4747300148010254
New cuda time: 2.449129104614258
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6158499717712402
New cuda time: 2.464488983154297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467529058456421
New cuda time: 2.4302499294281006
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4417688846588135
New cuda time: 2.4344089031219482
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.428809881210327
New cuda time: 2.4606499671936035
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45920991897583
New cuda time: 2.435049057006836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4516890048980713
New cuda time: 2.4468889236450195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4681689739227295
New cuda time: 2.4345688819885254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457608938217163
New cuda time: 2.4630489349365234
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4910500049591064
New cuda time: 2.4292891025543213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.627690076828003
New cuda time: 2.471688985824585
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4387290477752686
New cuda time: 2.4275290966033936
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6443300247192383
New cuda time: 2.4302499294281006
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627299308776855
New cuda time: 2.4531290531158447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4657700061798096
New cuda time: 2.433928966522217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468648910522461
New cuda time: 2.416969060897827
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4392099380493164
New cuda time: 2.446249008178711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4459290504455566
New cuda time: 2.451849937438965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476490020751953
New cuda time: 2.452488899230957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710490703582764
New cuda time: 2.441288948059082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476649045944214
New cuda time: 2.6387290954589844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466568946838379
New cuda time: 2.4457690715789795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469449043273926
New cuda time: 2.4457690715789795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4934499263763428
New cuda time: 2.5844900608062744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5064098834991455
New cuda time: 2.444329023361206
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4851291179656982
New cuda time: 2.436328887939453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4465689659118652
New cuda time: 2.450408935546875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446089029312134
New cuda time: 2.4542500972747803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472490072250366
New cuda time: 2.480648994445801
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4652891159057617
New cuda time: 2.4379289150238037
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458409070968628
New cuda time: 2.4630489349365234
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.640170097351074
New cuda time: 2.4692890644073486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4628889560699463
New cuda time: 2.4368090629577637
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.441930055618286
New cuda time: 2.4540889263153076
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4544100761413574
New cuda time: 13.052369117736816
torch.float32
New cuda time: 2.516469955444336
New cuda time: 2.4831900596618652
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4796700477600098
New cuda time: 2.4489500522613525
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4903910160064697
New cuda time: 2.4236700534820557
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.454710006713867
New cuda time: 2.4558310508728027
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4631900787353516
New cuda time: 2.4452710151672363
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.597909927368164
New cuda time: 2.4401509761810303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502389907836914
New cuda time: 2.47727108001709
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.49822998046875
New cuda time: 2.401110887527466
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.491349935531616
New cuda time: 2.4283111095428467
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4715099334716797
New cuda time: 2.4436709880828857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4833500385284424
New cuda time: 2.444469928741455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482069969177246
New cuda time: 2.4486310482025146
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5097498893737793
New cuda time: 2.447190046310425
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.555190086364746
New cuda time: 2.454071044921875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4561500549316406
New cuda time: 2.426711082458496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.499350070953369
New cuda time: 2.4302310943603516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.612950086593628
New cuda time: 2.6747100353240967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4676709175109863
New cuda time: 2.4302310943603516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475029945373535
New cuda time: 2.442070960998535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488471031188965
New cuda time: 2.4644711017608643
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.442389965057373
New cuda time: 2.443830966949463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4766299724578857
New cuda time: 2.433911085128784
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5207901000976562
New cuda time: 2.4395110607147217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48895001411438
New cuda time: 2.4291110038757324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475511074066162
New cuda time: 2.4278299808502197
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487030029296875
New cuda time: 2.450071096420288
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463670015335083
New cuda time: 11.782034873962402
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4644699096679688
New cuda time: 2.432790994644165
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.652630090713501
New cuda time: 2.448951005935669
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4862310886383057
New cuda time: 2.40031099319458
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5316710472106934
New cuda time: 2.460469961166382
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4553511142730713
New cuda time: 2.4379100799560547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493910074234009
New cuda time: 2.4758310317993164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732699394226074
New cuda time: 2.4193499088287354
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4755098819732666
New cuda time: 2.4363110065460205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4719901084899902
New cuda time: 2.4639899730682373
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.635509967803955
New cuda time: 2.4457499980926514
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6049489974975586
New cuda time: 2.4513509273529053
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4783899784088135
New cuda time: 2.455030918121338
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6094300746917725
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4932711124420166
New cuda time: 2.4324700832366943
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4631900787353516
New cuda time: 2.4406309127807617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.522710084915161
New cuda time: 2.439990997314453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4876708984375
New cuda time: 2.412631034851074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732699394226074
New cuda time: 2.4431910514831543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488631010055542
New cuda time: 2.486069917678833
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4500699043273926
New cuda time: 2.423671007156372
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4934310913085938
New cuda time: 2.4447898864746094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.620310068130493
New cuda time: 2.420470952987671
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.495671033859253
New cuda time: 2.443830966949463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.622390031814575
New cuda time: 2.454710006713867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4671900272369385
New cuda time: 2.4383909702301025
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482551097869873
New cuda time: 2.418550968170166
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451669931411743
New cuda time: 2.4526309967041016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478550910949707
New cuda time: 2.458709955215454
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4711899757385254
New cuda time: 2.4206299781799316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4964709281921387
New cuda time: 2.422390937805176
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5059099197387695
New cuda time: 2.433911085128784
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883110523223877
New cuda time: 2.596950054168701
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4756710529327393
New cuda time: 2.4254310131073
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.513430118560791
New cuda time: 2.4407899379730225
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5055909156799316
New cuda time: 2.625430107116699
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4691100120544434
New cuda time: 2.414551019668579
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476470947265625
New cuda time: 2.4324700832366943
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462230920791626
New cuda time: 2.4220709800720215
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870309829711914
New cuda time: 2.427510976791382
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455030918121338
New cuda time: 2.4446299076080322
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.440951108932495
New cuda time: 2.456789970397949
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598309993743896
New cuda time: 2.4111900329589844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.58174991607666
New cuda time: 2.4555110931396484
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470710039138794
New cuda time: 2.4479899406433105
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468471050262451
New cuda time: 2.4356698989868164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.491029977798462
New cuda time: 12.924110412597656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 12.9408597946167
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4830520153045654
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1938.41943359375, gpu time: 376.079313993454
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.642578125
Expert1 unused count: 183
Expert2 unused count: 292
Expert1 balance top: 76.708984375
Expert2 balance top: 92.333984375

New cuda time: 2.4540910720825195
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482891082763672
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2154.341552734375, gpu time: 373.50122928619385
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 2.05078125
Expert1 unused count: 209
Expert2 unused count: 301
Expert1 balance top: 80.224609375
Expert2 balance top: 92.333984375

New cuda time: 2.4521710872650146
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460331916809082
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2149.341796875, gpu time: 374.83947014808655
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 9.423828125
Expert1 unused count: 218
Expert2 unused count: 304
Expert1 balance top: 80.322265625
Expert2 balance top: 92.724609375

New cuda time: 2.4347310066223145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.501771926879883
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2170.981201171875, gpu time: 367.9416790008545
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.173828125
Expert2 overflow: 10.498046875
Expert1 unused count: 231
Expert2 unused count: 279
Expert1 balance top: 83.349609375
Expert2 balance top: 89.794921875

New cuda time: 2.45137095451355
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4971320629119873
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2152.226806640625, gpu time: 375.15530824661255
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.427734375
Expert1 unused count: 255
Expert2 unused count: 278
Expert1 balance top: 86.23046875
Expert2 balance top: 89.74609375

New cuda time: 2.418890953063965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4878509044647217
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2170.423095703125, gpu time: 369.5557646751404
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.8828125
Expert2 overflow: 7.51953125
Expert1 unused count: 270
Expert2 unused count: 275
Expert1 balance top: 89.111328125
Expert2 balance top: 89.16015625

New cuda time: 2.432171106338501
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480652093887329
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1963.653076171875, gpu time: 380.9921371936798
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 13.525390625
Expert1 unused count: 190
Expert2 unused count: 314
Expert1 balance top: 80.517578125
Expert2 balance top: 94.189453125

New cuda time: 2.433290958404541
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6414530277252197
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2187.697265625, gpu time: 378.5759732723236
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.880859375
Expert2 overflow: 3.759765625
Expert1 unused count: 170
Expert2 unused count: 313
Expert1 balance top: 80.2734375
Expert2 balance top: 93.994140625

New cuda time: 2.461930990219116
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649720191955566
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2176.271728515625, gpu time: 379.76637411117554
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.0546875
Expert2 overflow: 5.712890625
Expert1 unused count: 165
Expert2 unused count: 304
Expert1 balance top: 79.541015625
Expert2 balance top: 92.96875

New cuda time: 2.4625720977783203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4712119102478027
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2198.441650390625, gpu time: 372.8754630088806
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.001953125
Expert2 overflow: 8.349609375
Expert1 unused count: 178
Expert2 unused count: 279
Expert1 balance top: 81.25
Expert2 balance top: 90.4296875

New cuda time: 2.4440109729766846
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4760119915008545
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2179.538818359375, gpu time: 380.0753321647644
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.451171875
Expert1 unused count: 187
Expert2 unused count: 268
Expert1 balance top: 80.56640625
Expert2 balance top: 89.16015625

New cuda time: 2.451211929321289
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.633131980895996
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2207.519287109375, gpu time: 374.64010858535767
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 5.419921875
Expert1 unused count: 208
Expert2 unused count: 237
Expert1 balance top: 84.228515625
Expert2 balance top: 87.20703125

New cuda time: 2.410572052001953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4526519775390625
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 1988.823486328125, gpu time: 385.8553612232208
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 7.666015625
Expert1 unused count: 176
Expert2 unused count: 288
Expert1 balance top: 76.513671875
Expert2 balance top: 91.650390625

New cuda time: 2.4281721115112305
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.506891965866089
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2215.33056640625, gpu time: 383.51103615760803
2024-07-11 01:35:37 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.369140625
Expert2 overflow: 3.125
Expert1 unused count: 204
Expert2 unused count: 307
Expert1 balance top: 80.615234375
Expert2 balance top: 93.310546875

New cuda time: 2.4472110271453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.498732089996338
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2203.79833984375, gpu time: 384.71231722831726
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.962890625
Expert1 unused count: 196
Expert2 unused count: 304
Expert1 balance top: 79.98046875
Expert2 balance top: 92.578125

New cuda time: 2.4579310417175293
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.442250967025757
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2226.1787109375, gpu time: 377.7756459712982
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 12.98828125
Expert1 unused count: 214
Expert2 unused count: 279
Expert1 balance top: 80.17578125
Expert2 balance top: 89.84375

New cuda time: 2.4400110244750977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4854519367218018
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2207.1669921875, gpu time: 385.0007951259613
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.455078125
Expert1 unused count: 236
Expert2 unused count: 273
Expert1 balance top: 83.447265625
Expert2 balance top: 89.55078125

New cuda time: 2.4436910152435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4817709922790527
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2235.24658203125, gpu time: 379.56557154655457
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 3.80859375
Expert1 unused count: 264
Expert2 unused count: 257
Expert1 balance top: 86.962890625
Expert2 balance top: 87.109375

New cuda time: 2.644171953201294
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4561710357666016
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2023.354248046875, gpu time: 390.9557042121887
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 13.96484375
Expert1 unused count: 249
Expert2 unused count: 318
Expert1 balance top: 83.544921875
Expert2 balance top: 93.994140625

New cuda time: 2.4083309173583984
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4833719730377197
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2242.80224609375, gpu time: 388.40273904800415
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.05078125
Expert2 overflow: 7.32421875
Expert1 unused count: 258
Expert2 unused count: 334
Expert1 balance top: 86.62109375
Expert2 balance top: 94.970703125

New cuda time: 2.441132068634033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4707319736480713
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2231.539306640625, gpu time: 389.62418127059937
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.9765625
Expert2 overflow: 16.30859375
Expert1 unused count: 269
Expert2 unused count: 328
Expert1 balance top: 87.3046875
Expert2 balance top: 94.677734375

New cuda time: 2.4467320442199707
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4843320846557617
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2253.753662109375, gpu time: 382.70671010017395
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.26953125
Expert2 overflow: 12.060546875
Expert1 unused count: 299
Expert2 unused count: 324
Expert1 balance top: 90.0390625
Expert2 balance top: 94.140625

New cuda time: 2.4553709030151367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 10.862130165100098
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2243.2783203125, gpu time: 398.31829738616943
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.5390625
Expert2 overflow: 8.056640625
Expert1 unused count: 302
Expert2 unused count: 324
Expert1 balance top: 91.259765625
Expert2 balance top: 92.87109375

New cuda time: 2.4406518936157227
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5635321140289307
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2263.3232421875, gpu time: 384.5697555541992
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.02734375
Expert2 overflow: 13.720703125
Expert1 unused count: 335
Expert2 unused count: 328
Expert1 balance top: 93.798828125
Expert2 balance top: 94.53125

New cuda time: 2.436811923980713
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587318897247314
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2049.01904296875, gpu time: 395.85124802589417
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 7.51953125
Expert1 unused count: 148
Expert2 unused count: 281
Expert1 balance top: 70.361328125
Expert2 balance top: 91.259765625

New cuda time: 2.4488120079040527
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4796910285949707
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2270.994384765625, gpu time: 393.33124113082886
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.5625
Expert2 overflow: 2.685546875
Expert1 unused count: 175
Expert2 unused count: 264
Expert1 balance top: 77.83203125
Expert2 balance top: 89.697265625

New cuda time: 2.4534521102905273
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488651990890503
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2259.98583984375, gpu time: 394.5662853717804
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.95703125
Expert1 unused count: 185
Expert2 unused count: 278
Expert1 balance top: 76.953125
Expert2 balance top: 90.52734375

New cuda time: 2.4462521076202393
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47953200340271
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2281.84521484375, gpu time: 387.632493019104
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 7.03125
Expert1 unused count: 202
Expert2 unused count: 266
Expert1 balance top: 80.419921875
Expert2 balance top: 88.0859375

New cuda time: 2.4348909854888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.616811990737915
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2280.141845703125, gpu time: 403.37000036239624
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.083984375
Expert1 unused count: 222
Expert2 unused count: 254
Expert1 balance top: 82.03125
Expert2 balance top: 86.1328125

New cuda time: 2.4603309631347656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472970962524414
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2290.306884765625, gpu time: 389.5030574798584
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.296875
Expert2 overflow: 3.90625
Expert1 unused count: 244
Expert2 unused count: 244
Expert1 balance top: 84.5703125
Expert2 balance top: 84.1796875

New cuda time: 2.4657719135284424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479051113128662
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2073.65380859375, gpu time: 400.79607009887695
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.494140625
Expert1 unused count: 171
Expert2 unused count: 281
Expert1 balance top: 72.900390625
Expert2 balance top: 90.625

New cuda time: 2.4358510971069336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4590508937835693
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2298.218505859375, gpu time: 398.22614312171936
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 1.171875
Expert1 unused count: 186
Expert2 unused count: 297
Expert1 balance top: 76.123046875
Expert2 balance top: 91.11328125

New cuda time: 2.4251320362091064
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.498892068862915
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2287.393310546875, gpu time: 399.4903085231781
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.341796875
Expert2 overflow: 8.984375
Expert1 unused count: 183
Expert2 unused count: 295
Expert1 balance top: 74.90234375
Expert2 balance top: 91.6015625

New cuda time: 2.467371940612793
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4651310443878174
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2309.1884765625, gpu time: 392.5649960041046
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 9.5703125
Expert1 unused count: 217
Expert2 unused count: 292
Expert1 balance top: 80.615234375
Expert2 balance top: 90.91796875

New cuda time: 11.932214736938477
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483851909637451
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2317.091796875, gpu time: 417.78606700897217
2024-07-11 01:35:38 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 12.255859375
Expert1 unused count: 217
Expert2 unused count: 284
Expert1 balance top: 81.396484375
Expert2 balance top: 90.869140625

New cuda time: 2.4350509643554688
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5049710273742676
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2317.892578125, gpu time: 394.44307947158813
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.7109375
Expert2 overflow: 5.078125
Expert1 unused count: 254
Expert2 unused count: 270
Expert1 balance top: 84.423828125
Expert2 balance top: 87.744140625

New cuda time: 2.463850975036621
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782509803771973
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2098.623291015625, gpu time: 405.73817205429077
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.736328125
Expert1 unused count: 205
Expert2 unused count: 285
Expert1 balance top: 78.857421875
Expert2 balance top: 90.234375

New cuda time: 2.4368109703063965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4720120429992676
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2325.71142578125, gpu time: 403.134966135025
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 1.26953125
Expert1 unused count: 221
Expert2 unused count: 313
Expert1 balance top: 78.857421875
Expert2 balance top: 92.3828125

New cuda time: 2.419210910797119
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4851319789886475
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2315.042724609375, gpu time: 404.39465141296387
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.048828125
Expert2 overflow: 9.765625
Expert1 unused count: 240
Expert2 unused count: 309
Expert1 balance top: 84.033203125
Expert2 balance top: 92.7734375

New cuda time: 2.443211078643799
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.597611904144287
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2338.7900390625, gpu time: 397.6058189868927
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.220703125
Expert2 overflow: 16.259765625
Expert1 unused count: 262
Expert2 unused count: 304
Expert1 balance top: 85.400390625
Expert2 balance top: 91.89453125

New cuda time: 2.4804909229278564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.456650972366333
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2343.873779296875, gpu time: 422.72320890426636
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 26.904296875
Expert1 unused count: 274
Expert2 unused count: 303
Expert1 balance top: 88.427734375
Expert2 balance top: 91.89453125

New cuda time: 2.44513201713562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4672110080718994
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2344.85498046875, gpu time: 399.35542249679565
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.638671875
Expert2 overflow: 11.181640625
Expert1 unused count: 290
Expert2 unused count: 306
Expert1 balance top: 90.966796875
Expert2 balance top: 91.064453125

New cuda time: 2.4436910152435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4787309169769287
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2123.40234375, gpu time: 410.66059398651123
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 13.18359375
Expert1 unused count: 186
Expert2 unused count: 292
Expert1 balance top: 74.853515625
Expert2 balance top: 92.578125

New cuda time: 2.458730936050415
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458730936050415
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2352.72900390625, gpu time: 408.05242800712585
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.318359375
Expert2 overflow: 5.126953125
Expert1 unused count: 191
Expert2 unused count: 289
Expert1 balance top: 76.85546875
Expert2 balance top: 91.650390625

New cuda time: 2.4216110706329346
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4670510292053223
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2342.3134765625, gpu time: 409.2833135128021
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.125
Expert1 unused count: 190
Expert2 unused count: 295
Expert1 balance top: 75.244140625
Expert2 balance top: 91.69921875

New cuda time: 2.4433720111846924
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.668652057647705
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2375.49658203125, gpu time: 402.7178430557251
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.00390625
Expert2 overflow: 5.322265625
Expert1 unused count: 200
Expert2 unused count: 272
Expert1 balance top: 76.3671875
Expert2 balance top: 88.134765625

New cuda time: 2.4785709381103516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483851909637451
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2371.55126953125, gpu time: 427.68563175201416
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.791015625
Expert1 unused count: 225
Expert2 unused count: 257
Expert1 balance top: 80.712890625
Expert2 balance top: 87.939453125

New cuda time: 2.4156908988952637
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.514251947402954
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2372.222900390625, gpu time: 404.2853653430939
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 9.130859375
Expert1 unused count: 246
Expert2 unused count: 264
Expert1 balance top: 85.888671875
Expert2 balance top: 88.525390625

New cuda time: 2.42273211479187
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.523371934890747
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2148.90673828125, gpu time: 415.60669803619385
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.2578125
Expert1 unused count: 207
Expert2 unused count: 299
Expert1 balance top: 77.9296875
Expert2 balance top: 92.87109375

New cuda time: 2.4404919147491455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883310794830322
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2380.349853515625, gpu time: 412.98125100135803
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.244140625
Expert2 overflow: 2.490234375
Expert1 unused count: 211
Expert2 unused count: 301
Expert1 balance top: 78.7109375
Expert2 balance top: 92.041015625

New cuda time: 2.6232120990753174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4491310119628906
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2379.738525390625, gpu time: 414.35565757751465
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.833984375
Expert1 unused count: 223
Expert2 unused count: 310
Expert1 balance top: 79.4921875
Expert2 balance top: 91.40625

New cuda time: 2.4315309524536133
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4668920040130615
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2403.075927734375, gpu time: 407.6162660121918
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.978515625
Expert2 overflow: 10.009765625
Expert1 unused count: 236
Expert2 unused count: 303
Expert1 balance top: 83.0078125
Expert2 balance top: 91.357421875

New cuda time: 2.4428908824920654
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4827311038970947
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2399.293212890625, gpu time: 432.6112549304962
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 15.283203125
Expert1 unused count: 254
Expert2 unused count: 293
Expert1 balance top: 84.66796875
Expert2 balance top: 92.3828125

New cuda time: 2.4748919010162354
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461611032485962
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2399.8193359375, gpu time: 409.22186827659607
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 6.54296875
Expert1 unused count: 268
Expert2 unused count: 282
Expert1 balance top: 87.40234375
Expert2 balance top: 88.720703125

New cuda time: 2.4408109188079834
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4744110107421875
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2174.003662109375, gpu time: 420.521919965744
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.32421875
Expert2 overflow: 25.048828125
Expert1 unused count: 398
Expert2 unused count: 401
Expert1 balance top: 99.462890625
Expert2 balance top: 99.609375

New cuda time: 2.4934520721435547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4956910610198975
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2407.19873046875, gpu time: 417.9703941345215
2024-07-11 01:35:39 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.322265625
Expert2 overflow: 16.015625
Expert1 unused count: 398
Expert2 unused count: 398
Expert1 balance top: 99.462890625
Expert2 balance top: 99.462890625

New cuda time: 2.4582509994506836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6251330375671387
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2416.000244140625, gpu time: 419.43904161453247
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.61328125
Expert2 overflow: 16.2109375
Expert1 unused count: 382
Expert2 unused count: 370
Expert1 balance top: 98.681640625
Expert2 balance top: 98.095703125

New cuda time: 2.4254510402679443
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483851909637451
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2430.56103515625, gpu time: 412.52556896209717
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.642578125
Expert2 overflow: 10.05859375
Expert1 unused count: 388
Expert2 unused count: 378
Expert1 balance top: 98.974609375
Expert2 balance top: 98.193359375

New cuda time: 2.444650888442993
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.454252004623413
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2426.640869140625, gpu time: 437.5101578235626
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 9.521484375
Expert2 overflow: 28.3203125
Expert1 unused count: 406
Expert2 unused count: 389
Expert1 balance top: 99.853515625
Expert2 balance top: 99.0234375

New cuda time: 2.444490909576416
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493612051010132
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2427.031005859375, gpu time: 414.1599712371826
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 10.7421875
Expert2 overflow: 21.337890625
Expert1 unused count: 407
Expert2 unused count: 398
Expert1 balance top: 99.90234375
Expert2 balance top: 99.462890625

New cuda time: 2.4011309146881104
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.635051965713501
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2208.945556640625, gpu time: 425.55810284614563
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.91015625
Expert1 unused count: 87
Expert2 unused count: 241
Expert1 balance top: 59.08203125
Expert2 balance top: 87.451171875

New cuda time: 2.4382519721984863
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4723310470581055
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2434.816650390625, gpu time: 422.88097620010376
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.8359375
Expert1 unused count: 100
Expert2 unused count: 280
Expert1 balance top: 62.59765625
Expert2 balance top: 91.40625

New cuda time: 2.4368109703063965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600119590759277
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2443.50732421875, gpu time: 424.3358645439148
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.693359375
Expert1 unused count: 123
Expert2 unused count: 248
Expert1 balance top: 63.818359375
Expert2 balance top: 87.40234375

New cuda time: 2.457451105117798
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4520111083984375
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2458.100341796875, gpu time: 417.4350311756134
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.396484375
Expert1 unused count: 118
Expert2 unused count: 231
Expert1 balance top: 64.74609375
Expert2 balance top: 85.302734375

New cuda time: 2.433450937271118
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465610980987549
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2454.281005859375, gpu time: 442.4092197418213
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.375
Expert1 unused count: 137
Expert2 unused count: 218
Expert1 balance top: 68.26171875
Expert2 balance top: 82.177734375

New cuda time: 2.4385719299316406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482572078704834
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2454.6123046875, gpu time: 419.0811142921448
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 2.880859375
Expert1 unused count: 174
Expert2 unused count: 174
Expert1 balance top: 74.609375
Expert2 balance top: 74.267578125

New cuda time: 2.4403319358825684
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.515212059020996
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2234.22705078125, gpu time: 430.5136468410492
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.130859375
Expert1 unused count: 79
Expert2 unused count: 261
Expert1 balance top: 62.20703125
Expert2 balance top: 88.916015625

New cuda time: 2.431691884994507
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782509803771973
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2462.33349609375, gpu time: 427.79091906547546
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.958984375
Expert1 unused count: 89
Expert2 unused count: 275
Expert1 balance top: 62.939453125
Expert2 balance top: 91.259765625

New cuda time: 2.6040120124816895
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4897708892822266
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2480.94677734375, gpu time: 429.4296474456787
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.57421875
Expert1 unused count: 91
Expert2 unused count: 261
Expert1 balance top: 63.28125
Expert2 balance top: 89.501953125

New cuda time: 2.4232120513916016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5156919956207275
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2485.861572265625, gpu time: 422.37393522262573
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.73828125
Expert1 unused count: 101
Expert2 unused count: 227
Expert1 balance top: 65.625
Expert2 balance top: 86.1328125

New cuda time: 2.4340920448303223
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478732109069824
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2482.054931640625, gpu time: 447.3220429420471
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.787109375
Expert1 unused count: 102
Expert2 unused count: 208
Expert1 balance top: 65.380859375
Expert2 balance top: 82.177734375

New cuda time: 2.442250967025757
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6264119148254395
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2486.871826171875, gpu time: 424.149777173996
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 0.87890625
Expert1 unused count: 130
Expert2 unused count: 166
Expert1 balance top: 67.67578125
Expert2 balance top: 74.072265625

New cuda time: 2.4609720706939697
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4764909744262695
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2259.912109375, gpu time: 435.45110988616943
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 7.6171875
Expert1 unused count: 210
Expert2 unused count: 302
Expert1 balance top: 79.8828125
Expert2 balance top: 93.310546875

New cuda time: 12.937281608581543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472320079803467
New cuda time: 2.456001043319702
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4483211040496826
New cuda time: 2.4600000381469727
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459199905395508
New cuda time: 2.445600986480713
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466080904006958
New cuda time: 2.463360071182251
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4881598949432373
New cuda time: 2.4561610221862793
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4545609951019287
New cuda time: 2.4243199825286865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.496799945831299
New cuda time: 2.487200975418091
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.670880079269409
New cuda time: 2.4537599086761475
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4588799476623535
New cuda time: 2.481760025024414
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4721601009368896
New cuda time: 2.4721601009368896
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462399959564209
New cuda time: 2.4667210578918457
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6134400367736816
New cuda time: 2.4294400215148926
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4535999298095703
New cuda time: 2.4476799964904785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45632004737854
New cuda time: 2.4707210063934326
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461440086364746
New cuda time: 2.460800886154175
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462559938430786
New cuda time: 2.4473609924316406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466559886932373
New cuda time: 2.43264102935791
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4811201095581055
New cuda time: 2.6171200275421143
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468480110168457
New cuda time: 2.4355199337005615
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4612810611724854
New cuda time: 2.427680015563965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485919952392578
New cuda time: 2.4532809257507324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451200008392334
New cuda time: 2.435360908508301
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 10.809440612792969
New cuda time: 2.430079936981201
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4800000190734863
New cuda time: 2.483839988708496
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4518399238586426
New cuda time: 2.4497599601745605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4849600791931152
New cuda time: 2.4212799072265625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4790399074554443
New cuda time: 2.413439989089966
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4607999324798584
New cuda time: 2.4704010486602783
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.638079881668091
New cuda time: 2.4200000762939453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4688010215759277
New cuda time: 2.431520938873291
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4579200744628906
New cuda time: 2.4678409099578857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4803199768066406
New cuda time: 2.4467198848724365
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4800000190734863
New cuda time: 2.4739201068878174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4667201042175293
New cuda time: 11.942880630493164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4811201095581055
New cuda time: 2.440800905227661
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4860799312591553
New cuda time: 2.42576003074646
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463041067123413
New cuda time: 2.459520101547241
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4828810691833496
New cuda time: 2.4452810287475586
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476480007171631
New cuda time: 2.442239999771118
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6414411067962646
New cuda time: 2.452320098876953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470400094985962
New cuda time: 2.4251210689544678
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598400592803955
New cuda time: 2.416640043258667
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464000940322876
New cuda time: 2.4617600440979004
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4430410861968994
New cuda time: 2.438560962677002
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46016001701355
New cuda time: 2.4302399158477783
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6142399311065674
New cuda time: 2.4119999408721924
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4630401134490967
New cuda time: 2.464160919189453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458559989929199
New cuda time: 2.435839891433716
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473439931869507
New cuda time: 2.4851200580596924
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4577600955963135
New cuda time: 2.615679979324341
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470720052719116
New cuda time: 2.4406399726867676
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4697608947753906
New cuda time: 2.477281093597412
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4443199634552
New cuda time: 2.4854400157928467
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471040964126587
New cuda time: 2.4438400268554688
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470720052719116
New cuda time: 2.4728000164031982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461440086364746
New cuda time: 2.4760000705718994
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.612639904022217
New cuda time: 2.422719955444336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4456000328063965
New cuda time: 2.453279972076416
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467679977416992
New cuda time: 2.4668800830841064
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458400011062622
New cuda time: 2.4463999271392822
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6395208835601807
New cuda time: 2.44576096534729
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689600467681885
New cuda time: 2.4414401054382324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600000381469727
New cuda time: 2.4667201042175293
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.44815993309021
New cuda time: 2.4468801021575928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481760025024414
New cuda time: 2.466399908065796
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460479974746704
New cuda time: 2.4718399047851562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479520082473755
New cuda time: 2.4524800777435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489759922027588
New cuda time: 2.6044809818267822
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444000005722046
New cuda time: 2.4616000652313232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4539198875427246
New cuda time: 2.4374399185180664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4891200065612793
New cuda time: 2.464479923248291
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6576011180877686
New cuda time: 2.4588799476623535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471679925918579
New cuda time: torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4516890048980713
New cuda time: 2.434889078140259
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4366490840911865
New cuda time: 2.436490058898926
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.447208881378174
New cuda time: 2.4846489429473877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475848913192749
New cuda time: 2.428169012069702
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.488008975982666
New cuda time: 2.4417688846588135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4704089164733887
New cuda time: 2.481290102005005
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502408981323242
New cuda time: 2.4201691150665283
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6240100860595703
New cuda time: 2.445770025253296
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4643290042877197
New cuda time: 2.4617691040039062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46976900100708
New cuda time: 2.4318490028381348
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463689088821411
New cuda time: 2.447208881378174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5835299491882324
New cuda time: 2.4763290882110596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4720089435577393
New cuda time: 2.4337689876556396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4579288959503174
New cuda time: 2.4577689170837402
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4292891025543213
New cuda time: 2.4489688873291016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4660890102386475
New cuda time: 2.4254488945007324
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4766499996185303
New cuda time: 2.426729917526245
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48865008354187
New cuda time: 2.6193699836730957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4956889152526855
New cuda time: 2.4547290802001953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466249942779541
New cuda time: 2.4408090114593506
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476969003677368
New cuda time: 2.432490110397339
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457608938217163
New cuda time: 2.44848895072937
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 10.844841003417969
New cuda time: 2.48048996925354
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475848913192749
New cuda time: 2.4876890182495117
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4492900371551514
New cuda time: 2.4204890727996826
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477289915084839
New cuda time: 2.4651288986206055
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4659299850463867
New cuda time: 2.4195289611816406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4510490894317627
New cuda time: 2.413609027862549
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.673449993133545
New cuda time: 2.4620890617370605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4512100219726562
New cuda time: 2.4243290424346924
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462409019470215
New cuda time: 2.443208932876587
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675300121307373
New cuda time: 2.445128917694092
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4720089435577393
New cuda time: 2.4387290477752686
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4550490379333496
New cuda time: 11.93620491027832
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4640090465545654
New cuda time: 2.434889078140259
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483689069747925
New cuda time: 2.476330041885376
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4428889751434326
New cuda time: 2.4486498832702637
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4486498832702637
New cuda time: 2.4648098945617676
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4568090438842773
New cuda time: 2.4496090412139893
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.624809980392456
New cuda time: 2.4398488998413086
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4529690742492676
New cuda time: 2.492008924484253
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4633688926696777
New cuda time: 2.470410108566284
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47121000289917
New cuda time: 2.4542489051818848
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482729911804199
New cuda time: 2.427849054336548
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4979300498962402
New cuda time: 2.4360098838806152
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6030499935150146
New cuda time: 2.449129104614258
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471848964691162
New cuda time: 2.4518489837646484
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689691066741943
New cuda time: 2.4571290016174316
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470568895339966
New cuda time: 2.433928966522217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4404890537261963
New cuda time: 2.6089699268341064
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486088991165161
New cuda time: 2.4262490272521973
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4702489376068115
New cuda time: 2.4427289962768555
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4500889778137207
New cuda time: 2.4612889289855957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4812889099121094
New cuda time: 2.456489086151123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4531290531158447
New cuda time: 2.4409689903259277
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.443850040435791
New cuda time: 2.458250045776367
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.616489887237549
New cuda time: 2.4755289554595947
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4740889072418213
New cuda time: 2.4292891025543213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4664089679718018
New cuda time: 2.4467289447784424
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4683289527893066
New cuda time: 2.441448926925659
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6592109203338623
New cuda time: 2.4412899017333984
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4598491191864014
New cuda time: 2.413609027862549
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4550490379333496
New cuda time: 2.4326488971710205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480968952178955
New cuda time: 2.4417688846588135
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4731290340423584
New cuda time: 2.445770025253296
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469449996948242
New cuda time: 2.483690023422241
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471848964691162
New cuda time: 2.4420900344848633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4809699058532715
New cuda time: 2.607369899749756
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4763290882110596
New cuda time: 2.4475290775299072
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4548890590667725
New cuda time: 2.440009117126465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471688985824585
New cuda time: 2.4304089546203613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6628899574279785
New cuda time: 2.4814488887786865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4857699871063232
New cuda time: 2.44848895072937
New cuda time: 2.4843099117279053
New cuda time: 2.442070960998535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4795100688934326
New cuda time: 2.4382309913635254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4555110931396484
New cuda time: 2.4431910514831543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4847910404205322
New cuda time: 2.448791027069092
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4631900787353516
New cuda time: 2.463031053543091
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477750062942505
New cuda time: 2.4395101070404053
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4873509407043457
New cuda time: 2.4327900409698486
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6175899505615234
New cuda time: 2.4100708961486816
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451190948486328
New cuda time: 2.404470920562744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5017499923706055
New cuda time: 2.446230888366699
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4708709716796875
New cuda time: 2.426069974899292
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6387100219726562
New cuda time: 2.439831018447876
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4531099796295166
New cuda time: 2.4494309425354004
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4566309452056885
New cuda time: 2.4492709636688232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4907100200653076
New cuda time: 2.4393510818481445
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477109909057617
New cuda time: 2.4527900218963623
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4849510192871094
New cuda time: 2.4446299076080322
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487510919570923
New cuda time: 2.5881500244140625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4361488819122314
New cuda time: 2.470551013946533
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.503190040588379
New cuda time: 2.444951057434082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481431007385254
New cuda time: 2.4332709312438965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479351043701172
New cuda time: 2.439831018447876
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 10.86347770690918
New cuda time: 2.4415900707244873
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5831899642944336
New cuda time: 2.4535911083221436
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4633500576019287
New cuda time: 2.433911085128784
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477750062942505
New cuda time: 2.454710006713867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4867100715637207
New cuda time: 2.443510055541992
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5017499923706055
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.611030101776123
New cuda time: 2.44399094581604
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471669912338257
New cuda time: 2.4630300998687744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480631113052368
New cuda time: 2.42271089553833
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675099849700928
New cuda time: 2.4654300212860107
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5111899375915527
New cuda time: 2.4231910705566406
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4889509677886963
New cuda time: 11.894835472106934
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4895899295806885
New cuda time: 2.4422309398651123
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4951910972595215
New cuda time: 2.435029983520508
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.492310047149658
New cuda time: 2.4401509761810303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47455096244812
New cuda time: 2.443830966949463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4945499897003174
New cuda time: 2.4313509464263916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.568470001220703
New cuda time: 2.4163100719451904
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455509901046753
New cuda time: 2.4417500495910645
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493911027908325
New cuda time: 2.455190896987915
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4865500926971436
New cuda time: 2.4179110527038574
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4934310913085938
New cuda time: 2.4294309616088867
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4622299671173096
New cuda time: 2.454231023788452
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6289501190185547
New cuda time: 2.488790988922119
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4788711071014404
New cuda time: 2.450870990753174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5015900135040283
New cuda time: 2.4628710746765137
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5123109817504883
New cuda time: 2.4091110229492188
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4859108924865723
New cuda time: 2.5836710929870605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481750965118408
New cuda time: 2.438710927963257
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.486391067504883
New cuda time: 2.4180710315704346
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460951089859009
New cuda time: 2.4351909160614014
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4556710720062256
New cuda time: 2.4604709148406982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4771111011505127
New cuda time: 2.4262309074401855
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452950954437256
New cuda time: 2.4159910678863525
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6422290802001953
New cuda time: 2.4606308937072754
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587109088897705
New cuda time: 2.4467101097106934
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476310968399048
New cuda time: 2.4167909622192383
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5174310207366943
New cuda time: 2.480149984359741
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.599670886993408
New cuda time: 2.469749927520752
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4551899433135986
New cuda time: 2.420470952987671
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.513111114501953
New cuda time: 2.444951057434082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4940710067749023
New cuda time: 2.440790891647339
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4615910053253174
New cuda time: 2.4363110065460205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.493269920349121
New cuda time: 2.459031105041504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.513430118560791
New cuda time: 2.4516708850860596
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.48078989982605
New cuda time: 2.596790075302124
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463191032409668
New cuda time: 2.414551019668579
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5028700828552246
New cuda time: 2.4532699584960938
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4916698932647705
New cuda time: 2.4449501037597656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6107099056243896
New cuda time: 2.4615910053253174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4983909130096436
New cuda time: 2.4559900760650635
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.414091110229492
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45137095451355
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2490.109619140625, gpu time: 432.6563811302185
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.171875
Expert2 overflow: 4.4921875
Expert1 unused count: 221
Expert2 unused count: 306
Expert1 balance top: 81.54296875
Expert2 balance top: 92.67578125

New cuda time: 2.450092077255249
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481611967086792
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2508.74658203125, gpu time: 434.36135149002075
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.3203125
Expert1 unused count: 226
Expert2 unused count: 298
Expert1 balance top: 80.37109375
Expert2 balance top: 91.455078125

New cuda time: 2.484010934829712
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461452007293701
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2513.512451171875, gpu time: 427.31939911842346
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.173828125
Expert2 overflow: 11.81640625
Expert1 unused count: 246
Expert2 unused count: 298
Expert1 balance top: 84.5703125
Expert2 balance top: 91.357421875

New cuda time: 2.4379310607910156
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476491928100586
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2509.857666015625, gpu time: 452.2364659309387
2024-07-11 01:35:40 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.837890625
Expert1 unused count: 261
Expert2 unused count: 290
Expert1 balance top: 84.521484375
Expert2 balance top: 90.478515625

New cuda time: 2.4537711143493652
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4956910610198975
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2514.6513671875, gpu time: 429.09924030303955
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.783203125
Expert2 overflow: 10.107421875
Expert1 unused count: 278
Expert2 unused count: 300
Expert1 balance top: 88.4765625
Expert2 balance top: 90.771484375

New cuda time: 2.4360110759735107
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4785709381103516
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2285.49169921875, gpu time: 440.3656919002533
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.708984375
Expert2 overflow: 17.96875
Expert1 unused count: 182
Expert2 unused count: 279
Expert1 balance top: 77.197265625
Expert2 balance top: 91.357421875

New cuda time: 11.840374946594238
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452651023864746
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2527.1982421875, gpu time: 446.9494071006775
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.5625
Expert2 overflow: 10.693359375
Expert1 unused count: 196
Expert2 unused count: 311
Expert1 balance top: 79.39453125
Expert2 balance top: 92.67578125

New cuda time: 2.446571111679077
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4632110595703125
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2536.53857421875, gpu time: 439.27113461494446
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.396484375
Expert1 unused count: 187
Expert2 unused count: 293
Expert1 balance top: 77.9296875
Expert2 balance top: 91.796875

New cuda time: 2.449770927429199
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.453610897064209
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2541.40966796875, gpu time: 432.22278094291687
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.564453125
Expert2 overflow: 12.255859375
Expert1 unused count: 218
Expert2 unused count: 273
Expert1 balance top: 79.736328125
Expert2 balance top: 89.794921875

New cuda time: 2.6350529193878174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.446091890335083
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2546.798828125, gpu time: 457.3176107406616
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 11.328125
Expert1 unused count: 228
Expert2 unused count: 269
Expert1 balance top: 82.8125
Expert2 balance top: 89.794921875

New cuda time: 2.4620919227600098
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4574520587921143
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2542.486083984375, gpu time: 434.01878333091736
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.099609375
Expert2 overflow: 8.88671875
Expert1 unused count: 258
Expert2 unused count: 266
Expert1 balance top: 87.40234375
Expert2 balance top: 88.232421875

New cuda time: 2.4604909420013428
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5006508827209473
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2311.16943359375, gpu time: 445.3268337249756
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.6640625
Expert2 overflow: 10.498046875
Expert1 unused count: 254
Expert2 unused count: 324
Expert1 balance top: 83.544921875
Expert2 balance top: 94.62890625

New cuda time: 2.4320108890533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4664111137390137
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2554.950927734375, gpu time: 451.84782910346985
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.248046875
Expert2 overflow: 4.052734375
Expert1 unused count: 276
Expert2 unused count: 328
Expert1 balance top: 86.1328125
Expert2 balance top: 93.9453125

New cuda time: 2.459052085876465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4785709381103516
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2564.219482421875, gpu time: 444.2087564468384
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 1.904296875
Expert1 unused count: 274
Expert2 unused count: 331
Expert1 balance top: 84.130859375
Expert2 balance top: 93.310546875

New cuda time: 2.4361720085144043
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4963319301605225
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2569.2958984375, gpu time: 437.1552848815918
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.76171875
Expert2 overflow: 7.861328125
Expert1 unused count: 294
Expert2 unused count: 312
Expert1 balance top: 87.841796875
Expert2 balance top: 92.1875

New cuda time: 2.459052085876465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.500972032546997
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2574.601806640625, gpu time: 462.2776348590851
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 11.962890625
Expert1 unused count: 305
Expert2 unused count: 325
Expert1 balance top: 90.234375
Expert2 balance top: 94.091796875

New cuda time: 2.4246509075164795
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5003321170806885
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2570.150146484375, gpu time: 438.9437663555145
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.34375
Expert2 overflow: 12.548828125
Expert1 unused count: 330
Expert2 unused count: 333
Expert1 balance top: 93.115234375
Expert2 balance top: 94.091796875

New cuda time: 2.4308910369873047
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6713719367980957
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2346.989990234375, gpu time: 450.429096698761
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.6484375
Expert1 unused count: 187
Expert2 unused count: 285
Expert1 balance top: 75.732421875
Expert2 balance top: 92.138671875

New cuda time: 2.4857709407806396
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4606521129608154
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2582.9111328125, gpu time: 456.7942521572113
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.17578125
Expert2 overflow: 13.671875
Expert1 unused count: 200
Expert2 unused count: 286
Expert1 balance top: 80.419921875
Expert2 balance top: 91.748046875

New cuda time: 2.4561710357666016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6038520336151123
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2601.814697265625, gpu time: 449.2687795162201
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.123046875
Expert2 overflow: 15.380859375
Expert1 unused count: 199
Expert2 unused count: 301
Expert1 balance top: 80.56640625
Expert2 balance top: 92.28515625

New cuda time: 2.4814510345458984
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4720120429992676
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2595.784423828125, gpu time: 442.10874795913696
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.224609375
Expert2 overflow: 16.89453125
Expert1 unused count: 240
Expert2 unused count: 302
Expert1 balance top: 83.88671875
Expert2 balance top: 92.3828125

New cuda time: 2.466891050338745
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4579310417175293
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2601.547119140625, gpu time: 467.20245695114136
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 20.263671875
Expert1 unused count: 258
Expert2 unused count: 297
Expert1 balance top: 85.693359375
Expert2 balance top: 91.943359375

New cuda time: 2.4315309524536133
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482732057571411
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2597.193359375, gpu time: 443.85802936553955
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.806640625
Expert2 overflow: 9.27734375
Expert1 unused count: 276
Expert2 unused count: 290
Expert1 balance top: 88.525390625
Expert2 balance top: 90.0390625

New cuda time: 2.4435319900512695
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470571994781494
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2371.565185546875, gpu time: 455.34320068359375
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 22.998046875
Expert2 overflow: 36.62109375
Expert1 unused count: 274
Expert2 unused count: 370
Expert1 balance top: 90.869140625
Expert2 balance top: 98.095703125

New cuda time: 2.473931074142456
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4984118938446045
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2610.03515625, gpu time: 461.76659512519836
2024-07-11 01:35:41 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 27.05078125
Expert2 overflow: 36.279296875
Expert1 unused count: 297
Expert2 unused count: 376
Expert1 balance top: 92.1875
Expert2 balance top: 98.388671875

New cuda time: 2.440330982208252
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4492909908294678
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2628.854736328125, gpu time: 454.1584014892578
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 13.525390625
Expert2 overflow: 35.107421875
Expert1 unused count: 299
Expert2 unused count: 354
Expert1 balance top: 91.845703125
Expert2 balance top: 96.875

New cuda time: 2.462412118911743
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4905710220336914
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2623.000732421875, gpu time: 447.0617299079895
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 7.177734375
Expert2 overflow: 30.17578125
Expert1 unused count: 295
Expert2 unused count: 332
Expert1 balance top: 91.357421875
Expert2 balance top: 95.21484375

New cuda time: 2.4392120838165283
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469291925430298
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2629.009765625, gpu time: 472.1109609603882
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 12.79296875
Expert2 overflow: 23.291015625
Expert1 unused count: 302
Expert2 unused count: 320
Expert1 balance top: 91.748046875
Expert2 balance top: 93.701171875

New cuda time: 2.4075310230255127
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6204919815063477
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2624.60693359375, gpu time: 448.8860523700714
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 20.60546875
Expert2 overflow: 30.76171875
Expert1 unused count: 346
Expert2 unused count: 334
Expert1 balance top: 96.142578125
Expert2 balance top: 95.654296875

New cuda time: 2.5622520446777344
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475050926208496
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2406.83984375, gpu time: 460.38050365448
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 10.009765625
Expert1 unused count: 190
Expert2 unused count: 299
Expert1 balance top: 75.927734375
Expert2 balance top: 91.11328125

New cuda time: 2.4406509399414062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.62833309173584
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2639.725341796875, gpu time: 466.8355791568756
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.080078125
Expert1 unused count: 214
Expert2 unused count: 304
Expert1 balance top: 82.03125
Expert2 balance top: 92.529296875

New cuda time: 2.4676918983459473
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476331949234009
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2656.460205078125, gpu time: 459.10242533683777
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.68359375
Expert2 overflow: 10.7421875
Expert1 unused count: 213
Expert2 unused count: 297
Expert1 balance top: 79.833984375
Expert2 balance top: 91.9921875

New cuda time: 2.4464120864868164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.452172040939331
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2650.689697265625, gpu time: 451.96031403541565
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.22265625
Expert2 overflow: 13.76953125
Expert1 unused count: 246
Expert2 unused count: 280
Expert1 balance top: 83.30078125
Expert2 balance top: 90.625

New cuda time: 2.444330930709839
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4528110027313232
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2656.48193359375, gpu time: 477.00810289382935
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.498046875
Expert1 unused count: 259
Expert2 unused count: 278
Expert1 balance top: 85.009765625
Expert2 balance top: 90.087890625

New cuda time: 2.4702510833740234
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4446520805358887
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2652.125, gpu time: 453.80095648765564
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.90625
Expert2 overflow: 6.4453125
Expert1 unused count: 280
Expert2 unused count: 271
Expert1 balance top: 88.427734375
Expert2 balance top: 86.669921875

New cuda time: 2.429131031036377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4852919578552246
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2432.2158203125, gpu time: 465.2949266433716
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.859375
Expert2 overflow: 8.349609375
Expert1 unused count: 221
Expert2 unused count: 310
Expert1 balance top: 81.4453125
Expert2 balance top: 93.65234375

New cuda time: 2.4646520614624023
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.496170997619629
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2667.545166015625, gpu time: 471.79640221595764
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.4921875
Expert2 overflow: 4.931640625
Expert1 unused count: 223
Expert2 unused count: 328
Expert1 balance top: 82.8125
Expert2 balance top: 94.580078125

New cuda time: 2.472651958465576
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4969708919525146
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2684.184326171875, gpu time: 464.07204723358154
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 2.734375
Expert1 unused count: 215
Expert2 unused count: 313
Expert1 balance top: 80.2734375
Expert2 balance top: 93.115234375

New cuda time: 2.432651996612549
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463850975036621
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2678.130615234375, gpu time: 456.8568170070648
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.78515625
Expert2 overflow: 9.814453125
Expert1 unused count: 230
Expert2 unused count: 289
Expert1 balance top: 83.935546875
Expert2 balance top: 91.015625

New cuda time: 2.4400110244750977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479051113128662
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2684.24267578125, gpu time: 481.9271650314331
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 9.08203125
Expert1 unused count: 254
Expert2 unused count: 275
Expert1 balance top: 85.791015625
Expert2 balance top: 90.625

New cuda time: 10.783729553222656
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4480109214782715
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2688.30517578125, gpu time: 467.03269696235657
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.7578125
Expert2 overflow: 12.20703125
Expert1 unused count: 275
Expert2 unused count: 293
Expert1 balance top: 88.623046875
Expert2 balance top: 91.357421875

New cuda time: 2.4510509967803955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.43697190284729
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2467.01513671875, gpu time: 470.18294954299927
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.537109375
Expert2 overflow: 6.689453125
Expert1 unused count: 127
Expert2 unused count: 285
Expert1 balance top: 70.263671875
Expert2 balance top: 91.162109375

New cuda time: 2.4403319358825684
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4828920364379883
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2695.033447265625, gpu time: 476.7196261882782
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.61328125
Expert2 overflow: 8.251953125
Expert1 unused count: 111
Expert2 unused count: 266
Expert1 balance top: 69.23828125
Expert2 balance top: 89.55078125

New cuda time: 2.4235310554504395
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.500330924987793
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2711.767333984375, gpu time: 468.9959092140198
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.373046875
Expert1 unused count: 115
Expert2 unused count: 268
Expert1 balance top: 68.798828125
Expert2 balance top: 89.2578125

New cuda time: 2.4382519721984863
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.539531946182251
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2705.975830078125, gpu time: 461.83459997177124
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.66796875
Expert1 unused count: 133
Expert2 unused count: 244
Expert1 balance top: 69.482421875
Expert2 balance top: 86.962890625

New cuda time: 2.437450885772705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489612102508545
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2711.856689453125, gpu time: 486.85422801971436
2024-07-11 01:35:42 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 16.943359375
Expert1 unused count: 163
Expert2 unused count: 224
Expert1 balance top: 71.044921875
Expert2 balance top: 85.3515625

New cuda time: 2.4654510021209717
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480652093887329
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2716.163330078125, gpu time: 471.97880005836487
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.71484375
Expert1 unused count: 184
Expert2 unused count: 200
Expert1 balance top: 75.732421875
Expert2 balance top: 80.712890625

New cuda time: 2.4182510375976562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4712119102478027
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2492.8173828125, gpu time: 475.0724124908447
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.611328125
Expert2 overflow: 7.03125
Expert1 unused count: 185
Expert2 unused count: 279
Expert1 balance top: 74.4140625
Expert2 balance top: 90.625

New cuda time: 2.4532909393310547
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870519638061523
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2723.102294921875, gpu time: 481.6599690914154
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.416015625
Expert2 overflow: 4.8828125
Expert1 unused count: 211
Expert2 unused count: 305
Expert1 balance top: 79.736328125
Expert2 balance top: 92.87109375

New cuda time: 2.4448111057281494
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.514251947402954
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2739.848876953125, gpu time: 473.9549732208252
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.78125
Expert2 overflow: 6.494140625
Expert1 unused count: 214
Expert2 unused count: 308
Expert1 balance top: 80.17578125
Expert2 balance top: 92.529296875

New cuda time: 2.4190518856048584
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5500919818878174
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2734.233154296875, gpu time: 466.8037438392639
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.078125
Expert2 overflow: 9.47265625
Expert1 unused count: 236
Expert2 unused count: 285
Expert1 balance top: 82.32421875
Expert2 balance top: 89.990234375

New cuda time: 2.458570957183838
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6651320457458496
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2749.36572265625, gpu time: 491.97793197631836
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.837890625
Expert1 unused count: 262
Expert2 unused count: 290
Expert1 balance top: 85.546875
Expert2 balance top: 90.380859375

New cuda time: 2.452971935272217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.522252082824707
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2753.739990234375, gpu time: 476.9540240764618
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.2734375
Expert2 overflow: 8.349609375
Expert1 unused count: 276
Expert2 unused count: 269
Expert1 balance top: 89.501953125
Expert2 balance top: 87.79296875

New cuda time: 2.413770914077759
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5097720623016357
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2518.673583984375, gpu time: 479.9959554672241
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 6.25
Expert2 overflow: 15.478515625
Expert1 unused count: 274
Expert2 unused count: 339
Expert1 balance top: 91.69921875
Expert2 balance top: 96.435546875

New cuda time: 2.43825101852417
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.475851058959961
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2751.173583984375, gpu time: 486.57407116889954
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.88671875
Expert2 overflow: 4.39453125
Expert1 unused count: 261
Expert2 unused count: 342
Expert1 balance top: 91.064453125
Expert2 balance top: 96.337890625

New cuda time: 2.4528110027313232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5443320274353027
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2767.9072265625, gpu time: 478.9521162509918
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 17.578125
Expert2 overflow: 11.767578125
Expert1 unused count: 265
Expert2 unused count: 344
Expert1 balance top: 91.015625
Expert2 balance top: 96.044921875

New cuda time: 2.4870519638061523
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.528491973876953
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2762.4833984375, gpu time: 471.819287776947
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 8.935546875
Expert2 overflow: 8.447265625
Expert1 unused count: 257
Expert2 unused count: 318
Expert1 balance top: 89.6484375
Expert2 balance top: 94.873046875

New cuda time: 2.4422519207000732
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482572078704834
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2777.329833984375, gpu time: 496.90275597572327
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 24.560546875
Expert1 unused count: 270
Expert2 unused count: 327
Expert1 balance top: 89.990234375
Expert2 balance top: 95.1171875

New cuda time: 2.457451105117798
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.504812002182007
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2782.04541015625, gpu time: 481.9162871837616
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 5.859375
Expert2 overflow: 19.091796875
Expert1 unused count: 261
Expert2 unused count: 309
Expert1 balance top: 91.015625
Expert2 balance top: 93.75

New cuda time: 2.4400110244750977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469611883163452
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2544.281494140625, gpu time: 484.90557837486267
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.47265625
Expert1 unused count: 102
Expert2 unused count: 255
Expert1 balance top: 63.427734375
Expert2 balance top: 89.16015625

New cuda time: 2.4449710845947266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.487531900405884
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2779.462158203125, gpu time: 491.50657510757446
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 5.712890625
Expert1 unused count: 98
Expert2 unused count: 274
Expert1 balance top: 63.57421875
Expert2 balance top: 90.33203125

New cuda time: 2.448491096496582
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460171937942505
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2796.1025390625, gpu time: 483.8607792854309
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.330078125
Expert1 unused count: 107
Expert2 unused count: 254
Expert1 balance top: 63.720703125
Expert2 balance top: 89.35546875

New cuda time: 2.4472110271453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.408971071243286
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2804.48583984375, gpu time: 476.67547082901
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.29296875
Expert2 overflow: 9.1796875
Expert1 unused count: 117
Expert2 unused count: 225
Expert1 balance top: 63.330078125
Expert2 balance top: 85.83984375

New cuda time: 2.430250883102417
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4652910232543945
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2804.23974609375, gpu time: 501.798299074173
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 4.150390625
Expert1 unused count: 117
Expert2 unused count: 193
Expert1 balance top: 64.404296875
Expert2 balance top: 80.419921875

New cuda time: 2.4268910884857178
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4952120780944824
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2809.4462890625, gpu time: 486.8383903503418
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.634765625
Expert2 overflow: 2.24609375
Expert1 unused count: 168
Expert2 unused count: 183
Expert1 balance top: 68.84765625
Expert2 balance top: 76.5625

New cuda time: 2.440330982208252
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5107309818267822
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2569.387939453125, gpu time: 489.8566403388977
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.9609375
Expert1 unused count: 225
Expert2 unused count: 325
Expert1 balance top: 80.56640625
Expert2 balance top: 94.3359375

New cuda time: 2.4428908824920654
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4931321144104004
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2806.731689453125, gpu time: 496.44259810447693
2024-07-11 01:35:43 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 3.271484375
Expert1 unused count: 253
Expert2 unused count: 319
Expert1 balance top: 83.984375
Expert2 balance top: 93.06640625

New cuda time: 2.4412920475006104
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457451105117798
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2823.421875, gpu time: 488.7595224380493
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.90625
Expert2 overflow: 2.392578125
Expert1 unused count: 243
Expert2 unused count: 307
Expert1 balance top: 82.763671875
Expert2 balance top: 91.50390625

New cuda time: 2.4508910179138184
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.492811918258667
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2831.922119140625, gpu time: 481.6191737651825
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.85546875
Expert2 overflow: 15.576171875
Expert1 unused count: 286
Expert2 unused count: 313
Expert1 balance top: 86.5234375
Expert2 balance top: 91.69921875

New cuda time: 2.4472110271453857
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4721710681915283
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2831.997314453125, gpu time: 506.7176811695099
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 17.431640625
Expert1 unused count: 301
Expert2 unused count: 321
Expert1 balance top: 89.74609375
Expert2 balance top: 94.189453125

New cuda time: 2.4528110027313232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.451211929321289
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2837.05029296875, gpu time: 491.7424132823944
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 4.833984375
Expert2 overflow: 12.6953125
Expert1 unused count: 326
Expert2 unused count: 338
Expert1 balance top: 92.7734375
Expert2 balance top: 94.287109375

New cuda time: 2.431691884994507
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461132049560547
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2594.4755859375, gpu time: 494.74946427345276
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.35546875
Expert1 unused count: 189
Expert2 unused count: 307
Expert1 balance top: 78.90625
Expert2 balance top: 93.896484375

New cuda time: 2.4630520343780518
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4763309955596924
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2834.25341796875, gpu time: 501.3819811344147
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.125
Expert2 overflow: 14.892578125
Expert1 unused count: 201
Expert2 unused count: 310
Expert1 balance top: 79.58984375
Expert2 balance top: 93.9453125

2.4630401134490967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710400104522705
New cuda time: 2.4627199172973633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4639999866485596
New cuda time: 2.455359935760498
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461280107498169
New cuda time: 2.4630401134490967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4811201095581055
New cuda time: 2.4243199825286865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47760009765625
New cuda time: 2.419200897216797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4635210037231445
New cuda time: 11.827362060546875
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710400104522705
New cuda time: 2.4323201179504395
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4560000896453857
New cuda time: 2.4944000244140625
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600000381469727
New cuda time: 2.6326398849487305
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465440034866333
New cuda time: 2.4587199687957764
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4486401081085205
New cuda time: 2.4158411026000977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4670400619506836
New cuda time: 2.457119941711426
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479361057281494
New cuda time: 2.4491209983825684
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46016001701355
New cuda time: 2.4374399185180664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455841064453125
New cuda time: 2.482240915298462
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587199687957764
New cuda time: 2.455359935760498
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469921112060547
New cuda time: 2.4478399753570557
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.616641044616699
New cuda time: 2.458081007003784
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462239980697632
New cuda time: 2.4974400997161865
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6132800579071045
New cuda time: 2.4193599224090576
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460160970687866
New cuda time: 2.454240083694458
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473759889602661
New cuda time: 2.4524800777435303
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.435520887374878
New cuda time: 2.421600103378296
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4822399616241455
New cuda time: 2.4932799339294434
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4758400917053223
New cuda time: 2.4587199687957764
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479680061340332
New cuda time: 2.4548799991607666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4505600929260254
New cuda time: 2.4463999271392822
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841599464416504
New cuda time: 2.485759973526001
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47871994972229
New cuda time: 2.588160991668701
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468319892883301
New cuda time: 2.449760913848877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6515209674835205
New cuda time: 2.4820799827575684
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649600982666016
New cuda time: 2.488960027694702
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45632004737854
New cuda time: 2.439199924468994
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465440034866333
New cuda time: 2.4627199172973633
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4860799312591553
New cuda time: 2.4457600116729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.437761068344116
New cuda time: 2.4468801021575928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4926400184631348
New cuda time: 2.493920087814331
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4692800045013428
New cuda time: 2.461760997772217
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480959892272949
New cuda time: 2.431360960006714
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4750399589538574
New cuda time: 10.786401748657227
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473120927810669
New cuda time: 2.6526401042938232
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4382400512695312
New cuda time: 2.437119960784912
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4769599437713623
New cuda time: 2.436800956726074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4515199661254883
New cuda time: 2.4534409046173096
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4404799938201904
New cuda time: 2.4665610790252686
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4758400917053223
New cuda time: 2.4340810775756836
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4729599952697754
New cuda time: 2.453439950942993
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483839988708496
New cuda time: 2.4407999515533447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4659199714660645
New cuda time: 2.4288010597229004
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4382400512695312
New cuda time: 2.4612810611724854
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469921112060547
New cuda time: 2.424639940261841
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.584480047225952
New cuda time: 2.6559998989105225
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649600982666016
New cuda time: 2.4537599086761475
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753599166870117
New cuda time: 2.4475200176239014
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4771199226379395
New cuda time: 2.443681001663208
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4529600143432617
New cuda time: 2.4208009243011475
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464160919189453
New cuda time: 2.427999973297119
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483520030975342
New cuda time: 2.435520887374878
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.492321014404297
New cuda time: 2.4513609409332275
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4779210090637207
New cuda time: 2.4318408966064453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474560022354126
New cuda time: 2.4542410373687744
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5083210468292236
New cuda time: 2.410399913787842
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 7.214400768280029
New cuda time: 2.449920892715454
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472320079803467
New cuda time: 2.4390408992767334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4942400455474854
New cuda time: 2.440160036087036
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4407999515533447
New cuda time: 2.4809610843658447
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4548799991607666
New cuda time: 2.460000991821289
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.460319995880127
New cuda time: 2.4377601146698
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4504001140594482
New cuda time: 2.4900810718536377
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4486401081085205
New cuda time: 2.457120895385742
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467360019683838
New cuda time: 2.43503999710083
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4632010459899902
New cuda time: 2.4763200283050537
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4716811180114746
New cuda time: torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4875290393829346
New cuda time: 2.436969041824341
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47248911857605
New cuda time: 2.435209035873413
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4592089653015137
New cuda time: 2.4379289150238037
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4531290531158447
New cuda time: 2.434889078140259
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46304988861084
New cuda time: 2.483689069747925
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455368995666504
New cuda time: 11.860045433044434
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4907290935516357
New cuda time: 2.4380900859832764
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4667301177978516
New cuda time: 2.4432098865509033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455368995666504
New cuda time: 2.608808994293213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.489129066467285
New cuda time: 2.4404890537261963
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4548890590667725
New cuda time: 2.4755289554595947
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439690113067627
New cuda time: 2.4291300773620605
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4336090087890625
New cuda time: 2.468648910522461
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4612889289855957
New cuda time: 2.444489002227783
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4569690227508545
New cuda time: 2.449129104614258
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.471688985824585
New cuda time: 2.457930088043213
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.45809006690979
New cuda time: 2.439049005508423
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6176109313964844
New cuda time: 2.464488983154297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4489688873291016
New cuda time: 2.4465699195861816
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.664489984512329
New cuda time: 2.4644899368286133
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4739298820495605
New cuda time: 2.438889980316162
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.478729009628296
New cuda time: 2.438889980316162
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4622490406036377
New cuda time: 2.4824090003967285
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4756898880004883
New cuda time: 2.445770025253296
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4388890266418457
New cuda time: 2.425610065460205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4664089679718018
New cuda time: 2.4595301151275635
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4843289852142334
New cuda time: 2.45809006690979
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883289337158203
New cuda time: 2.4587290287017822
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470410108566284
New cuda time: 2.581130027770996
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.465449094772339
New cuda time: 2.4616100788116455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6000099182128906
New cuda time: 2.423369884490967
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5032100677490234
New cuda time: 2.439049005508423
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467529058456421
New cuda time: 2.446249008178711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4766499996185303
New cuda time: 2.436328887939453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483048915863037
New cuda time: 2.493129014968872
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4494500160217285
New cuda time: 2.4408090114593506
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4683289527893066
New cuda time: 2.436490058898926
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.455209970474243
New cuda time: 2.434889078140259
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484489917755127
New cuda time: 2.433289051055908
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461289882659912
New cuda time: 10.85876178741455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467849016189575
New cuda time: 2.5763299465179443
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4673690795898438
New cuda time: 2.454090118408203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474569082260132
New cuda time: 2.4305689334869385
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4500889778137207
New cuda time: 2.4150490760803223
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473289966583252
New cuda time: 2.41825008392334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4792098999023438
New cuda time: 2.422729015350342
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469130039215088
New cuda time: 2.4801690578460693
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4820899963378906
New cuda time: 2.403209924697876
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4630489349365234
New cuda time: 2.451369047164917
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46048903465271
New cuda time: 2.4212899208068848
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4563300609588623
New cuda time: 2.436650037765503
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6384100914001465
New cuda time: 2.606410026550293
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463210105895996
New cuda time: 2.467689037322998
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466728925704956
New cuda time: 2.410568952560425
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4684898853302
New cuda time: 2.441288948059082
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.439690113067627
New cuda time: 2.4392099380493164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4659290313720703
New cuda time: 2.425290107727051
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472170114517212
New cuda time: 2.4446499347686768
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4689700603485107
New cuda time: 2.4619300365448
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4900898933410645
New cuda time: 2.4595301151275635
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4630489349365234
New cuda time: 2.398569107055664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4564900398254395
New cuda time: 2.451849937438965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6406500339508057
New cuda time: 2.420330047607422
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4534499645233154
New cuda time: 2.449449062347412
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476809024810791
New cuda time: 2.454890012741089
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4651288986206055
New cuda time: 2.4315290451049805
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.467529058456421
New cuda time: 2.4624099731445312
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4622490406036377
New cuda time: 2.4236900806427
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.466568946838379
New cuda time: 2.4710500240325928
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4804890155792236
New cuda time: 2.4432098865509033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463210105895996
New cuda time: 2.4600090980529785
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.463529109954834
New cuda time: 2.4441699981689453
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.457289934158325
New cuda time: 2.4539289474487305
torch.Size([4, 128, 103, 768]) New cuda time: 2.4622299671173096
New cuda time: 2.442711114883423
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4838309288024902
New cuda time: 2.4169509410858154
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472790002822876
New cuda time: 2.455030918121338
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485590934753418
New cuda time: 2.462070941925049
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4300711154937744
New cuda time: 2.4321510791778564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477431058883667
New cuda time: 11.81163501739502
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4915099143981934
New cuda time: 2.4476699829101562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4791910648345947
New cuda time: 2.4324710369110107
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587109088897705
New cuda time: 2.5999889373779297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.500631093978882
New cuda time: 2.4523110389709473
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479511022567749
New cuda time: 2.449911117553711
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4625511169433594
New cuda time: 2.4364709854125977
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47343111038208
New cuda time: 2.4313509464263916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649510383605957
New cuda time: 2.4270310401916504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4665510654449463
New cuda time: 2.402070999145508
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5027101039886475
New cuda time: 2.450071096420288
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4815900325775146
New cuda time: 2.422550916671753
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.643510103225708
New cuda time: 2.4199910163879395
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4743900299072266
New cuda time: 2.438710927963257
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6278300285339355
New cuda time: 2.415350914001465
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4686310291290283
New cuda time: 2.416630983352661
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4556710720062256
New cuda time: 2.4303910732269287
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.498871088027954
New cuda time: 2.4652700424194336
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4534308910369873
New cuda time: 2.425110101699829
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4659109115600586
New cuda time: 2.427989959716797
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4945499897003174
New cuda time: 2.44638991355896
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476470947265625
New cuda time: 2.437911033630371
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4870309829711914
New cuda time: 2.4283111095428467
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5004711151123047
New cuda time: 2.6267099380493164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782309532165527
New cuda time: 2.424631118774414
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.628951072692871
New cuda time: 2.434870958328247
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5033509731292725
New cuda time: 2.4340710639953613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476470947265625
New cuda time: 2.4473509788513184
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4995100498199463
New cuda time: 2.4161510467529297
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.458390951156616
New cuda time: 2.4590299129486084
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.479990005493164
New cuda time: 2.44783091545105
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4281508922576904
New cuda time: 2.4316699504852295
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4964699745178223
New cuda time: 2.42271089553833
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483350992202759
New cuda time: 2.4382309913635254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4723100662231445
New cuda time: 10.777559280395508
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4459099769592285
New cuda time: 2.595989942550659
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4886300563812256
New cuda time: 2.4527909755706787
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47455096244812
New cuda time: 2.4382309913635254
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.491831064224243
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.547990083694458
New cuda time: 2.4574310779571533
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4782309532165527
New cuda time: 2.4484710693359375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.490230083465576
New cuda time: 2.4483110904693604
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472630023956299
New cuda time: 2.446070909500122
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4868710041046143
New cuda time: 2.4377501010894775
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5334300994873047
New cuda time: 2.4233510494232178
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5727899074554443
New cuda time: 2.4452710151672363
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6462299823760986
New cuda time: 2.6043100357055664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.515510082244873
New cuda time: 2.422390937805176
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5289499759674072
New cuda time: 2.441751003265381
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4852709770202637
New cuda time: 2.424631118774414
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.543989896774292
New cuda time: 2.410551071166992
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4881510734558105
New cuda time: 2.4638309478759766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.456151008605957
New cuda time: 2.437751054763794
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.484950065612793
New cuda time: 2.4324710369110107
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4655909538269043
New cuda time: 2.4601500034332275
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5007901191711426
New cuda time: 2.474390983581543
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4543910026550293
New cuda time: 2.4331109523773193
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 7.309092998504639
New cuda time: 2.4447898864746094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4838309288024902
New cuda time: 2.4363110065460205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4916698932647705
New cuda time: 2.4491090774536133
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.481590986251831
New cuda time: 2.4412710666656494
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4604709148406982
New cuda time: 2.420630931854248
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.502070903778076
New cuda time: 2.461271047592163
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470391035079956
New cuda time: 2.4451100826263428
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4620699882507324
New cuda time: 2.439671039581299
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477591037750244
New cuda time: 2.4254310131073
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4710309505462646
New cuda time: 2.4100708961486816
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649510383605957
New cuda time: 2.447350025177002
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4305710792541504
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.632812976837158
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2860.638427734375, gpu time: 493.8229064941406
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.87890625
Expert2 overflow: 14.6484375
Expert1 unused count: 205
Expert2 unused count: 307
Expert1 balance top: 79.833984375
Expert2 balance top: 93.359375

New cuda time: 2.5977718830108643
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4753708839416504
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2869.2724609375, gpu time: 486.692316532135
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.48828125
Expert2 overflow: 19.82421875
Expert1 unused count: 217
Expert2 unused count: 283
Expert1 balance top: 81.4453125
Expert2 balance top: 90.72265625

New cuda time: 2.4576120376586914
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4742519855499268
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2859.73193359375, gpu time: 511.6495451927185
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.09765625
Expert2 overflow: 16.50390625
Expert1 unused count: 234
Expert2 unused count: 275
Expert1 balance top: 82.32421875
Expert2 balance top: 89.74609375

New cuda time: 2.4232120513916016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.513292074203491
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2864.87548828125, gpu time: 496.6789174079895
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.025390625
Expert2 overflow: 6.0546875
Expert1 unused count: 267
Expert2 unused count: 260
Expert1 balance top: 86.328125
Expert2 balance top: 87.6953125

New cuda time: 2.4348909854888916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.482572078704834
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2619.4169921875, gpu time: 499.6669273376465
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.5859375
Expert2 overflow: 11.376953125
Expert1 unused count: 155
Expert2 unused count: 267
Expert1 balance top: 72.75390625
Expert2 balance top: 89.35546875

New cuda time: 2.4462509155273438
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4752120971679688
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2861.85302734375, gpu time: 506.30344414711
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.146484375
Expert2 overflow: 6.4453125
Expert1 unused count: 174
Expert2 unused count: 302
Expert1 balance top: 76.26953125
Expert2 balance top: 92.1875

New cuda time: 2.4321720600128174
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4640109539031982
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2888.300537109375, gpu time: 498.71908950805664
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.390625
Expert2 overflow: 9.375
Expert1 unused count: 176
Expert2 unused count: 285
Expert1 balance top: 76.07421875
Expert2 balance top: 91.50390625

New cuda time: 2.4369709491729736
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4480109214782715
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2896.80126953125, gpu time: 491.57729840278625
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 3.125
Expert2 overflow: 10.83984375
Expert1 unused count: 204
Expert2 unused count: 277
Expert1 balance top: 78.369140625
Expert2 balance top: 91.015625

New cuda time: 2.4609711170196533
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4649720191955566
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2887.511474609375, gpu time: 516.5754883289337
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 8.203125
Expert1 unused count: 216
Expert2 unused count: 259
Expert1 balance top: 80.6640625
Expert2 balance top: 87.98828125

New cuda time: 2.4667320251464844
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.480010986328125
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2892.501220703125, gpu time: 501.6256604194641
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 2.197265625
Expert2 overflow: 6.8359375
Expert1 unused count: 234
Expert2 unused count: 259
Expert1 balance top: 84.86328125
Expert2 balance top: 86.03515625

New cuda time: 2.440972089767456
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.469611883163452
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2648.09765625, gpu time: 504.5775113105774
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 6.25
Expert1 unused count: 147
Expert2 unused count: 277
Expert1 balance top: 70.751953125
Expert2 balance top: 89.84375

New cuda time: 2.441931962966919
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6225719451904297
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2896.140625, gpu time: 511.367947101593
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.07421875
Expert2 overflow: 11.865234375
Expert1 unused count: 175
Expert2 unused count: 306
Expert1 balance top: 74.90234375
Expert2 balance top: 93.701171875

New cuda time: 12.457497596740723
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.473292112350464
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2925.933349609375, gpu time: 513.6498792171478
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 10.83984375
Expert1 unused count: 176
Expert2 unused count: 286
Expert1 balance top: 76.220703125
Expert2 balance top: 91.50390625

New cuda time: 2.4310519695281982
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4627320766448975
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2924.236328125, gpu time: 496.47108244895935
2024-07-11 01:35:44 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 13.57421875
Expert1 unused count: 183
Expert2 unused count: 258
Expert1 balance top: 76.46484375
Expert2 balance top: 87.744140625

New cuda time: 2.4494519233703613
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4360110759735107
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2915.177490234375, gpu time: 521.4609503746033
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.1953125
Expert2 overflow: 18.115234375
Expert1 unused count: 209
Expert2 unused count: 253
Expert1 balance top: 81.103515625
Expert2 balance top: 87.548828125

New cuda time: 2.447052001953125
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.525291919708252
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2920.3955078125, gpu time: 506.5980043411255
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 1.904296875
Expert2 overflow: 3.80859375
Expert1 unused count: 253
Expert2 unused count: 258
Expert1 balance top: 86.1328125
Expert2 balance top: 86.474609375

New cuda time: 2.4232120513916016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485771894454956
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2673.415283203125, gpu time: 509.48649525642395
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 7.568359375
Expert1 unused count: 132
Expert2 unused count: 263
Expert1 balance top: 69.921875
Expert2 balance top: 88.57421875

New cuda time: 2.441132068634033
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485771894454956
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2924.040283203125, gpu time: 516.2948501110077
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.78125
Expert2 overflow: 7.275390625
Expert1 unused count: 145
Expert2 unused count: 292
Expert1 balance top: 70.849609375
Expert2 balance top: 92.87109375

New cuda time: 2.4451310634613037
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.497771978378296
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2953.42626953125, gpu time: 518.5927822589874
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 14.16015625
Expert1 unused count: 171
Expert2 unused count: 302
Expert1 balance top: 74.462890625
Expert2 balance top: 93.45703125

New cuda time: 2.4718520641326904
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4612910747528076
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2952.04443359375, gpu time: 501.40422463417053
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.0
Expert2 overflow: 9.375
Expert1 unused count: 173
Expert2 unused count: 263
Expert1 balance top: 74.365234375
Expert2 balance top: 88.818359375

New cuda time: 2.4288110733032227
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4537720680236816
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2942.822021484375, gpu time: 526.3435335159302
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.830078125
Expert2 overflow: 13.623046875
Expert1 unused count: 181
Expert2 unused count: 236
Expert1 balance top: 77.9296875
Expert2 balance top: 86.81640625

New cuda time: 2.410572052001953
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5734519958496094
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | cpu time: 2966.818115234375, gpu time: 511.58202743530273
2024-07-11 01:35:45 | INFO | fairseq.modules.moe.moe_layer | Expert1 overflow: 0.439453125
Expert2 overflow: 5.517578125
Expert1 unused count: 208
Expert2 unused count: 218
Expert1 balance top: 79.248046875
Expert2 balance top: 82.373046875

New cuda time: 2.6275100708007812
New cuda time: 2.6025500297546387
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.476630926132202
New cuda time: 2.405271053314209
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4553511142730713
New cuda time: 2.489109992980957
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5046300888061523
New cuda time: 2.4665510654449463
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4937500953674316
New cuda time: 2.4371109008789062
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464310884475708
New cuda time: 2.4468700885772705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.461271047592163
New cuda time: 2.4313509464263916
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5142300128936768
New cuda time: 2.4151909351348877
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.468471050262451
New cuda time: 2.4363110065460205
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4839909076690674
New cuda time: 2.4177510738372803
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4795100688934326
New cuda time: 2.4414310455322266
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.615670919418335
New cuda time: 12.428592681884766
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.46766996383667
New cuda time: 2.4403109550476074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.5076699256896973
New cuda time: 2.422550916671753
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.472630023956299
New cuda time: 2.428309917449951
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.523509979248047
New cuda time: 2.44783091545105
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4883110523223877
New cuda time: 2.439671039581299
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.477591037750244
New cuda time: 2.4433510303497314
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4881510734558105
New cuda time: 2.432631015777588
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4675099849700928
New cuda time: 2.4259109497070312
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4791901111602783
New cuda time: 2.4526309967041016
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6297500133514404
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2.4783999919891357
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.623039960861206
New cuda time: 2.5723209381103516
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4486401081085205
New cuda time: 2.4776010513305664
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4600000381469727
New cuda time: 2.4574410915374756
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4820799827575684
New cuda time: 2.4119999408721924
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.459841012954712
New cuda time: 2.439039945602417
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4587209224700928
New cuda time: 2.436959981918335
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4606399536132812
New cuda time: 2.4563210010528564
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4484798908233643
New cuda time: 2.4553608894348145
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4504001140594482
New cuda time: 2.4654409885406494
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4732799530029297
New cuda time: 2.488481044769287
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4708809852600098
New cuda time: 2.436800003051758
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.6283199787139893
New cuda time: 12.458083152770996
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4659199714660645
New cuda time: 2.4598400592803955
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.483680009841919
New cuda time: 2.45392107963562
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4863998889923096
New cuda time: 2.454880952835083
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.440800905227661
New cuda time: 2.4664011001586914
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.485599994659424
New cuda time: 2.4196810722351074
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4748799800872803
New cuda time: 2.459199905395508
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.470081090927124
New cuda time: 2.4444799423217773
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4611198902130127
New cuda time: 2.446239948272705
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47632098197937
New cuda time: 2.4580800533294678
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 10.659201622009277
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
torch.float32
New cuda time: 2.6606500148773193
New cuda time: 2.5868899822235107
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4552090167999268
New cuda time: 2.4452900886535645
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.490410089492798
New cuda time: 2.4652891159057617
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4657700061798096
New cuda time: 2.4790499210357666
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4268898963928223
New cuda time: 2.4275290966033936
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.464648962020874
New cuda time: 2.41825008392334
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4612889289855957
New cuda time: 2.435689926147461
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4993700981140137
New cuda time: 2.443368911743164
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4676899909973145
New cuda time: 2.4364891052246094
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.462409019470215
New cuda time: 2.4945690631866455
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.47360897064209
New cuda time: 2.4352099895477295
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.634730100631714
New cuda time: 12.470447540283203
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.444969892501831
New cuda time: 2.440169095993042
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4841690063476562
New cuda time: 2.451849937438965
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4923288822174072
New cuda time: 2.4382500648498535
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4580891132354736
New cuda time: 2.468648910522461
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.474410057067871
New cuda time: 2.4691290855407715
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4585700035095215
New cuda time: 2.424968957901001
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4769699573516846
New cuda time: 2.4296090602874756
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.4556899070739746
New cuda time: 2.4448089599609375
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 2.43681001663208
New cuda time: 2.458409070968628
torch.Size([4, 128, 103, 768]) torch.float32
New cuda time: 10.688521385192871
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating scores across the distributed world
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:35:45 | WARNING | fairseq_cli.eval_lm | Aggregating timer stats across the distributed world
2024-07-11 01:35:45 | INFO | fairseq_cli.eval_lm | Evaluated 825,641 tokens in 56.8s (14527.31 tokens/s)
2024-07-11 01:35:45 | INFO | fairseq_cli.eval_lm | valid Loss (base 2): 2.9153, Perplexity: 7.54
/usr/lib64/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 4 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
